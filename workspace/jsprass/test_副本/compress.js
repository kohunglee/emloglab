"use strict";function Compressor(e,n){if(!(this instanceof Compressor))return new Compressor(e,n);TreeTransformer.call(this,this.before,this.after),this.options=defaults(e,{annotations:!n,arguments:!n,arrows:!n,assignments:!n,awaits:!n,booleans:!n,collapse_vars:!n,comparisons:!n,conditionals:!n,dead_code:!n,default_values:!n,directives:!n,drop_console:!1,drop_debugger:!n,evaluate:!n,expression:!1,functions:!n,global_defs:!1,hoist_exports:!n,hoist_funs:!1,hoist_props:!n,hoist_vars:!1,ie:!1,if_return:!n,imports:!n,inline:!n,join_vars:!n,keep_fargs:n,keep_fnames:!1,keep_infinity:!1,loops:!n,merge_vars:!n,module:!1,negate_iife:!n,objects:!n,optional_chains:!n,passes:1,properties:!n,pure_funcs:null,pure_getters:!n&&"strict",reduce_funcs:!n,reduce_vars:!n,rests:!n,sequences:!n,side_effects:!n,spreads:!n,strings:!n,switches:!n,templates:!n,top_retain:null,toplevel:!(!e||e.expression||!e.top_retain),typeofs:!n,unsafe:!1,unsafe_comps:!1,unsafe_Function:!1,unsafe_math:!1,unsafe_proto:!1,unsafe_regexp:!1,unsafe_undefined:!1,unused:!n,varify:!n,webkit:!1,yields:!n},!0);var e=this.options.evaluate,t=(this.eval_threshold=/eager/.test(e)?1/0:+e,this.options.global_defs);if("object"==typeof t)for(var i in t)/^@/.test(i)&&HOP(t,i)&&(t[i.slice(1)]=parse(t[i],{expression:!0}));!0===this.options.inline&&(this.options.inline=4),this.drop_fargs=this.options.keep_fargs?return_false:function(e,n){var t;return!e.length_read&&((t=e.name)?t.fixed_value()===e&&!(t=t.definition()).direct_access&&(t=t.escaped)&&1!=t.depth:n&&"Call"==n.TYPE&&n.expression===e)},this.options.module&&(this.directives["use strict"]=!0);var r=this.options.pure_funcs,n=("function"==typeof r?this.pure_funcs=r:"string"==typeof r?this.pure_funcs=function(e){var n;return e instanceof AST_Call?n=e.expression:e instanceof AST_Template&&(n=e.tag),!(n&&r===n.print_to_string())}:Array.isArray(r)?this.pure_funcs=function(e){var n;return e instanceof AST_Call?n=e.expression:e instanceof AST_Template&&(n=e.tag),!(n&&member(n.print_to_string(),r))}:this.pure_funcs=return_true,this.options.sequences),o=(this.sequences_limit=1==n?800:0|n,this.options.top_retain),e=(o instanceof RegExp?this.top_retain=function(e){return o.test(e.name)}:"function"==typeof o?this.top_retain=o:o&&("string"==typeof o&&(o=o.split(/,/)),this.top_retain=function(e){return member(e.name,o)}),this.options.toplevel);this.toplevel="string"==typeof e?{funcs:/funcs/.test(e),vars:/vars/.test(e)}:{funcs:e,vars:e}}Compressor.prototype=new TreeTransformer(function(e,n){var t,i;return e._squeezed?e:((t=e instanceof AST_Scope)&&(this.option("arrows")&&is_arrow(e)&&e.value&&(e.body=[e.first_statement()],e.value=null),e.hoist_properties(this),e.hoist_declarations(this),e.process_returns(this)),n(e,this),n(e,this),i=e.optimize(this),!t||i!==e||this.has_directive("use asm")||i.pinned()||(i.drop_unused(this),i.merge_variables(this)&&i.drop_unused(this),n(i,this)),i===e&&(i._squeezed=!0),i)}),Compressor.prototype.option=function(e){return this.options[e]},Compressor.prototype.exposed=function(e){var n;return!!e.exported||!!e.undeclared||!!(e.global||e.scope.resolve()instanceof AST_Toplevel)&&(n=this.toplevel,!all(e.orig,function(e){return n[e instanceof AST_SymbolDefun?"funcs":"vars"]}))},Compressor.prototype.compress=function(e){(e=e.resolve_defines(this)).hoist_exports(this),this.option("expression")&&e.process_expression(!0);for(var n=this.options.merge_vars,t=+this.options.passes||1,i=1/0,r=!1,o={ie:this.option("ie")},a=0;a<t;a++)if(e.figure_out_scope(o),(0<a||this.option("reduce_vars"))&&e.reset_opt_flags(this),this.options.merge_vars=n&&(r||a==t-1),e=e.transform(this),1<t){var s=0;if(e.walk(new TreeWalker(function(){s++})),AST_Node.info("pass {pass}: last_count: {min_count}, count: {count}",{pass:a,min_count:i,count:s}),s<i)i=s,r=!1;else{if(r)break;r=!0}}return this.option("expression")&&e.process_expression(!1),e},function(e){function u(e,n){var t,i=n.get_property();if(!(i instanceof AST_Node)){if(e instanceof AST_Array){n=e.elements;if("length"==i)return Z(n.length,e);"number"==typeof i&&i in n&&(t=n[i])}else if(e instanceof AST_Lambda){if("length"==i)return e.length_read=!0,Z(e.argnames.length,e)}else if(e instanceof AST_Object)for(var i=""+i,r=e.properties,o=r.length;0<=--o;){if(!st(r[o]))return;t||r[o].key!==i||(t=r[o].value)}return t instanceof AST_SymbolRef&&t.fixed_value()||t}}function ye(e,n,t,i,r,o,a){var s=n.parent(r);if(!(e.option("unsafe")&&s instanceof AST_Dot&&(f=i,l=s.property,f instanceof AST_Boolean?T.Boolean[l]:f instanceof AST_Number?T.Number[l]:f instanceof AST_String?T.String[l]:"valueOf"!=l&&(f instanceof AST_Array?T.Array[l]:f instanceof AST_Lambda?T.Function[l]:f instanceof AST_Object?T.Object[l]:f instanceof AST_RegExp&&T.RegExp[l]&&!f.value.global)))){var f,c,l=is_lhs(t,s);if(l)return l;if(0!=r||!i||!i.is_constant()){if(s instanceof AST_Array)return ye(e,n,s,s,r+1);if(s instanceof AST_Assign)switch(s.operator){case"=":return ye(e,n,s,i,r+1,o,a);case"&&=":case"||=":case"??=":return ye(e,n,s,s,r+1);default:return}return s instanceof AST_Binary?Ne[s.operator]?ye(e,n,s,s,r+1):void 0:s instanceof AST_Call?!o&&s.expression===t&&!s.is_expr_pure(e)&&(!(i instanceof AST_LambdaExpression)||!(s instanceof AST_New)&&i.contains_this()):s instanceof AST_Conditional?s.condition===t?void 0:ye(e,n,s,s,r+1):s instanceof AST_ForEnumeration?s.init===t:s instanceof AST_ObjectKeyVal?s.value!==t?void 0:(f=n.parent(r+1),ye(e,n,f,f,r+2)):s instanceof AST_PropAccess?s.expression!==t?void 0:(c=u(i,s),(!o||a)&&ye(e,n,s,c,r+1)):s instanceof AST_Sequence&&s.tail_node()===t?ye(e,n,s,i,r+1,o,a):void 0}}}function w(e){return e instanceof AST_Class||e instanceof AST_Lambda}function Re(e){return e instanceof AST_Class||e instanceof AST_Defun||e instanceof AST_Function}function ge(e){return"arguments"==e.name&&e.scope.uses_arguments}function b(e,n){do{if(e===n)return;if(n instanceof AST_Scope)return 1}while(n=n.parent_scope)}function be(e,n,t){var i=e.redef||e.definition();return(!e.in_arg||!is_funarg(i))&&all(i.orig,function(e){return e instanceof AST_SymbolConst||e instanceof AST_SymbolLet?e instanceof AST_SymbolImport||n&&qn(n,e):!(t&&e instanceof AST_SymbolLambda)})}function Oe(e,n,t,i){return i instanceof AST_Assign?"="==i.operator&&i.right===t:i instanceof AST_Call?i.expression!==t||i instanceof AST_New:i instanceof AST_ClassField?i.value===t&&!i.static:i instanceof AST_Exit?i.value===t&&n.resolve()!==e.scope.resolve():i instanceof AST_VarDef&&i.value===t}function m(e,n){var t=ke(AST_SymbolRef,e);return t.fixed=n||ke(AST_Undefined,e),t}function v(t,i){return function(e){var n=t(e),e=m(n,i),n=n.definition();return n.references.push(e),n.replaced++,e}}e(AST_Node,function(e){return e}),AST_Toplevel.DEFMETHOD("hoist_exports",function(e){if(e.option("hoist_exports")){for(var n=this.body,t=[],i=0;i<n.length;i++){var r=n[i];r instanceof AST_ExportDeclaration?(n[i]=r=r.body,r instanceof AST_Definitions?r.definitions.forEach(function(e){e.name.match_symbol(o,!0)}):o(r.name)):r instanceof AST_ExportReferences&&(n.splice(i--,1),[].push.apply(t,r.properties))}t.length&&n.push(ke(AST_ExportReferences,this,{properties:t}))}function o(e){e instanceof AST_SymbolDeclaration&&((e=ke(AST_SymbolExport,e)).alias=ke(AST_String,e,{value:e.name}),t.push(e))}}),AST_Scope.DEFMETHOD("process_expression",function(r,o){var a=this,s=new TreeTransformer(function(e){var n;if(r){if((e=e instanceof AST_Directive?ke(AST_SimpleStatement,e,{body:ke(AST_String,e)}):e)instanceof AST_SimpleStatement)return o?o(e):ke(AST_Return,e,{value:e.body})}else if(e instanceof AST_Return)return o?o(e):(n=e.value)instanceof AST_String?ke(AST_Directive,n):ke(AST_SimpleStatement,e,{body:n||ke(AST_UnaryPrefix,e,{operator:"void",expression:ke(AST_Number,e,{value:0})})});if(e instanceof AST_Block){if(e instanceof AST_Lambda){if(e!==a)return e}else if("awaits"===r&&e instanceof AST_Try&&e.bfinally)return e;for(var t=e.body.length;0<=--t;){var i=e.body[t];if(!F(i,!0)){e.body[t]=i.transform(s);break}}}else e instanceof AST_If?(e.body=e.body.transform(s),e.alternative&&(e.alternative=e.alternative.transform(s))):e instanceof AST_With&&(e.body=e.body.transform(s));return e});a.transform(s)}),AST_Toplevel.DEFMETHOD("unwrap_expression",function(){var e=this;switch(e.body.length){case 0:return ke(AST_UnaryPrefix,e,{operator:"void",expression:ke(AST_Number,e,{value:0})});case 1:var n=e.body[0];if(n instanceof AST_Directive)return ke(AST_String,n);if(n instanceof AST_SimpleStatement)return n.body;default:return ke(AST_Call,e,{expression:ke(AST_Function,e,{argnames:[],body:e.body}).init_vars(e,e),args:[]})}}),AST_Node.DEFMETHOD("wrap_expression",function(){var e=this;return e=(e=is_statement(e)?e:ke(AST_SimpleStatement,e,{body:e}))instanceof AST_Toplevel?e:ke(AST_Toplevel,e,{body:[e]})});var y=/^(0|[1-9][0-9]*)$/;function o(e,n,t){t.assignments=0,t.bool_return=0,t.cross_loop=!1,t.direct_access=!1,t.drop_return=0,t.escaped=[],t.first_decl=null,t.fixed=!t.const_redefs&&!t.scope.pinned()&&!n.exposed(t)&&!(t.init instanceof AST_LambdaExpression&&t.init!==t.scope)&&t.init,t.reassigned=0,t.recursive_refs=0,t.references=[],t.single_use=void 0}function a(e,n,t){t.variables.each(function(e){o(0,n,e)})}function g(t,i,r){r.fn_defs=[],r.variables.each(function(e){o(0,i,e);var n=e.init;n instanceof AST_LambdaDefinition&&(r.fn_defs.push(n),n.safe_ids=null),null===e.fixed?(e.safe_ids=t.safe_ids,d(t,e)):e.fixed&&(t.loop_ids[e.id]=t.in_loop,d(t,e))}),r.may_call_this=function(){r.may_call_this=r.contains_this()?return_true:return_false},r.uses_arguments&&r.each_argname(function(e){e.definition().last_ref=!1}),i.option("ie")&&r.variables.each(function(e){var n=e.orig[0].definition();n!==e&&(n.fixed=!1)})}function s(e,n){n=n.safe_ids;return void 0===n||n===e.safe_ids}function c(e,n){var t=e.fn_scanning;(e.fn_scanning=n).walk(e),e.fn_scanning=t}function l(t,i){i.enclosed.forEach(function(e){var n;i.variables.get(e.name)===e||R(t,e)||(e.single_use=!1,(n="function"==typeof(n=e.fixed)?n():n)instanceof AST_Lambda&&void 0!==n.safe_ids)||(e.fixed=!1)})}function x(e,n,t){var i,r=t.safe_ids;void 0!==r&&!1!==r&&(t.parent_scope.resolve().may_call_this===return_true?member(t,e.fn_visited)&&l(e,t):r?(i=member(t,e.fn_visited),r===e.safe_ids?i||c(e,t):i?l(e,t):t.safe_ids=!1):e.fn_scanning&&e.fn_scanning!==n.scope.resolve()?t.safe_ids=!1:(t.safe_ids=e.safe_ids,c(e,t)))}function k(n,e){p(n);var t=e.fn_defs;t.forEach(function(e){e.safe_ids=n.safe_ids,c(n,e)}),t.forEach(function(e){e.safe_ids=void 0}),e.fn_defs=void 0,e.may_call_this=void 0}function S(e,n){var t=Object.create(e.defined_ids),i=Object.create(e.safe_ids);n||(t.seq={},i.seq={}),e.defined_ids=t,e.safe_ids=i}function p(e){e.defined_ids=Object.getPrototypeOf(e.defined_ids),e.safe_ids=Object.getPrototypeOf(e.safe_ids)}function r(e,n){e.defined_ids[n.id]=e.defined_ids.seq}function D(e,n){e.assigned_ids[n.id]=e.defined_ids.seq,e.defined_ids[n.id]=!1}function d(e,n){e.safe_ids[n.id]={}}function E(e,n){e.references.push(n),!1!==e.last_ref&&(e.last_ref=n)}function R(e,n){var t,i,r;return"m"!=n.single_use&&((t=e.safe_ids[n.id])?((i=HOP(e.safe_ids,n.id))||(r=e.safe_ids.seq,t.read?t.read!==r&&(t.read=!0):t.read=r),null==n.fixed?!ge(n)&&!(n.global&&"arguments"==n.name||(e.loop_ids[n.id]=null,n.fixed=ke(AST_Undefined,n.orig[0]),i&&(n.safe_ids=void 0),0)):!t.assign||t.assign===e.safe_ids):n.fixed instanceof AST_LambdaDefinition)}function O(e,n,t){if(!t){if(is_funarg(n)&&n.scope.uses_arguments&&!e.has_directive("use strict"))return;if(!all(n.orig,function(e){return!(e instanceof AST_SymbolConst)}))return}if(void 0===n.fixed)return t||all(n.orig,function(e){return!(e instanceof AST_SymbolLet)});if(!1!==n.fixed&&0!==n.fixed){t=e.safe_ids[n.id];if(n.safe_ids)return n.safe_ids[n.id]=!1,n.safe_ids=void 0,null===n.fixed||HOP(e.safe_ids,n.id)&&!t.read;if(!HOP(e.safe_ids,n.id)){if(!t)return;if(t.read||e.in_loop){var i=e.find_parent(AST_BlockScope);if(i instanceof AST_Class)return;if(n.scope.resolve()!==i.resolve())return}t.assign=!(!t.assign||t.assign===e.safe_ids)||e.safe_ids}if(null!=n.fixed&&t.read){if(t.read!==e.safe_ids.seq)return;if(e.loop_ids[n.id]!==e.in_loop)return}return R(e,n)&&all(n.orig,function(e){return!(e instanceof AST_SymbolLambda)})}}function U(e){var n;return!!e&&(e instanceof AST_Assign?"="==(n=e.operator)?U(e.right):!Ne[n.slice(0,-1)]:e instanceof AST_Sequence?U(e.tail_node()):e.is_constant()||w(e)||e instanceof AST_ObjectIdentity)}function j(e,n,t,i,r,o,a){var s,f=e.parent(o);if(!r||!r.is_constant())if(Oe(n,t,i,f))n.escaped.push(f),!(1<a)||r&&r.is_constant_expression(t)||(a=1),(!n.escaped.depth||n.escaped.depth>a)&&(n.escaped.depth=a),n.scope.resolve()!==t.resolve()&&(n.escaped.cross_scope=!0),n.fixed&&(n.fixed.escaped=n.escaped);else{if(c=i,(s=f)instanceof AST_Array||(s instanceof AST_Binary?Ne[s.operator]:s instanceof AST_Conditional?s.condition!==c:s instanceof AST_Sequence?s.tail_node()===c:s instanceof AST_Spread))j(e,n,t,f,f,o+1,a);else if(f instanceof AST_ObjectKeyVal&&f.value===i){var c=e.parent(o+1);j(e,n,t,c,c,o+2,a)}else if(f instanceof AST_PropAccess&&f.expression===i&&(j(e,n,t,f,r=u(r,f),o+1,a+1),r))return;0<o||f instanceof AST_Call&&f.expression===i||f instanceof AST_Sequence&&f.tail_node()!==i||f instanceof AST_SimpleStatement||f instanceof AST_Unary&&!unary_side_effects[f.operator]||(n.direct_access=!0,n.fixed&&(n.fixed.direct_access=!0))}}function L(e){var n;e instanceof AST_Sub&&(n=e.expression)instanceof AST_SymbolRef&&ge(n=n.definition())&&((e=(e=e.property).is_constant()?e.value:e)instanceof AST_Node||y.test(e))&&(n.reassigned++,(e instanceof AST_Node?n.scope.argnames:[n.scope.argnames[e]]).forEach(function(e){e instanceof AST_SymbolFunarg&&(e.definition().fixed=!1)}))}function V(n,t){var i,r;return function(){var e=n();return r=i!==e?t(i=e):r}}function I(c,n,e,l,u){var _=new TreeWalker(function(i){var t,r,o,a,s,f,e;return i instanceof AST_DefaultValue?(A(i),S(c,!0),i.value.walk(c),p(c),(e=l)&&(t=n,r=i,o=e,l=function(){var e,n;return s===r?r:(e=o(),(n=N(t,e,!0))instanceof AST_Node?s=r:a!==e&&(a=e,s=void 0===n?we(r,[e,r.value]):e),s)}),i.name.walk(_),l=e):i instanceof AST_DestructuredArray?(A(i),e=l,i.elements.forEach(function(n,t){if(n instanceof AST_Hole)return A(n);e&&(l=V(e,function(e){return ke(AST_Sub,n,{expression:e,property:ke(AST_Number,n,{value:t})})})),n.walk(_)}),i.rest&&(e&&(l=n.option("rests")&&V(e,function(e){if(!(e instanceof AST_Array))return i;for(var n=0,t=i.elements.length;n<t;n++)if(e.elements[n]instanceof AST_Spread)return i;return(f=f||ke(AST_Array,i,{})).elements=e.elements.slice(t),f})),i.rest.walk(_)),l=e):i instanceof AST_DestructuredObject?(A(i),e=l,i.properties.forEach(function(i){A(i),i.key instanceof AST_Node&&(S(c),i.key.walk(c),p(c)),e&&(l=V(e,function(e){var n=i.key,t=AST_Sub;return"string"==typeof n&&(is_identifier_string(n)?t=AST_Dot:n=Z(n,i)),ke(t,i,{expression:e,property:n})})),i.value.walk(_)}),i.rest&&(l=!1,i.rest.walk(_)),l=e):u(i,l,function(){for(var e=c.stack.length,n=0,t=_.stack.length-1;n<t;n++)c.stack.push(_.stack[n]);i.walk(c),c.stack.length=e}),!0});e.walk(_)}function M(i,e,r){var n,o=this,a=(o.inlined=!1,i.parent()),t=!is_async(o)&&!is_generator(o),s=!t,f=!1,c=(o.walk(new TreeWalker(function(e){return s?f=!0:e instanceof AST_Return?s=!0:e instanceof AST_Scope&&e!==o||void 0})),f&&S(i,t),g(i,r,o),!o.uses_arguments||i.has_directive("use strict")),l=(o.argnames.forEach(function(n,e){var t=a.args[e];I(i,r,n,function(){var e=o.argnames.indexOf(n),e=e<0?t:a.args[e];return(e=e instanceof AST_Sequence&&e.expressions.length<2?e.expressions[0]:e)||ke(AST_Undefined,a)},_)}),o.rest),t=(l&&I(i,r,l,r.option("rests")&&function(){return o.rest!==l?l:((n=n||ke(AST_Array,o,{})).elements=a.args.slice(o.argnames.length),n)},_),walk_lambda(o,i),i.defined_ids),u=i.safe_ids;return k(i,o),f||(i.defined_ids=t,i.safe_ids=u),!0;function _(e,n){var t=e.definition();t.first_decl||0!=t.references.length||(t.first_decl=e),n&&c&&void 0===t.fixed?(d(i,t),i.loop_ids[t.id]=i.in_loop,t.fixed=n,t.fixed.assigns=[e]):t.fixed=!1}}function A(e){e._squeezed=!1,e._optimized=!1,e.single_use=!1,e instanceof AST_BlockScope&&(e._var_names=void 0),e instanceof AST_SymbolRef&&(e.fixed=void 0)}function H(t,i){return this.transform(new TreeTransformer(function(e,n){return e instanceof AST_DefaultValue?((e=e.clone()).name=e.name.transform(this),e):e instanceof AST_Destructured?(n(e=e.clone(),this),e):e instanceof AST_DestructuredKeyVal?((e=e.clone()).value=e.value.transform(this),e):e.convert_symbol(t,i)}))}function $(e,n){e=ke(e,this);return n(e,this)||e}function X(e){var n=e.definition();n.assignments++,n.references.push(e)}function J(n,t){var i=new TreeWalker(function(e){return e instanceof AST_DefaultValue?(e.value.walk(t),e.name.walk(i),!0):e instanceof AST_DestructuredKeyVal?(e.key instanceof AST_Node&&e.key.walk(t),e.value.walk(i),!0):n(e)});this.walk(i)}function Q(e){return e(this)}function ne(n,t){var i=!1,r=new TreeWalker(function(e){return!!i||(e instanceof AST_DefaultValue?t?(e.name.walk(r),!0):i=!0:e instanceof AST_DestructuredKeyVal?!t&&e.key instanceof AST_Node?i=!0:(e.value.walk(r),!0):n(e)?i=!0:void 0)});return this.walk(r),i}function B(e){return e instanceof AST_AsyncGeneratorDefun||e instanceof AST_AsyncGeneratorFunction}function xe(e){var n=0,t=e.self();do{if(t.variables)return t}while(t=e.parent(n++))}function Be(e,n,t,i,r,o){for(var a;a=e.parent(n++);t=a){if(a===i)return!1;if(o&&a instanceof AST_Lambda){if(a.name||is_async(a)||is_generator(a))return!0}else if(a instanceof AST_Try){if(a.bfinally&&a.bfinally!==t)return!0;if(r&&a.bcatch&&a.bcatch!==t)return!0}}return!1}(n=function(e,n){e.DEFMETHOD("reduce_vars",n)})(AST_Node,noop),n(AST_Assign,function(o,e,n){var a=this,s=a.left,f=a.right,t=s instanceof AST_SymbolRef&&s.definition(),i=t||s instanceof AST_Destructured;switch(a.operator){case"=":return s.equals(f)&&!s.has_side_effects(n)?(f.walk(o),function e(n){A(n);{var t;n instanceof AST_Dot?e(n.expression):n instanceof AST_Sub?(e(n.expression),n.property.walk(o)):n instanceof AST_SymbolRef?(E(t=n.definition(),n),t.fixed&&(n.fixed=t.fixed,n.fixed.assigns?n.fixed.assigns.push(a):n.fixed.assigns=[a])):n.walk(o)}}(s),!0):t&&f instanceof AST_LambdaExpression?(u(),f.parent_scope.resolve().fn_defs.push(f),f.safe_ids=null,t.fixed&&a.write_only||x(o,t,f),!0):i?(f.walk(o),u(),!0):void L(s);case"&&=":case"||=":case"??=":var r=!0;default:if(!i)return L(s),_();D(o,t),t.assignments++;var c,l=t.fixed;return ye(n,o,a,a,0)?(t.fixed=!1,_()):(c=R(o,t),r&&S(o,!0),f.walk(o),r&&p(o),c&&!s.in_arg&&O(o,t)?(E(t,s),d(o,t),t.single_use&&(t.single_use=!1),s.fixed=t.fixed=function(){return ke(AST_Binary,a,{operator:a.operator.slice(0,-1),left:m(s,l),right:a.right})},s.fixed.assigns=l&&l.assigns?l.assigns.slice():[t.orig[0]],s.fixed.assigns.push(a),s.fixed.to_binary=v(function(e){return e.left},l)):(s.walk(o),t.fixed=!1),!0)}function u(){var e=t&&Qn(o,t),r=ye(n,o,a,f,0,U(f),e);I(o,n,s,function(){return a.right},function(e,n,t){var i;e instanceof AST_SymbolRef?(i=e.definition(),D(o,i),i.assignments++,n&&!e.in_arg&&O(o,i)?(E(i,e),d(o,i),(s instanceof AST_Destructured||1==i.orig.length&&i.orig[0]instanceof AST_SymbolDefun)&&(i.single_use=!1),o.loop_ids[i.id]=o.in_loop,i.fixed=r?0:n,e.fixed=n,e.fixed.assigns=[a],j(o,i,e.scope,a,f,0,1)):(t(),i.fixed=!1)):(L(e),t())})}function _(){if(r)return s.walk(o),S(o,!0),f.walk(o),p(o),!0}}),n(AST_Binary,function(e){if(Ne[this.operator])return this.left.walk(e),S(e,!0),this.right.walk(e),p(e),!0}),n(AST_BlockScope,function(e,n,t){a(0,t,this)}),n(AST_Call,function(n){var t,e=this,i=e.expression;if(i instanceof AST_LambdaExpression)t=Fe(e),e.args.forEach(function(e){e.walk(n),e instanceof AST_Spread&&(t=!1)}),t&&(i.reduce_vars=M),i.walk(n),t&&delete i.reduce_vars;else{if("Call"==e.TYPE)switch(n.in_boolean_context()){case"d":var r=!0;case!0:!function e(n,t){n instanceof AST_Assign?"="==n.operator&&(e(n.left,t),e(n.right,t)):n instanceof AST_Binary?Ne[n.operator]&&(e(n.left,t),e(n.right,t)):n instanceof AST_Conditional?(e(n.consequent,t),e(n.alternative,t)):n instanceof AST_SymbolRef&&((n=n.definition()).bool_return++,t)&&n.drop_return++}(i,r)}i.walk(n);var o=e.optional,e=(o&&S(n,!0),e.args.forEach(function(e){e.walk(n)}),o&&p(n),i instanceof AST_SymbolRef&&i.fixed_value());e instanceof AST_Lambda?x(n,i.definition(),e):(n.defined_ids.seq={},n.find_parent(AST_Scope).may_call_this())}return!0}),n(AST_Class,function(n,e,t){var i,r,o=this,t=(a(0,t,o),o.extends&&o.extends.walk(n),o.properties.filter(function(e){return A(e),e.key instanceof AST_Node&&(n.push(e),e.key.walk(n),n.pop()),e.value}));return o.name&&(i=o.name.definition(),((r=n.parent())instanceof AST_ExportDeclaration||r instanceof AST_ExportDefault)&&(i.single_use=!1),O(n,i,!0)?(d(n,i),n.loop_ids[i.id]=n.in_loop,i.fixed=function(){return o},i.fixed.assigns=[o],On(i)||(i.single_use=!1)):i.fixed=!1),t.forEach(function(e){n.push(e),!e.static||he(e)&&e.value.contains_this()?(S(n),e.value.walk(n),p(n)):e.value.walk(n),n.pop()}),!0}),n(AST_ClassInitBlock,function(e,n,t){return S(e,!0),g(e,t,this),n(),k(e,this),!0}),n(AST_Conditional,function(e){return this.condition.walk(e),S(e,!0),this.consequent.walk(e),p(e),S(e,!0),this.alternative.walk(e),p(e),!0}),n(AST_DefaultValue,function(e){return S(e,!0),this.value.walk(e),p(e),this.name.walk(e),!0}),n(AST_Do,function(e){var n=e.in_loop;return e.in_loop=this,S(e),this.body.walk(e),Cn(this,e.parent())&&(p(e),S(e)),this.condition.walk(e),p(e),e.in_loop=n,!0}),n(AST_Dot,function(e,n){n();n=this.expression;return!this.optional&&n instanceof AST_SymbolRef&&r(e,n.definition()),!0}),n(AST_For,function(e,n,t){var i=this,t=(a(0,t,i),i.init&&i.init.walk(e),e.in_loop);return e.in_loop=i,S(e),i.condition&&i.condition.walk(e),i.body.walk(e),i.step&&(Cn(i,e.parent())&&(p(e),S(e)),i.step.walk(e)),p(e),e.in_loop=t,!0}),n(AST_ForEnumeration,function(e,n,t){var i=this,t=(a(0,t,i),i.object.walk(e),e.in_loop),r=(e.in_loop=i,S(e),i.init);return r instanceof AST_Definitions?r.definitions[0].name.mark_symbol(function(e){e instanceof AST_SymbolDeclaration&&((e=e.definition()).assignments++,e.fixed=!1)},e):r instanceof AST_Destructured||r instanceof AST_SymbolRef?r.mark_symbol(function(e){var n;e instanceof AST_SymbolRef&&(E(n=e.definition(),e),n.assignments++,e.is_immutable()||(n.fixed=!1))},e):r.walk(e),i.body.walk(e),p(e),e.in_loop=t,!0}),n(AST_If,function(e){return this.condition.walk(e),S(e,!0),this.body.walk(e),p(e),this.alternative&&(S(e,!0),this.alternative.walk(e),p(e)),!0}),n(AST_LabeledStatement,function(e){return S(e,!0),this.body.walk(e),p(e),!0}),n(AST_Lambda,function(e,n,t){var i=this;return s(e,i)&&push_uniq(e.fn_visited,i)&&(i.inlined=!1,S(e),g(e,t,i),n(),k(e,i),i.name)&&j(e,i.name.definition(),i,i.name,i,0,1),!0}),n(AST_LambdaDefinition,function(e,n,t){var i=this,r=i.name.definition(),o=e.parent();return(o instanceof AST_ExportDeclaration||o instanceof AST_ExportDefault)&&(r.single_use=!1),s(e,i)&&push_uniq(e.fn_visited,i)&&(i.inlined=!1,S(e),g(e,t,i),n(),k(e,i)),!0}),n(AST_Sub,function(e,n){var t=this.expression;return this.optional?(t.walk(e),S(e,!0),this.property.walk(e),p(e)):(n(),t instanceof AST_SymbolRef&&r(e,t.definition())),!0}),n(AST_Switch,function(n,e,t){a(0,t,this),this.expression.walk(n);var i=!0;return this.body.forEach(function(e){e instanceof AST_Default||(e.expression.walk(n),i&&S(n,!(i=!1)))}),i||p(n),walk_body(this,n),!0}),n(AST_SwitchBranch,function(e){return S(e,!0),walk_body(this,e),p(e),!0}),n(AST_SymbolCatch,function(){var e=this.definition();e.first_decl||0!=e.references.length||(e.first_decl=this),e.fixed=!1}),n(AST_SymbolDeclaration,function(){var e=this.definition();e.first_decl||0!=e.references.length||(e.first_decl=this)}),n(AST_SymbolDefun,function(){var e=this.definition();e.first_decl||0!=e.references.length||(e.first_decl=this),1<e.orig.length&&e.scope.resolve()!==this.scope&&(e.fixed=!1)}),n(AST_SymbolImport,function(){var e=this.definition();e.first_decl=this,e.fixed=!1}),n(AST_SymbolRef,function(t,e,n){var i,r=this,o=r.definition(),a=o.fixed||o.last_ref&&o.last_ref.fixed,s=(E(o,r),!function(e,n){var t=e.defined_ids.seq,i=e.defined_ids[n.id];if(i===t)return!(i=e.assigned_ids[n.id])||i===t}(t,o)||(r.defined=!0),1==o.references.length&&!o.fixed&&o.orig[0]instanceof AST_SymbolDefun&&(t.loop_ids[o.id]=t.in_loop),Qn(t,o));switch(s&&s.enclosed.forEach(function(e){var n;o===e||e.scope.resolve()===s||!(n=e.fixed&&e.fixed.assigns)||n[n.length-1]instanceof AST_VarDef||(n=t.safe_ids[e.id])&&(n.assign=!0)}),"m"==o.single_use&&o.fixed&&(o.fixed=0,o.single_use=!1),o.fixed){case 0:R(t,o)||(o.fixed=!1);case!1:var f=o.redefined();f&&b(o.scope,r.scope)&&(f.single_use=!1);break;case void 0:o.fixed=!1;break;default:R(t,o)?(r.in_arg&&o.orig[0]instanceof AST_SymbolLambda&&(r.fixed=o.scope),i=r.fixed_value(),s?o.recursive_refs++:!i||(f=o,!n.option("unused"))||f.scope.pinned()||!1===f.single_use||f.references.length-f.recursive_refs!=1||is_funarg(f)&&f.scope.uses_arguments?o.single_use=!1:(o.in_loop=t.loop_ids[o.id]!==t.in_loop,o.single_use=w(i)&&!i.pinned()&&(!o.in_loop||t.parent()instanceof AST_Call)||!o.in_loop&&o.scope===r.scope.resolve()&&i.is_constant_expression()),ye(n,t,r,i,0,U(i),s)&&(o.single_use?o.single_use="m":o.fixed=0),o.fixed&&t.loop_ids[o.id]!==t.in_loop&&(o.cross_loop=!0),j(t,o,r.scope,r,i,0,1)):o.fixed=!1}if(r.fixed||(r.fixed=0===o.fixed?a:o.fixed),(i=!i&&a?a instanceof AST_Node?a:a():i)instanceof AST_Lambda){if(o.fixed){a=t.parent();if(a instanceof AST_Call&&a.expression===r)return}x(t,o,i)}}),n(AST_Template,function(n,e){var t,i=this.tag;if(i)return i instanceof AST_LambdaExpression?(this.expressions.forEach(function(e){e.walk(n)}),i.walk(n)):(i.walk(n),this.expressions.forEach(function(e){e.walk(n)}),(t=i instanceof AST_SymbolRef&&i.fixed_value())instanceof AST_Lambda?x(n,i.definition(),t):n.find_parent(AST_Scope).may_call_this()),!0}),n(AST_Toplevel,function(e,n,t){return this.globals.each(function(e){o(0,t,e)}),S(e,!0),g(e,t,this),n(),k(e,this),!0}),n(AST_Try,function(e,n,t){var i=this;return a(0,t,i),S(e,!0),walk_body(i,e),p(e),i.bcatch&&(S(e,!0),i.bcatch.walk(e),p(e)),i.bfinally&&i.bfinally.walk(e),!0}),n(AST_Unary,function(e,n){var t=this;if(UNARY_POSTFIX[t.operator]){var i,r,o=t.expression;if(o instanceof AST_SymbolRef)return(i=o.definition()).assignments++,r=i.fixed,R(e,i)&&!o.in_arg&&O(e,i)?(E(i,o),d(e,i),i.single_use&&(i.single_use=!1),i.fixed=function(){return ke(AST_Binary,t,{operator:t.operator.slice(0,-1),left:ke(AST_UnaryPrefix,t,{operator:"+",expression:m(o,r)}),right:ke(AST_Number,t,{value:1})})},i.fixed.assigns=r&&r.assigns?r.assigns.slice():[],i.fixed.assigns.push(t),t instanceof AST_UnaryPrefix?o.fixed=i.fixed:(o.fixed=function(){return ke(AST_UnaryPrefix,t,{operator:"+",expression:m(o,r)})},o.fixed.assigns=r&&r.assigns,o.fixed.to_prefix=v(function(e){return e.expression},i.fixed))):(o.walk(e),i.fixed=!1),!0;L(o)}}),n(AST_VarDef,function(i,e,n){var t,r=this,o=r.value;return o instanceof AST_LambdaExpression&&r.name instanceof AST_SymbolDeclaration?(a(),o.parent_scope.resolve().fn_defs.push(o),o.safe_ids=null,(t=r.name.definition()).fixed||x(i,t,o)):o?(o.walk(i),a()):i.parent()instanceof AST_Let?a():r.name.walk(i),!0;function a(){I(i,n,r.name,function(){return r.value||ke(AST_Undefined,r)},function(e,n){var t=e.definition();D(i,t),t.first_decl||0!=t.references.length||(t.first_decl=e),n&&O(i,t,!0)?(d(i,t),i.loop_ids[t.id]=i.in_loop,t.fixed=n,t.fixed.assigns=[r],(e instanceof AST_SymbolConst&&t.redefined()||!be(e)&&!On(t))&&(t.single_use=!1)):t.fixed=!1})}}),n(AST_While,function(e,n){var t=e.in_loop;return e.in_loop=this,S(e),n(),p(e),e.in_loop=t,!0}),AST_Toplevel.DEFMETHOD("reset_opt_flags",function(t){var i=new TreeWalker(t.option("reduce_vars")?function(e,n){return A(e),e.reduce_vars(i,n,t)}:A);i.assigned_ids=Object.create(null),i.defined_ids=Object.create(null),i.defined_ids.seq={},i.fn_scanning=null,i.fn_visited=[],i.in_loop=null,i.loop_ids=Object.create(null),i.safe_ids=Object.create(null),i.safe_ids.seq={},this.walk(i)}),AST_Symbol.DEFMETHOD("fixed_value",function(e){var n=this.definition(),t=n.fixed;return t?((t=this.fixed?this.fixed:t)instanceof AST_Node?t:t()).tail_node():(t=0===t&&this.fixed)&&(t=(t instanceof AST_Node?t:t()).tail_node(),e&&1!=n.escaped.depth&&Kn(t,!0)||t.is_constant()?t:void 0)}),AST_SymbolRef.DEFMETHOD("is_immutable",function(){var e=this.redef||this.definition();return e.orig[0]instanceof AST_SymbolLambda&&(1==e.orig.length||!(!this.in_arg||e.orig[1]instanceof AST_SymbolFunarg))}),AST_Node.DEFMETHOD("convert_symbol",noop),AST_DefaultValue.DEFMETHOD("convert_symbol",H),AST_Destructured.DEFMETHOD("convert_symbol",H),AST_SymbolDeclaration.DEFMETHOD("convert_symbol",$),AST_SymbolRef.DEFMETHOD("convert_symbol",$),AST_DefaultValue.DEFMETHOD("mark_symbol",J),AST_Destructured.DEFMETHOD("mark_symbol",J),AST_SymbolDeclaration.DEFMETHOD("mark_symbol",Q),AST_SymbolRef.DEFMETHOD("mark_symbol",Q),AST_Node.DEFMETHOD("match_symbol",function(e){return e(this)}),AST_DefaultValue.DEFMETHOD("match_symbol",ne),AST_Destructured.DEFMETHOD("match_symbol",ne);var te=makePredicate("Infinity NaN undefined");function Pe(e,n){if(e instanceof AST_Assign)return"="!=e.operator||!!e.right.tail_node().is_constant()||Pe(e.left,n);if(e instanceof AST_Atom)return!0;if(e instanceof AST_ObjectIdentity)return!0;if(e instanceof AST_PropAccess){if("__proto__"===e.property)return!0;if((e=e.expression)instanceof AST_SymbolRef){if(e.is_immutable())return!1;e=e.fixed_value()}return e?!!e.tail_node().is_constant()||Pe(e,n):!0}return e instanceof AST_SymbolRef&&(!!e.is_immutable()||(e=e.definition(),n.exposed(e)&&te[e.name]))}function ke(e,n,t){return t?(t.start=n.start,t.end=n.end):t=n,new e(t)}function we(e,n){return 1==n.length?n[0]:ke(AST_Sequence,e,{expressions:n.reduce(re,[])})}function Z(e,n){switch(typeof e){case"string":return ke(AST_String,n,{value:e});case"number":return isNaN(e)?ke(AST_NaN,n):isFinite(e)?1/e<0?ke(AST_UnaryPrefix,n,{operator:"-",expression:ke(AST_Number,n,{value:-e})}):ke(AST_Number,n,{value:e}):e<0?ke(AST_UnaryPrefix,n,{operator:"-",expression:ke(AST_Infinity,n)}):ke(AST_Infinity,n);case"boolean":return ke(e?AST_True:AST_False,n);case"undefined":return ke(AST_Undefined,n);default:if(null===e)return ke(AST_Null,n);if(e instanceof RegExp)return ke(AST_RegExp,n,{value:e});throw new Error(string_template("Can't handle constant of type: {type}",{type:typeof e}))}}function ie(e){return e instanceof AST_PropAccess||Ee(e)&&"eval"==e.name}function De(e,n,t){var i=!1;return"Call"==e.TYPE?i=e.expression===n&&ie(t):e instanceof AST_Template?i=e.tag===n&&ie(t):e instanceof AST_UnaryPrefix&&(i="delete"==e.operator||"typeof"==e.operator&&Ee(t)),i?we(n,[ke(AST_Number,n,{value:0}),t]):t}function P(e,n){var i=new Dictionary;return e.walk(new TreeWalker(function(e){var n;e instanceof AST_SymbolRef&&(n=e.definition(),(e=e.fixed)&&i.has(n.id)?i.get(n.id)!==e&&i.set(n.id,!1):i.set(n.id,e))})),0<i.size()&&n.walk(new TreeWalker(function(e){var n,t;e instanceof AST_SymbolRef&&(n=e.definition(),t=e.fixed)&&i.has(n.id)&&i.get(n.id)!==t&&(e.fixed=!1)})),n}function re(e,n){return n instanceof AST_Sequence?[].push.apply(e,n.expressions):e.push(n),e}function oe(e){return e instanceof AST_Const||e instanceof AST_DefClass||e instanceof AST_Let}function ae(e){var n,t;return e instanceof AST_LambdaDefinition?(n=e.name.definition(),t=e.name.scope,!(1<n.orig.length&&n.scope.resolve()!==t)&&(n.scope===t||all(n.references,function(e){var n=e.scope;do{if(n===t)return!0}while(n=n.parent_scope)}))):!oe(e)}function se(e){if(null===e)return[];if(e instanceof AST_BlockStatement)return all(e.body,ae)?e.body:[e];if(e instanceof AST_EmptyStatement)return[];if(is_statement(e))return[e];throw new Error("Can't convert thing to statement array")}function ee(e){return null===e||e instanceof AST_EmptyStatement||e instanceof AST_BlockStatement&&0==e.body.length}function fe(e){return all(e.body,function(e){return ee(e)||e instanceof AST_Defun||e instanceof AST_Var&&W(e)})}function ce(e){return e instanceof AST_IterationStatement&&e.body instanceof AST_BlockStatement?e.body:e}function le(e){if("Call"!=e.TYPE)return!1;for(;(e=e.expression)instanceof AST_PropAccess;);return e instanceof AST_LambdaExpression?!is_arrow(e):le(e)}function Fe(e){var n,t=e.expression;return!(t.name||e instanceof AST_New&&(n=!1,t.walk(new TreeWalker(function(e){return!!n||(e instanceof AST_NewTarget?n=!0:e instanceof AST_Scope&&e!==t||void 0)})),n))}function Ee(e){return e instanceof AST_SymbolRef&&e.definition().undeclared}var ue,_e,Se,pe,de,Ae,Te,qe=makePredicate("Array Boolean clearInterval clearTimeout console Date decodeURI decodeURIComponent encodeURI encodeURIComponent Error escape eval EvalError Function isFinite isNaN JSON Map Math Number parseFloat parseInt RangeError ReferenceError RegExp Object Set setInterval setTimeout String SyntaxError TypeError unescape URIError WeakMap WeakSet");function he(e){return e.static&&e.value&&(e instanceof AST_ClassField||e instanceof AST_ClassInit)}function W(e){return all(e.definitions,function(e){return!e.value})}function F(e,n){return e instanceof AST_DefClass?n&&!e.extends&&all(e.properties,function(e){return!(e.key instanceof AST_Node||he(e))}):e instanceof AST_Definitions?(n||e instanceof AST_Var)&&W(e):e instanceof AST_ExportDeclaration||e instanceof AST_ExportDefault?F(e.body,n):e instanceof AST_LambdaDefinition}function ze(e,n){var t=e.lastIndexOf(n);if(t<0)return!1;for(;++t<e.length;)if(!F(e[t],!0))return!1;return!0}function Ue(e,n){var t;if(e.init instanceof AST_BlockStatement&&(e.init=(t=e.init).body.pop(),t.body.push(e)),e.init instanceof AST_Defun?((t=t||ke(AST_BlockStatement,e,{body:[e]})).body.splice(-1,0,e.init),e.init=null):e.init instanceof AST_SimpleStatement?e.init=e.init.body:ee(e.init)&&(e.init=null),t)return n?List.splice(t.body):t}function me(e,S){var de,Ae,Te,he,me,ve,R=O(S,function(e){return e instanceof AST_Lambda}),n=S.self(),t=0;do{if(!de&&n.variables&&(de=n),n instanceof AST_Catch)S.parent(t).bfinally&&((me=me||{}).bfinally=!0),t++;else if(n instanceof AST_Finally)t++;else if(n instanceof AST_IterationStatement)he=!0;else{if(n instanceof AST_Scope){ve=n;break}n instanceof AST_Try&&(me=me||{},n.bcatch&&(me.bcatch=!0),n.bfinally)&&(me.bfinally=!0)}}while(n=S.parent(t++));var i,r,o=10;do{if(r=i,i=0,!(i=!function e(n){var t=!1,i=[];for(var r=0;r<n.length;){var o=n[r];if(o instanceof AST_BlockStatement&&all(o.body,ae))t=!0,e(o.body),[].splice.apply(n,[r,1].concat(o.body)),r+=o.body.length;else{if(o instanceof AST_Directive){if(member(o.value,i)){t=!0,n.splice(r,1);continue}i.push(o.value)}o instanceof AST_EmptyStatement?(t=!0,n.splice(r,1)):r++}}return t}(e)?i:1)&&1==r)break;if(S.option("dead_code")&&!(i=!function(n,t){var e,i=t.self();i instanceof AST_Catch?i=t.parent():i instanceof AST_LabeledStatement&&(i=i.body);for(var r=0,o=0,a=n.length;r<a;r++){var s,f=n[r];if(!(f instanceof AST_LoopControl)||ce(s=t.loopcontrol_target(f))!==i||f instanceof AST_Break&&s instanceof AST_IterationStatement?n[o++]=f:f.label&&remove(f.label.thedef.references,f),q(f)){e=n.slice(r+1);break}}n.length=o,e&&e.forEach(function(e){C(t,e,n)});return n.length!=a}(e,S)?i:2)&&2==r)break;if(S.option("if_return")&&!(i=!function(a,i){for(var r,s,o,f=!1,c=i.parent(),l=i.self(),e=R&&c&&"Call"==c.TYPE&&c.expression===l,n=R&&i.option("conditionals")&&i.option("sequences"),u=!(me&&me.bfinally&&B(ve)),t=function(e){for(var n=0,t=e.length;0<=--t;){var i=e[t];if(i instanceof AST_If&&i.body instanceof AST_Return&&1<++n)return!0}return!1}(a),_=a.length;0<=--_;){var S=a[_],p=N(_),d=a[p];if(R&&r&&!d&&S instanceof AST_Return&&u&&!(l instanceof AST_SwitchBranch)){if(!(m=S.value)){f=!0,a.splice(_,1);continue}var A=m.tail_node();if(Ce(A)){f=!0,m instanceof AST_UnaryPrefix?m=m.expression:A instanceof AST_UnaryPrefix&&((m=m.clone()).expressions[m.expressions.length-1]=A.expression),a[_]=ke(AST_SimpleStatement,S,{body:m});continue}}if(S instanceof AST_If){A=q(S.body);if(k(A)){A.label&&remove(A.label.thedef.references,A),f=!0,(S=S.clone()).body=ke(AST_BlockStatement,S,{body:E(S.body,A)}),S.alternative=ke(AST_BlockStatement,S,{body:se(S.alternative).concat(w(o,s))}),C(A.value,o),a[_]=S,a[_]=S.transform(i);continue}if(A&&!S.alternative&&d instanceof AST_Jump){var T=S.condition,h=_+1==p&&S.body instanceof AST_BlockStatement;if((T=Y(T,T.negate(i),h))!==S.condition){f=!0,(S=S.clone()).condition=T;var m=S.body;S.body=ke(AST_BlockStatement,d,{body:w(!0,null,p+1)}),a.splice(_,1,S,m),(!R||l instanceof AST_Block&&l.body===a)&&(a[_]=S.transform(i));continue}}var v,h=q(S.alternative);if(k(h)){h.label&&remove(h.label.thedef.references,h),f=!0,(S=S.clone()).body=ke(AST_BlockStatement,S.body,{body:se(S.body).concat(w(o,s))}),S.alternative=ke(AST_BlockStatement,S.alternative,{body:E(S.alternative,h)}),C(h.value,o),a[_]=S,a[_]=S.transform(i);continue}i.option("typeofs")&&(A&&!h&&(v=ke(AST_BlockStatement,l,{body:a.slice(_+1)}),z(S.condition,null,v)),!A)&&h&&(v=ke(AST_BlockStatement,l,{body:a.slice(_+1)}),z(S.condition,v))}if(S instanceof AST_If&&S.body instanceof AST_Return){var T=S.body.value,y=S.body.in_bool||d instanceof AST_Return&&d.in_bool;if(!S.alternative&&d instanceof AST_Return&&(u||!T==!d.value)){f=!0,(S=S.clone()).alternative=ke(AST_BlockStatement,d,{body:w(!0,null,p+1)}),a[_]=S,a[_]=S.transform(i);continue}if(R&&r&&!d&&!S.alternative&&(y||T&&t||T instanceof AST_Conditional&&(Ce(T.consequent,i)||Ce(T.alternative,i)))){f=!0,(S=S.clone()).alternative=ke(AST_Return,S,{value:null}),a[_]=S,a[_]=S.transform(i);continue}if(n&&!S.alternative&&(!(g=a[y=function(e){for(var n=e;0<=--n;){var t=a[n];if(!(t instanceof AST_Var)&&!F(t))break}return n}(_)])&&e||g instanceof AST_If&&g.body instanceof AST_Return)&&(d?d instanceof AST_SimpleStatement&&N(p)==a.length:!r)){f=!0;var g=[];S=S.clone(),g.push(S.condition),S.condition=we(S,g),S.alternative=ke(AST_BlockStatement,l,{body:w().concat(ke(AST_Return,l,{value:null}))}),a[_]=S.transform(i),_=y+1;continue}}S instanceof AST_Break||S instanceof AST_Exit?s=S:r&&s&&s===d&&function e(n,t,i){if(n instanceof AST_Exit){var r=!(t&&n instanceof AST_Throw)&&x(n,!0);if(r)return f=!0,(r=D(n.value,r))?ke(AST_SimpleStatement,r,{body:r}):i?null:ke(AST_EmptyStatement,n)}else{var o;n instanceof AST_If?(n.body=e(n.body,t),n.alternative&&(n.alternative=e(n.alternative,t))):n instanceof AST_LabeledStatement?n.body=e(n.body,t):n instanceof AST_Try?n.bfinally&&s.value&&!s.value.is_constant()||(n.bcatch&&e(n.bcatch,t),(o=e(n.body.pop(),!0,!0))&&n.body.push(o)):n instanceof AST_Block&&!(n instanceof AST_Scope||n instanceof AST_Switch)&&(o=e(n.body.pop(),t,!0))&&n.body.push(o)}return n}(S)}return f;function b(n){return O(i,function(e){return e===n})}function x(e,n){var t;return!!s&&s.TYPE==e.TYPE&&!!(t=e.value)&&(!(e=!(e=s.equals(e))&&t instanceof AST_Sequence&&(t=t.tail_node(),s.value)&&s.value.equals(t)?2:e)&&!n&&s.value instanceof AST_Sequence&&s.value.tail_node().equals(t)?3:e)}function k(e){if(o=!1,function(e){if(e instanceof AST_Exit){if(!(o=x(e))){if(!R)return;if(!(e instanceof AST_Return))return;var n=e.value;if(n){if(!u)return;if(!Ce(n.tail_node()))return}if(l instanceof AST_SwitchBranch){if(!s)return;if(s instanceof AST_Exit&&s.value)return;o=4}}return 1}if(e instanceof AST_LoopControl){if(l instanceof AST_SwitchBranch)if(s instanceof AST_Exit){if(!R)return;if(s.value)return;o=!0}else if(s){if(i.loopcontrol_target(s)!==c)return;o=!0}else if(!1===s)return;n=i.loopcontrol_target(e);return e instanceof AST_Continue?b(ce(n)):!(n instanceof AST_IterationStatement)&&b(n)}}(e)){for(var n=a.length;--n>_;){var t=a[n];if(t instanceof AST_DefClass){if(t.name.definition().preinit)return}else if((t instanceof AST_Const||t instanceof AST_Let)&&!all(t.definitions,function(e){return!e.name.match_symbol(function(e){return e instanceof AST_SymbolDeclaration&&e.definition().preinit})}))return}return 1}}function w(e,n,t){var i=[],r=!1,o=_+1,t=(e?n?t=a.lastIndexOf(n):(n=a[t])!==s&&(s=!1):(t=a.length,s=null),a.splice(o,t-o).filter(function(e){return e instanceof AST_LambdaDefinition?(i.push(e),!1):(oe(e)&&(r=!0),!0)}));return 3===e&&(t.push(ke(AST_SimpleStatement,n.value,{body:we(n.value,n.value.expressions.slice(0,-1))})),n.value=n.value.tail_node()),[].push.apply(r?t:a,i),t}function D(e,n){if(e)switch(n){case 4:return e;case 3:if(!(e instanceof AST_Sequence))break;case 2:return we(e,e.expressions.slice(0,-1))}}function E(e,n){for(var t,e=se(e),i=e;(t=i[i.length-1])!==n;)i=t.body;i.pop();var r=n.value;return(r=o?D(r,o):r)&&i.push(ke(AST_SimpleStatement,r,{body:r})),e}function C(e,n){if(n&&e){switch(n){case 4:return;case 3:case 2:e=e.tail_node()}P(e,s.value)}}function N(e){r=!0;for(var n=e;++n<a.length;){var t=a[n];if(!F(t)){if(!(t instanceof AST_Var))break;r=!1}}return n}}(e,S)?i:3)&&3==r)break;if(S.option("awaits")&&S.option("side_effects")&&!(i=!function(e,n){if(!(!R||me&&me.bfinally)){for(var t=!1,i=e.length;0<=--i;){var r=e[i];if(!(r instanceof AST_SimpleStatement))break;var o=r.body.tail_node();if(!(o instanceof AST_Await))break;o=o.expression;if(!h(n,o))break;if(t=!0,o=o.drop_side_effect_free(n,!0),r.body instanceof AST_Sequence){var a=r.body.expressions.slice();a.pop(),o&&a.push(o),r.body=we(r.body,a);break}if(o){r.body=o;break}}return e.length=i+1,t}}(e,S)?i:4)&&4==r)break;if(4<=S.option("inline")&&!(i=!function(e,n){var t=!1,i=e.length-1;{var r;R&&0<=i&&(r=me&&me.bfinally&&B(ve),a=e[i].try_inline(n,de,r))&&(e[i--]=a,t=!0)}for(var o=he&&me&&me.bfinally?"try":he;0<=i;i--){var a;(a=e[i].try_inline(n,de,!0,o))&&(e[i]=a,t=!0)}return t}(e,S)?i:5)&&5==r)break;if(0<S.sequences_limit){if(!(i=!function(n,e){if(!(n.length<2)){for(var t=[],i=0,r=0,o=n.length;r<o;r++){var a=n[r];a instanceof AST_SimpleStatement?(t.length>=e.sequences_limit&&s(),re(t,a.body)):(F(a)||s(),n[i++]=a)}return s(),(n.length=i)!=o}function s(){var e;t.length&&(e=we(t[0],t),n[i++]=ke(AST_SimpleStatement,e,{body:e}),t=[])}}(e,S)?i:6)&&6==r)break;if(!(i=!function(e,n){for(var t,i=!1,r=0,o=0;o<e.length;o++){var a,s=e[o];if(t&&(s instanceof AST_Exit?!s.value&&B(ve)||(s.value=_(s.value||ke(AST_Undefined,s)).optimize(n)):s instanceof AST_For?s.init instanceof AST_Definitions||(a=!1,t.body.walk(new TreeWalker(function(e){return!!(a||e instanceof AST_Scope)||(e instanceof AST_Binary&&"in"==e.operator?a=!0:void 0)})),a)||(s.init?s.init=_(s.init):(s.init=t.body,r--,i=!0)):s instanceof AST_ForIn?oe(s.init)||(s.object=_(s.object)):s instanceof AST_If?s.condition=_(s.condition):(s instanceof AST_Switch||s instanceof AST_With)&&(s.expression=_(s.expression))),n.option("conditionals")&&s instanceof AST_If){var f=[],c=p(s.body,f),l=p(s.alternative,f);if(!1!==c&&!1!==l&&0<f.length){var u=f.length;f.push(ke(AST_If,s,{condition:s.condition,body:c||ke(AST_EmptyStatement,s.body),alternative:l})),f.unshift(r,1),[].splice.apply(e,f),o+=u,r+=u+1,i=!(t=null);continue}}e[r++]=s,t=s instanceof AST_SimpleStatement?s:null}return e.length=r,i;function _(e){r--,i=!0;var n=t.body;return we(n,[n,e])}}(e,S)?i:7)&&7==r)break}if(S.option("join_vars")&&!(i=!function(e){for(var r,n,o=!1,t=0,i=-1;t<e.length;t++){var a,s,f,c=e[t],l=e[i];if(c instanceof AST_Definitions)l&&l.TYPE==c.TYPE?(l.definitions=l.definitions.concat(c.definitions),o=!0):c&&l instanceof AST_Let&&c.can_letify(S)?(l.definitions=l.definitions.concat(Pn(c,de).definitions),o=!0):l&&c instanceof AST_Let&&l.can_letify(S)?(r=n,e[i]=l=Pn(l,de),l.definitions=l.definitions.concat(c.definitions),o=!0):r&&r.TYPE==c.TYPE&&W(c)?(r.definitions=r.definitions.concat(c.definitions),o=!0):c instanceof AST_Var?((s=A(l,c))?(s.length&&(l.body=we(l,s),i++),o=!0):i++,n=r,e[i]=r=c):e[++i]=c;else{if(c instanceof AST_Exit)c.value=u(c.value);else if(c instanceof AST_For)if(s=d(l,c.init))o=!0,c.init=s.length?we(c.init,s):null;else{if(l instanceof AST_Var&&(!c.init||c.init.TYPE==l.TYPE)){c.init&&(l.definitions=l.definitions.concat(c.init.definitions)),c=c.clone(),n=r,r=c.init=l,e[i]=_(c),o=!0;continue}if(r&&c.init&&r.TYPE==c.init.TYPE&&W(c.init))r.definitions=r.definitions.concat(c.init.definitions),c.init=null,o=!0;else if(c.init instanceof AST_Var&&(n=r,r=c.init,s=A(l,c.init))){if(o=!0,0==s.length){e[i]=_(c);continue}l.body=we(l,s)}}else if(c instanceof AST_ForEnumeration)r&&r.TYPE==c.init.TYPE&&(a=r.definitions.slice(),c.init=c.init.definitions[0].name.convert_symbol(AST_SymbolRef,function(e,n){a.push(ke(AST_VarDef,n,{name:n,value:null})),n.definition().references.push(e)}),r.definitions=a,o=!0),c.object=u(c.object);else if(c instanceof AST_If)c.condition=u(c.condition);else if(c instanceof AST_SimpleStatement){if(s=d(l,c.body)){if(o=!0,!s.length)continue;c.body=we(c.body,s)}else if(l instanceof AST_Definitions&&(f=e[t+1])&&l.TYPE==f.TYPE&&(f=f.definitions[0]).value){o=!0,f.value=we(c,[c.body,f.value]);continue}}else(c instanceof AST_Switch||c instanceof AST_With)&&(c.expression=u(c.expression));e[++i]=r?_(c):c}}return e.length=i+1,o;function u(e){var n=d(l,e,1);if(!n)return e;o=!0;var t=e.tail_node();return n[n.length-1]!==t&&n.push(t.left),we(e,n)}function _(e){return e.transform(new TreeTransformer(function(e,n,t){var i;return e instanceof AST_Definitions?r!==e&&r.TYPE==e.TYPE&&!((i=this.parent())instanceof AST_ForEnumeration&&i.init===e)&&W(e)?(r.definitions=r.definitions.concat(e.definitions),o=!0,i instanceof AST_For&&i.init===e?null:t?List.skip:ke(AST_EmptyStatement,e)):e:!(e instanceof AST_ExportDeclaration)&&!(e instanceof AST_Scope)&&is_statement(e)?void 0:e}))}}(e)?i:8)&&8==r)break;!S.option("collapse_vars")||!function(i,_){if(!ve.pinned()){for(var S,z,U=new Dictionary,p=[],j=!1,d=new Dictionary,r=i.length,l=new TreeTransformer(function(e,n){if(D)return e;if(!w){if(e===A[T]){if(++T<A.length)return O(e,l);w=!0,(u=(h?F:te)(e,0))===e&&(D=!0)}return e}var t,i,r,o=l.parent();if(!m&&ee(e,o)&&(m=o),I&&V&&C&&!m&&e instanceof AST_Assign&&"="!=e.operator&&e.left.equals(v))return E++,j=!0,AST_Node.info("Cascading {this} [{start}]",e),C=!1,b=ue(v),e.right.transform(l),ce(s),i=D?s:(D=!0,ke(AST_Binary,s,{operator:I,left:v.fixed&&v.definition().fixed?v.fixed.to_binary(s):v,right:k})),ke(AST_Assign,e,{operator:"=",left:e.left,right:ke(AST_Binary,e,{operator:e.operator.slice(0,-1),left:i,right:e.right})});if(function(n,e){if(n===k)return 1;if(e instanceof AST_For&&n!==e.init)return 1;if(n instanceof AST_Assign)return"="!=n.operator&&v.equals(n.left);if(n instanceof AST_BlockStatement)return K&&!all(K,function(e){return n!==e});if(n instanceof AST_Call)return v instanceof AST_PropAccess&&v.equals(n.expression)&&(!(k instanceof AST_LambdaExpression)||k.contains_this());return n instanceof AST_Class?!_.has_directive("use strict"):n instanceof AST_Debugger||(n instanceof AST_Defun?M&&v.name===n.name.name:n instanceof AST_DestructuredKeyVal?n.key instanceof AST_Node:n instanceof AST_DWLoop||n instanceof AST_LoopControl||n instanceof AST_Try||n instanceof AST_With)}(e,o))return D=!0,e;if(e.single_use)return e;if(e instanceof AST_SymbolDeclaration||!(V&&v.equals(e)||g&&(t=g(e,this))))return function(e,n){if(e instanceof AST_SymbolRef){if(e.is_declared(_)){if(e.fixed_value())return;if(be(e))return!(n instanceof AST_PropAccess&&n.expression===e)&&ge(e.definition())}else if(Z(e,n))return;if(!Q)return 1;g=!1}return}(e,o)?(D=!0,e):((ne(e,o)||H(e))&&(u=e)instanceof AST_Scope&&(D=!0),e instanceof AST_Accessor||e instanceof AST_Destructured?(r=C,C=!1,n(e,l),C=r,R(e)):e instanceof AST_DefaultValue?(e.name=e.name.transform(l),r=C,C=!1,e.value=e.value.transform(l),C=r,R(e)):!(e instanceof AST_BlockScope)||e instanceof AST_Scope||e.variables&&e.variables.all(function(e){return!G.has(e.name)&&!b.has(e.name)})?O(e,l)?R(e):void 0:(r=C,C=!1,O(e,l)||n(e,l),C=r,R(e)));if(!C||m&&(t||!X||!Q))return t||h||(D=!0),e;if(is_lhs(e,o))return h&&!t&&(c=!0),e;if(!t&&L&&e.fixed!==v.fixed)return D=!0,e;if(h)return m&&0==f&&(f=a-E),t||E++,e;if(E++,j=D=!0,AST_Node.info("Collapsing {this} [{start}]",e),"Binary"==s.TYPE)return le(s,e),ke(AST_Assign,s,{operator:"=",left:s.right.left,right:ke(AST_Conditional,s,"&&"==s.operator?{condition:s.left,consequent:s.right.right,alternative:e}:{condition:s.left,consequent:e,alternative:s.right.right})});if(s instanceof AST_UnaryPostfix)return ke(AST_UnaryPrefix,s,{operator:s.operator,expression:v.fixed&&v.definition().fixed?v.fixed.to_prefix(s):v});if(s instanceof AST_UnaryPrefix)return ce(s),s;if(le(k,e),s instanceof AST_VarDef)return(i=s.name.definition()).references.length-i.replaced!=1||_.exposed(i)?ke(AST_Assign,s,{operator:"=",left:e,right:k}):(i.replaced++,De(o,e,k));ce(k);n=s.clone();return n.right=k,n},R),o=new TreeTransformer(function(e){if(D)return e;if(!w){if(e!==A[T])return e;switch(T++,A.length-T){case 0:if(w=!0,c)return e;if(e!==s)return e;if(e instanceof AST_VarDef)return e;N.replaced++;var n=o.parent();return n instanceof AST_Sequence&&n.tail_node()!==e?(h.replaced++,k===x?List.skip:we(x,x.expressions.slice(0,-1))):k;case 1:if(!c&&e.body===s)return w=!0,N.replaced++,h.replaced++,null;default:return O(e,o)}}if(e instanceof AST_SymbolRef&&e.definition()===N){if(is_lhs(e,o.parent()))return e;--E||(D=!0),AST_Node.info("Replacing {this} [{start}]",e);var t=k.clone();return(t.scope=e.scope,t.reference(),E==f)?(D=!0,ke(AST_Assign,s,{operator:"=",left:e,right:t})):(N.replaced++,t)}return e instanceof AST_Default||e instanceof AST_Scope?e:void 0},function(e){return _e(e,o)});0<=--r;){0==r&&_.option("unused")&&!function(){if(!1!==Te){var e=_.parent(),i=_.self();if(void 0===Te){if(!(i instanceof AST_LambdaExpression)||is_generator(i)||i.uses_arguments||i.pinned()||!(e instanceof AST_Call)||e.expression!==i||!all(e.args,function(e){return!(e instanceof AST_Spread)}))return Te=!1;if(!Fe(e))return;Te=!0}for(var r,o=i.in_strict_mode(_)&&!i.parent_scope.resolve(!0).in_strict_mode(_),a=(is_async(i)?(r=function(e){return e instanceof AST_Symbol&&"await"==e.name},Ae=!0):(r=function(e){return e instanceof AST_Await&&!n.find_parent(AST_Scope)},void 0===Ae&&(Ae=Be(_,1,e,null,!0,!0))),null),n=new TreeWalker(function(e,n){var t;return!l||(r(e)||e instanceof AST_Yield?!(l=null):e instanceof AST_ObjectIdentity?(!o&&a||(l=null),!0):e instanceof AST_SymbolRef?((e.in_arg&&!On(e.definition())||(t=i.variables.get(e.name))&&t!==e.definition())&&(l=null),!0):e instanceof AST_Scope&&!is_arrow(e)?(t=a,a=e,n(),a=t,!0):void 0)}),t=(S=e.args.slice()).length,s=new Dictionary,f=i.argnames.length;0<=--f;){var c=i.argnames[f],l=S[f],u=null;if(c instanceof AST_DefaultValue&&(u=c.value,c=c.name,S[t+f]=u),c instanceof AST_Destructured){if(Ae&&B(function(e){return e.has_side_effects(_)},c,l)){p.length=0;break}S[t+f]=i.argnames[f]}else s.has(c.name)||(s.set(c.name,!0),(l=u?Ce(l)?u:null:l)||u?l instanceof AST_Lambda&&l.pinned()?l=null:l&&l.walk(n):l=ke(AST_Undefined,c).transform(_),l&&((c=ke(AST_VarDef,c,{name:c,value:l})).name_index=f,c.arg_index=u?t+f:f,p.unshift([c])))}i.rest&&S.push(i.rest)}}();var A=[];for(P(i[r]);0<p.length;){A=p.pop();var a,T=0,s=A[A.length-1],f=-1,c=!1,L=!1,h=null,u=null,m=null,v=function(n){if(n instanceof AST_Assign)return(t=n.left)instanceof AST_SymbolRef&&(i=t.definition(),ve.uses_arguments&&is_funarg(i)||_.exposed(i)||(a=ae(i),i.fixed&&t.fixed&&(e=i.references.filter(function(e){return e.fixed===t.fixed}).length-1)<a&&(a=e,L=!(f=0)),"="==n.operator&&oe(n.right))),t;if(n instanceof AST_Binary)return n.right.left;if(n instanceof AST_Unary)return n.expression;if(n instanceof AST_VarDef){var t,e,i=(t=n.name).definition();if(!i.const_redefs)if(member(t,i.orig))if(!ve.uses_arguments||!is_funarg(i))return e=i.orig.length-i.eliminated-(d.get(i.name)||0),a=ae(i),i.fixed&&(a=Math.min(a,i.references.filter(function(e){return!e.fixed||!e.fixed.assigns||(e=e.fixed.assigns[0])===t||se(e)===n.value}).length)),1<e&&!(t instanceof AST_SymbolFunarg)?(oe(n.value),ke(AST_SymbolRef,t)):oe(n.value)||1==a&&!_.exposed(i)?ke(AST_SymbolRef,t):void 0}}(s),y=v&&v.has_side_effects(_),V=v&&(!y||v instanceof AST_SymbolRef)&&!Pe(v,_),g=function(n){if(!(n instanceof AST_Assign&&n.right.single_use)){for(var t,i=Object.create(null),e=new TreeWalker(function(e){e instanceof AST_SymbolRef&&(i[e.definition().id]=!0)});n instanceof AST_Assign&&"="==n.operator;)n.left.walk(e),n=n.right;if(n instanceof AST_ObjectIdentity)return o;if(n instanceof AST_SymbolRef)return(r=n.evaluate(_))===n?o:fe(r,o);if(n.is_truthy())return fe(!0,return_false);if(n.is_constant()){var r=n.evaluate(_);if(!(r instanceof AST_Node))return fe(r,o)}return v instanceof AST_SymbolRef?!!function e(n){if(n instanceof AST_Array)return!1;if(n instanceof AST_Binary&&Ne[n.operator])return e(n.left)&&e(n.right);if(n instanceof AST_Call)return!1;if(n instanceof AST_Conditional)return e(n.consequent)&&e(n.alternative);if(n instanceof AST_Object)return!1;return!n.has_side_effects(_)}(n)&&(n.walk(new TreeWalker(function(e){if(t)return!0;e instanceof AST_SymbolRef&&i[e.definition().id]&&(t=!0)})),!t)&&o:!1}function o(e){return n.equals(e)}}(s);if(V||g){var I=s instanceof AST_Assign&&s.operator.slice(0,-1),M=s.name instanceof AST_SymbolFunarg,H=return_false;if(s.may_throw(_)){if(M&&is_async(ve))continue;H=me?function(e){return e.has_side_effects(_)}:t}var W=!1,Y=!1,K=function(e){if(e instanceof AST_SymbolDeclaration||e instanceof AST_SymbolRef||e instanceof AST_Destructured){var n=[];if(e.mark_symbol(function(e){var t,i;e instanceof AST_Symbol&&(e=e.definition(),t=e.scope.resolve(),i=!1,e=e.orig.reduce(function(e,n){return n instanceof AST_SymbolDefun?n.scope!==t&&push_uniq(e,n.scope):i=!0,e},[]),i)&&e.forEach(function(e){push_uniq(n,e)})}),0!=n.length)return n}}(v),G=new Dictionary,$=!0,b=ue(s),X=function(e){var n=root_expr(e);return n instanceof AST_SymbolRef&&n.definition().scope.resolve()===ve&&(!he||!I&&!(s instanceof AST_Unary||(n=b.get(n.name))&&n[0]!==e))}(v),x=se(s),k=x,J=(y||(!I&&k instanceof AST_Sequence&&(k=k.tail_node()),y=!(s instanceof AST_Unary)&&k.has_side_effects(_)),me||!X?function(e){return e instanceof AST_Destructured}:return_false),Q=function(e){if(e instanceof AST_Unary)return!1;if(y)return!1;if(!h){if(!(v instanceof AST_SymbolRef))return!1;var n;if(e instanceof AST_VarDef)n=1;else{if("="!=e.operator)return!1;n=2}e=v.definition();if(e.references.length-e.replaced!=n){if(!e.fixed)return!1;if(!v.fixed)return!1;var t=v.fixed.assigns,i=0;if(!all(e.references,function(e,n){e=e.fixed;return!!e&&!e.to_binary&&!e.to_prefix&&(e===v.fixed?(i++,!0):t&&e.assigns&&t[0]!==e.assigns[0])}))return!1;if(i!=n)return!1;L=!0}}return!0}(s),w=M,D=!1,E=0,C=!S||!w;if(!C){for(var n=s.arg_index+1;!D&&n<S.length;n++)S[n]&&S[n].transform(l);C=!0}for(var e=r;!D&&e<i.length;e++)i[e].transform(l);if(h){if(!E||E+c<a){p.push(A),z=!0;continue}E==f&&(c=!0);var N=v.definition();D=!1,T=0,w=M;for(e=r;!D&&e<i.length;e++)i[e].transform(o)||i.splice(e--,1);E=s instanceof AST_VarDef&&s===A[A.length-1]&&N.references.length==N.replaced&&!_.exposed(N),h.last_ref=!1,h.single_use=!1,j=!0}E&&!function(e){var n,t,f,c,l,u=k===x?null:we(x,x.expressions.slice(0,-1)),e=e.name_index;0<=e?(t=ve.argnames[e])instanceof AST_DefaultValue?(ve.argnames[e]=t=t.clone(),t.value=u||ke(AST_Number,t,{value:0})):(n=_.parent().args)[e]&&(ve.argnames[e]=t.clone(),n[e]=u||ke(AST_Number,n[e],{value:0})):(f=A.length-1,c=A[f],(c instanceof AST_VarDef||A[f-1].body===c)&&f--,l=new TreeTransformer(function(e,n,t){var i,r,o,a,s;return w||e!==A[T]?e:++T<=f?O(e,l):(w=!0,e instanceof AST_Definitions?(d.set(c.name.name,(d.get(c.name.name)||0)+1),h&&h.replaced++,r=(i=e.definitions).indexOf(c),(o=c.clone()).value=null,u?(a=[ke(AST_SimpleStatement,u,{body:u})],0<r&&((s=e.clone()).definitions=i.slice(0,r),a.unshift(s),(e=e.clone()).definitions=i.slice(r)),a.push(e),e.definitions[0]=o,t?List.splice(a):ke(AST_BlockStatement,e,{body:a})):(e.definitions[r]=o,e)):u?is_statement(e)?ke(AST_SimpleStatement,u,{body:u}):u:t?List.skip:null)},function(e,n){return e instanceof AST_For?Ue(e,n):_e(e,l)}),w=D=!1,T=0,(i[r]=i[r].transform(l))||i.splice(r,1))}(s)}}}return j}function R(e){return D||(u===e&&(D=!0),m===e&&(m=null)),e}function O(e,n){if(e instanceof AST_BlockScope){if(e instanceof AST_Scope)return e;if(e instanceof AST_Class){for(var t=C,i=(C=!1,e.name&&e.name.transform(n),!D&&e.extends&&e.extends.transform(n),[]),r=[],o=0;!D&&o<e.properties.length;o++){var a=e.properties[o];a.key instanceof AST_Node&&(a.key=a.key.transform(n)),a.static&&(a instanceof AST_ClassField?a.value&&i.push(a):a instanceof AST_ClassInit&&[].push.apply(r,a.value.body))}for(o=0;!D&&o<r.length;o++)r[o].transform(n);for(o=0;!D&&o<i.length;o++)i[o].value.transform(n);return C=t,e}if(e instanceof AST_ForEnumeration)return e.object=e.object.transform(n),D=!0,e;if(e instanceof AST_Switch){e.expression=e.expression.transform(n);for(o=0;!D&&o<e.body.length;o++){var s=e.body[o];if(s instanceof AST_Case){if(!w){if(s!==A[T])continue;T++}if(s.expression=s.expression.transform(n),!Q||L)break;g=!1}}return D=!0,e}}}function Z(e,n){return n instanceof AST_Assign?"="==n.operator&&n.left===e:n instanceof AST_DefaultValue?n.name===e:n instanceof AST_DestructuredArray||n instanceof AST_DestructuredKeyVal&&n.value===e}function ee(e,n){return n instanceof AST_Assign?n.left!==e&&Ne[n.operator.slice(0,-1)]:n instanceof AST_Binary?n.left!==e&&Ne[n.operator]:n instanceof AST_Call?n.optional&&n.expression!==e:n instanceof AST_Case?n.expression!==e:n instanceof AST_Conditional||n instanceof AST_If?n.condition!==e:n instanceof AST_Sub&&n.optional&&n.expression!==e}function ne(e,n){if(e instanceof AST_Await)return 1;if("Binary"==e.TYPE)return!Gn(e,_);if(e instanceof AST_Call){var t=e.expression;if(t instanceof AST_SymbolRef&&(f=t.definition(),t=t.fixed_value()),!(t instanceof AST_Lambda))return!e.is_expr_pure(_);if(!f||!Qn(_,f,t)){if(t.collapse_scanning)return;t.collapse_scanning=!0;for(var i=C,r=(C=!1,u),o=m,a=0;!D&&a<t.argnames.length;a++)B(c,t.argnames[a],e.args[a])&&(D=!0);if(!D)if(t.rest&&B(c,t.rest,ke(AST_Array,e,{elements:e.args.slice(a)})))D=!0;else if(is_arrow(t)&&t.value)t.value.transform(l);else for(a=0;!D&&a<t.body.length;a++){var s=t.body[a];if(s instanceof AST_Return){s.value&&s.value.transform(l);break}s.transform(l)}if(m=o,u=r,C=i,t.collapse_scanning=!1,!D)return;D=!1}return 1}var f;if(e instanceof AST_Class)return me&&(o=e.extends)&&!Re(o=o instanceof AST_SymbolRef?o.fixed_value():o);if(e instanceof AST_Exit){if(me){if(me.bfinally)return 1;if(me.bcatch&&e instanceof AST_Throw)return 1}return y||v instanceof AST_PropAccess||pe(v)}if(e instanceof AST_Function)return _.option("ie")&&e.name&&b.has(e.name.name);if(e instanceof AST_ObjectIdentity)return Se(e);if(e instanceof AST_PropAccess){r=e.expression;if(_.option("unsafe")){if(Ee(r)&&qe[r.name])return;if(nn(r))return}return r instanceof AST_SymbolRef&&ge(r.definition())?1:y||!$||!h&&(me||!X)&&!e.optional&&r.may_throw_on_access(_)}return e instanceof AST_Spread||(e instanceof AST_SymbolRef?(!Ee(e)||!e.is_declared(_))&&(Se(e)?!Z(e,n):y&&pe(e)||(f=e.definition(),(me||f.scope.resolve()!==ve)&&!be(e))):e instanceof AST_Template?!e.is_expr_pure(_):e instanceof AST_VarDef?J(e.name)||(e.value||n instanceof AST_Let)&&e.name.match_symbol(function(e){return e instanceof AST_SymbolDeclaration&&(b.has(e.name)||y&&pe(e))},!0):e instanceof AST_Yield||(i=is_lhs(e.left,e))&&(i instanceof AST_PropAccess||J(i)||i.match_symbol(function(e){return e instanceof AST_PropAccess||(e instanceof AST_SymbolRef?b.has(e.name)||W&&_.exposed(e.definition()):void 0)},!0)));function c(e){return e.transform(l),D}}function B(t,e,i){return e instanceof AST_DefaultValue?t(e.value)||B(t,e.name,e.value)||!Ce(i)&&B(t,e.name,i):i?e instanceof AST_Destructured?!(!e.rest||!B(t,e.rest))||(e instanceof AST_DestructuredArray?i instanceof AST_Array?!all(e.elements,function(e,n){return!B(t,e,i[n])}):!i.is_string(_)||!all(e.elements,function(e){return!B(t,e)}):e instanceof AST_DestructuredObject?!!i.may_throw_on_access(_)||!all(e.properties,function(e){return!(e.key instanceof AST_Node&&t(e.key)||B(t,e.value))}):void 0):void 0:!(e instanceof AST_Symbol)}function P(e,n){var t,i;A.push(e),e instanceof AST_Array?e.elements.forEach(function(e){P(e,n)}):e instanceof AST_Assign?((i=e.left)instanceof AST_Destructured||p.push(A.slice()),P(i),P(e.right),i instanceof AST_SymbolRef&&"="==e.operator&&U.set(i.name,(U.get(i.name)||0)+1)):e instanceof AST_Await?P(e.expression,n):e instanceof AST_Binary?(i=Ne[e.operator],n&&i&&"??"!=e.operator&&e.right instanceof AST_Assign&&"="==e.right.operator&&!(e.right.left instanceof AST_Destructured)&&p.push(A.slice()),P(e.left,!i&&n),P(e.right,n)):e instanceof AST_Call?(P(e.expression),e.args.forEach(P)):e instanceof AST_Case?P(e.expression):e instanceof AST_Conditional?(P(e.condition),P(e.consequent,n),P(e.alternative,n)):e instanceof AST_Definitions?e.definitions.forEach(P):e instanceof AST_Dot?P(e.expression):e instanceof AST_DWLoop?(P(e.condition),e.body instanceof AST_Block||P(e.body)):e instanceof AST_Exit?e.value&&P(e.value):e instanceof AST_For?(e.init&&P(e.init,!0),e.condition&&P(e.condition),e.step&&P(e.step,!0),e.body instanceof AST_Block||P(e.body)):e instanceof AST_ForEnumeration?(P(e.object),e.body instanceof AST_Block||P(e.body)):e instanceof AST_If?(P(e.condition),e.body instanceof AST_Block||P(e.body),!e.alternative||e.alternative instanceof AST_Block||P(e.alternative)):e instanceof AST_Object?e.properties.forEach(function(e){A.push(e),e.key instanceof AST_Node&&P(e.key),e instanceof AST_ObjectKeyVal&&P(e.value,n),A.pop()}):e instanceof AST_Sequence?(t=e.expressions.length-(n?0:1),e.expressions.forEach(function(e,n){P(e,n<t)})):e instanceof AST_SimpleStatement?P(e.body,!0):e instanceof AST_Spread?P(e.expression):e instanceof AST_Sub?(P(e.expression),P(e.property)):e instanceof AST_Switch?(P(e.expression),e.body.forEach(P)):e instanceof AST_Unary?UNARY_POSTFIX[e.operator]?p.push(A.slice()):P(e.expression):e instanceof AST_VarDef?(e.name instanceof AST_SymbolVar&&(e.value?(i=e.name.definition()).references.length>i.replaced&&p.push(A.slice()):d.set(e.name.name,(d.get(e.name.name)||0)+1)),e.value&&P(e.value)):e instanceof AST_Yield&&e.expression&&P(e.expression),A.pop()}function te(e,n){var t=l.parent(n);return t instanceof AST_Array||t instanceof AST_Assign||t instanceof AST_Await||t instanceof AST_Binary||t instanceof AST_Call||t instanceof AST_Case||t instanceof AST_Conditional?e:t instanceof AST_Definitions?q(t,n+1):t instanceof AST_Exit||t instanceof AST_If||t instanceof AST_IterationStatement||t instanceof AST_ObjectProperty||t instanceof AST_PropAccess?e:t instanceof AST_Sequence?(t.tail_node()===e?te:q)(t,n+1):t instanceof AST_SimpleStatement?q(t,n+1):t instanceof AST_Spread||t instanceof AST_Switch||t instanceof AST_Unary||t instanceof AST_VarDef||t instanceof AST_Yield?e:null}function ie(e,n,t){for(var i;i=e,(e=l.parent(++t))instanceof AST_Assign&&e.operator.slice(0,-1)==n||e instanceof AST_Binary&&e.operator==n;);return i}function re(e,n,t,i,r){var o=C,a=(C=!1,u),s=m,f=l.stack;return l.stack=[i],e.transform(l),l.stack=f,m=s,u=a,C=o,D?(D=!1,t):n(i,r+1)}function F(e,n){var t,i=l.parent(n);return i instanceof AST_Array?F(i,n+1):i instanceof AST_Assign?H(i)||i.left.match_symbol(function(e){return e instanceof AST_SymbolRef&&(v.name==e.name||h.name==e.name)})?e:i.left!==e&&Ne[t=i.operator.slice(0,-1)]?ie(i,t,n):F(i,n+1):i instanceof AST_Await?F(i,n+1):i instanceof AST_Binary?i.left!==e&&Ne[t=i.operator]?ie(i,t,n):F(i,n+1):i instanceof AST_Call?i:i instanceof AST_Case?i.expression!==e?e:F(i,n+1):i instanceof AST_Conditional?i.condition!==e?e:F(i,n+1):i instanceof AST_Definitions?q(i,n+1):i instanceof AST_Do?e:i instanceof AST_Exit?q(i,n+1):i instanceof AST_For?i.init!==e&&i.condition!==e?e:F(i,n+1):i instanceof AST_ForEnumeration?i.init!==e?e:F(i,n+1):i instanceof AST_If?i.condition!==e?e:F(i,n+1):i instanceof AST_ObjectProperty?(t=l.parent(n+1),all(t.properties,function(e){return e instanceof AST_ObjectKeyVal})?F(t,n+2):t):i instanceof AST_PropAccess?i.expression===e?F(i,n+1):e:i instanceof AST_Sequence?(i.tail_node()===e?F:q)(i,n+1):i instanceof AST_SimpleStatement?q(i,n+1):i instanceof AST_Spread?F(i,n+1):i instanceof AST_Switch?i.expression!==e?e:F(i,n+1):i instanceof AST_Unary?"delete"==i.operator?e:F(i,n+1):i instanceof AST_VarDef?i.name.match_symbol(function(e){return e instanceof AST_SymbolDeclaration&&(v.name==e.name||h.name==e.name)})?e:F(i,n+1):i instanceof AST_While?i.condition!==e?e:F(i,n+1):i instanceof AST_Yield?F(i,n+1):null}function q(n,t){var e,i=l.parent(t);return ne(n,i)||ee(n,i)?n:i instanceof AST_Array?q(i,t+1):i instanceof AST_Assign?r(i.left):i instanceof AST_Await?n:i instanceof AST_Binary||i instanceof AST_Call||i instanceof AST_Case||i instanceof AST_Conditional||i instanceof AST_Definitions||i instanceof AST_Exit||i instanceof AST_If?q(i,t+1):i instanceof AST_IterationStatement?n:i instanceof AST_ObjectProperty?(e=l.parent(t+1),all(e.properties,function(e){return e instanceof AST_ObjectKeyVal})?q(e,t+2):e):i instanceof AST_PropAccess?(e=i.expression)===n?q(i,t+1):re(e,q,n,i,t):i instanceof AST_Sequence||i instanceof AST_SimpleStatement?q(i,t+1):i instanceof AST_Spread?n:i instanceof AST_Switch||i instanceof AST_Unary?q(i,t+1):i instanceof AST_VarDef?r(i.name):i instanceof AST_Yield?n:null;function r(e){return H(i)?n:e!==n&&e instanceof AST_Destructured?re(e,q,n,i,t):q(i,t+1)}}function oe(e){if(z)z=!1;else if(!(a<1)){var n=(e=e.tail_node())instanceof AST_Assign&&"="==e.operator?e.left:e;if(n instanceof AST_SymbolRef){var t=n.definition();if(!t.undeclared&&!ge(t)){if(n!==e){if(Pe(n,_))return;if(t.references.length-t.replaced<2)return;e=s.clone();e[e instanceof AST_Assign?"right":"value"]=n,0<=s.name_index&&(e.name_index=s.name_index,e.arg_index=s.arg_index),s=e}return h=t}}}}function ae(e){return e.references.length-e.replaced-(U.get(e.name)||0)}function se(e){var n;return e instanceof AST_Assign?e.right:e instanceof AST_Binary?((n=e.clone()).right=e.right.right,n):e instanceof AST_VarDef?e.value:void 0}function fe(t,i){return function(e,n){if(n.in_boolean_context()){if(t&&e.is_truthy()&&!e.has_side_effects(_))return!0;if(e.is_constant()){n=e.evaluate(_);if(!(n instanceof AST_Node))return!n==!t}}return i(e)}}function ce(e){for(;e.write_only&&(e.write_only=!1,e instanceof AST_Assign);)e=e.right}function le(e,n){var t=n instanceof AST_SymbolRef&&!n.defined,i=n.scope||xe(l)||de;e.walk(new TreeWalker(function(e){if(e instanceof AST_BlockScope)return!0;e instanceof AST_Symbol&&(t&&e instanceof AST_SymbolRef&&(e.defined=!1),e.scope=i)}))}function ue(s){var f=new Dictionary,c=(s instanceof AST_VarDef&&(s.name.definition().fixed||($=!1),f.add(s.name.name,v)),ve.uses_arguments&&!_.has_directive("use strict")),l=ve instanceof AST_Toplevel,u=new TreeWalker(function(n){var e,t,i;if(n instanceof AST_SymbolRef?(e=n.fixed_value())||(t=(e=n).definition(),i=n.fixed&&n.fixed.escaped||t.escaped,t.undeclared)||!t.assignments&&i&&!i.cross_scope||!Oe(t,n.scope,n,u.parent())&&Zn(t)||($=!1):n instanceof AST_ObjectIdentity&&(e=n),e)f.add(n.name,ye(_,u,n,e,0));else{if(n instanceof AST_Lambda){for(var r,o=0,a=n;r=u.parent(o++);a=r){if(r instanceof AST_Assign){if(r.left===a)break;if("="==r.operator)continue;if(Ne[r.operator.slice(0,-1)])continue;break}if(r instanceof AST_Binary){if(Ne[r.operator])continue;break}if(r instanceof AST_Call)return;if(r instanceof AST_Scope)return;if(r instanceof AST_Sequence){if(r.tail_node()===a)continue;break}if(r instanceof AST_Template){if(r.tag)return;break}}return n.enclosed.forEach(function(e){e.scope!==n&&G.set(e.name,!0)}),!0}c&&n instanceof AST_Sub&&(ve.each_argname(function(e){_.option("reduce_vars")&&!e.definition().assignments||(e.definition().fixed||($=!1),f.add(e.name,!0))}),c=!1)}l&&("Call"==n.TYPE?Y||(i=n.expression)instanceof AST_PropAccess||i instanceof AST_LambdaExpression&&!i.contains_this()||(Y=!0):n instanceof AST_PropAccess&&function e(n){return n instanceof AST_SymbolRef&&!(n=n.fixed_value())||(n instanceof AST_Assign?"="==n.operator&&e(n.right):n instanceof AST_PropAccess||n instanceof AST_ObjectIdentity)}(n.expression)&&(n!==v||s instanceof AST_Unary?W=!0:Y=!0))});return s.walk(u),f}function _e(e,n){if(e instanceof AST_Sequence)switch(e.expressions.length){case 0:return null;case 1:return De(n.parent(),e,e.expressions[0])}}function Se(e){e=b.get(e.name);if(e&&!all(e,function(e){return!e}))return e[0]!==v||void(g=!1)}function pe(e){e=e.definition();return!(1==e.orig.length&&e.orig[0]instanceof AST_SymbolDefun||e.scope.resolve()===ve&&(!Y||!_.exposed(e))&&all(e.references,function(e){return e.scope.resolve(!0)===ve}))}function t(e,n){if(e instanceof AST_Assign)return t(e.left,!0);if(e instanceof AST_Unary)return t(e.expression,!0);if(e instanceof AST_VarDef)return e.value&&t(e.value);if(n){if(e instanceof AST_Dot)return t(e.expression,!0);if(e instanceof AST_Sub)return t(e.expression,!0);if(e instanceof AST_SymbolRef)return e.definition().scope.resolve()!==ve}return!1}}(e,S)||(i=9)}while(i&&0<o--);return e;function O(e,n){var t,i,r=e.self(),o=0;do{r instanceof AST_Catch?r=e.parent(o++):r instanceof AST_LabeledStatement?r=r.body:r instanceof AST_SwitchBranch&&((i=e.parent(o)).body[i.body.length-1]!==r&&!function(e){for(var n=e.length;0<=--n;)if(e[n]instanceof AST_Break)return 1;return}(r.body)||(o++,r=i));do{if(n(t=r))return t}while((r=e.parent(o++))instanceof AST_If)}while(t&&(r instanceof AST_BlockStatement||r instanceof AST_Catch||r instanceof AST_Scope||r instanceof AST_SwitchBranch||r instanceof AST_Try)&&ze(r.body,t))}function p(e,n){if(!(e instanceof AST_BlockStatement))return e;for(var t=null,i=0;i<e.body.length;i++){var r=e.body[i];if(r instanceof AST_Var&&W(r))n.push(r);else{if(t||oe(r))return!1;t=r}}return t}function u(e){return e instanceof AST_Assign?[e]:e instanceof AST_Sequence?e.expressions.slice():void 0}function d(e,n,t){var i=u(n);if(i){for(var r=!1,o=i.length-(t=t||0);0<=--o;)if(l(f=i[o])){if(f.left instanceof AST_SymbolRef)a=i.slice(o+1);else{if(!(f.left instanceof AST_PropAccess&&l(f.left.expression)))continue;var a=i.slice(o+1),s=f.clone(),f=f.left.expression;s.left=s.left.clone(),s.left.expression=f.left.clone(),a.unshift(s)}0!=a.length&&T(f.left,f.right,a)&&(r=!0,i=i.slice(0,o).concat(f,a))}if(e instanceof AST_Definitions){for(o=e.definitions.length;0<=--o;){var c=e.definitions[o];if(c.value){T(c.name,c.value,i)&&(r=!0),!function(e,n,t){if(S.option("conditionals")&&!(e.name instanceof AST_Destructured)){for(var i=!1,r=e.name.definition();n.length>t;){var o=In(S,r,e.value,n[0]);if(!o)break;e.value=o,n.shift(),i=!0}return i}}(c,i,t)||(r=!0);break}}e instanceof AST_Var&&_(e.definitions,i,t)&&(r=!0)}return r&&i}function l(e){return e instanceof AST_Assign&&"="==e.operator}}function A(e,n){if(e instanceof AST_SimpleStatement&&!W(n)){e=u(e.body);if(e){var t=[];if(_(t,e.reverse(),0))return n.definitions=t.reverse().concat(n.definitions),e.reverse()}}}function _(e,n,t){for(var i=!1;n.length>t;){var r=n[0];if(!(r instanceof AST_Assign))break;if("="!=r.operator)break;var o=r.left;if(!(o instanceof AST_SymbolRef))break;if(Ee(o))break;if(o.scope.resolve()!==ve)break;var a=o.definition();if(a.scope!==ve)break;if(a.orig.length>a.eliminated+1)break;if("SymbolVar"!=a.orig[0].TYPE)break;o=ke(AST_SymbolVar,o);e.push(ke(AST_VarDef,r,{name:o,value:r.right})),a.orig.push(o),a.replaced++,n.shift(),i=!0}return i}function T(e,s,n){var f=new Dictionary;for(f.set(e.name,!0);s instanceof AST_Assign&&"="==s.operator;)s.left instanceof AST_SymbolRef&&f.set(s.left.name,!0),s=s.right;if(s instanceof AST_Array){var t=!1;do{if(!function e(n){if(!(n instanceof AST_Assign))return;if("="!=n.operator)return;if(!(n.left instanceof AST_PropAccess))return;var t=n.left.expression;if(!(t instanceof AST_SymbolRef))return;if(!f.has(t.name))return;if(!n.right.is_constant_expression(ve))return;var i=n.left.property;i instanceof AST_Node&&(i=(i=e(i)?n.left.property=i.right.clone():i).evaluate(S));if(i instanceof AST_Node)return;if(!y.test(""+i))return;i=+i;var r=s.elements;var o=r.length;if(o+4<i)return;for(var a=Math.min(o,i+1);0<=--a;)if(r[a]instanceof AST_Spread)return;if(i<o){t=r[i].drop_side_effect_free(S);r[i]=t?we(n,[t,n.right]):n.right}else{for(;o<i;)r[o++]=ke(AST_Hole,s);r[i]=n.right}return!0}(n[0]))break}while(n.shift(),t=!0,n.length);return t}if(s instanceof AST_Object){t=!1;do{if(!function e(n){if(!(n instanceof AST_Assign))return;if("="!=n.operator)return;if(!(n.left instanceof AST_PropAccess))return;var t=n.left.expression;if(!(t instanceof AST_SymbolRef))return;if(!f.has(t.name))return;if(!n.right.is_constant_expression(ve))return;var i=n.left.property;i instanceof AST_Node&&(i=(i=e(i)?n.left.property=i.right.clone():i).evaluate(S));if(i instanceof AST_Node)return;i=""+i;t="__proto__"==i||S.has_directive("use strict")?function(e){e=e.key;return"string"==typeof e&&e!=i&&"__proto__"!=e}:function(e){var n=e.key;return e instanceof AST_ObjectGetter||e instanceof AST_ObjectSetter?"string"==typeof n&&n!=i:"__proto__"!==n};if(!all(s.properties,t))return;s.properties.push(ke(AST_ObjectKeyVal,n,{key:i,value:n.right}));return!0}(n[0]))break}while(n.shift(),t=!0,n.length);return t}}}function C(i,r,o){var a,s=!1;function f(e){a?(a.push(e),ae(e)||(a.required=!0)):o.push(e)}r.walk(new TreeWalker(function(e,n){var t;return e instanceof AST_DefClass?(e.extends=null,e.properties=[],f(e),!0):e instanceof AST_Definitions?(e.remove_initializers(i,t=[])&&AST_Node.warn("Dropping initialization in unreachable code [{start}]",e),0<t.length&&(e.definitions=t,f(e)),!0):e instanceof AST_LambdaDefinition?(f(e),!0):e instanceof AST_Scope||(e instanceof AST_BlockScope?(t=a,a=[],n(),a.required?o.push(ke(AST_BlockStatement,r,{body:a})):a.length&&[].push.apply(o,a),a=t,!0):void(e instanceof AST_LoopControl||(s=!0)))})),s&&AST_Node.warn("Dropping unreachable code [{start}]",r)}function Ce(e,n){return null==e||e.is_undefined||e instanceof AST_Undefined||e instanceof AST_UnaryPrefix&&"void"==e.operator&&(!n||!e.expression.has_side_effects(n))}function ve(e,n,t){switch(e){case"-":return n.is_negative_zero()&&(!(t instanceof AST_Constant)||0==t.value);case"&&":case"||":return n.is_negative_zero()||t.is_negative_zero();case"*":case"/":case"%":case"**":return!0;default:return!1}}function je(e,n){return n||/strict/.test(e.option("pure_getters"))}function Le(e,n,t){switch(n){case"&&":return t.left.is_defined(e)&&t.right.is_defined(e);case"||":return t.left.is_truthy()||t.right.is_defined(e);case"??":return t.left.is_defined(e)||t.right.is_defined(e);default:return!0}}AST_SymbolRef.DEFMETHOD("is_declared",function(e){return this.defined||!this.definition().undeclared||e.option("unsafe")&&qe[this.name]}),(n=function(e,n){e.DEFMETHOD("in_strict_mode",n)})(AST_Class,return_true),n(AST_Scope,function(e){for(var n=this.body,t=0;t<n.length;t++){var i=n[t];if(!(i instanceof AST_Directive))break;if("use strict"==i.value)return!0}var r=this.parent_scope;return r?r.resolve(!0).in_strict_mode(e):e.option("module")}),(n=function(e,n){e.DEFMETHOD("is_truthy",n)})(AST_Node,return_false),n(AST_Array,return_true),n(AST_Assign,function(){return"="==this.operator&&this.right.is_truthy()}),n(AST_Lambda,return_true),n(AST_Object,return_true),n(AST_RegExp,return_true),n(AST_Sequence,function(){return this.tail_node().is_truthy()}),n(AST_SymbolRef,function(){var e=this.fixed_value();if(!e)return!1;this.is_truthy=return_false;e=e.is_truthy();return delete this.is_truthy,e}),(n=function(e,n){e.DEFMETHOD("is_negative_zero",n)})(AST_Node,return_true),n(AST_Array,return_false),n(AST_Assign,function(){var e=this.operator;return"="==e?this.right.is_negative_zero():ve(e.slice(0,-1),this.left,this.right)}),n(AST_Binary,function(){return ve(this.operator,this.left,this.right)}),n(AST_Constant,function(){return 0==this.value&&1/this.value<0}),n(AST_Lambda,return_false),n(AST_Object,return_false),n(AST_RegExp,return_false),n(AST_Sequence,function(){return this.tail_node().is_negative_zero()}),n(AST_SymbolRef,function(){var e=this.fixed_value();if(!e)return!0;this.is_negative_zero=return_true;e=e.is_negative_zero();return delete this.is_negative_zero,e}),n(AST_UnaryPrefix,function(){return"+"==this.operator&&this.expression.is_negative_zero()||"-"==this.operator}),n=function(e,n){e.DEFMETHOD("_dot_throw",n)},AST_Node.DEFMETHOD("may_throw_on_access",function(e,n){return!e.option("pure_getters")||this._dot_throw(e,n)}),n(AST_Node,je),n(AST_Array,return_false),n(AST_Assign,function(e){var n=this.operator,t=this.left,i=this.right;return"="!=n?Ne[n.slice(0,-1)]&&(t._dot_throw(e)||i._dot_throw(e)):!!i._dot_throw(e)&&(!(t instanceof AST_SymbolRef&&i instanceof AST_Binary&&"||"==i.operator&&t.name==i.left.name)||i.right._dot_throw(e))}),n(AST_Binary,function(e){return Ne[this.operator]&&(this.left._dot_throw(e)||this.right._dot_throw(e))}),n(AST_Class,function(e,n){return je(e,n)&&!all(this.properties,function(e){return!!e.private||!e.static||!(e instanceof AST_ClassGetter||e instanceof AST_ClassSetter)})}),n(AST_Conditional,function(e){return this.consequent._dot_throw(e)||this.alternative._dot_throw(e)}),n(AST_Constant,return_false),n(AST_Dot,function(e,n){return!(!je(e,n)||((e=this.expression)instanceof AST_SymbolRef&&(e=e.fixed_value()),"prototype"==this.property&&w(e)))}),n(AST_Lambda,return_false),n(AST_Null,return_true),n(AST_Object,function(n,t){return je(n,t)&&!all(this.properties,function(e){return!(e instanceof AST_ObjectGetter||e instanceof AST_ObjectSetter||"__proto__"===e.key&&e.value._dot_throw(n,t))})}),n(AST_ObjectIdentity,function(e,n){return je(e,n)&&!this.scope.resolve().new}),n(AST_Sequence,function(e){return this.tail_node()._dot_throw(e)}),n(AST_SymbolRef,function(e,n){if(!this.defined){if(this.is_undefined)return!0;if(je(e,n)&&!(Ee(this)&&this.is_declared(e)||this.is_immutable())){n=this.definition();if(ge(n)&&!n.scope.rest&&all(n.scope.argnames,function(e){return e instanceof AST_SymbolFunarg}))return 2<n.scope.uses_arguments;n=this.fixed_value(!0);if(!n)return!0;if(this._dot_throw=return_true,n._dot_throw(e))return delete this._dot_throw,!0;this._dot_throw=return_false}}return!1}),n(AST_UnaryPrefix,function(){return"void"==this.operator}),n(AST_UnaryPostfix,return_false),n(AST_Undefined,return_true),(n=function(e,n){e.DEFMETHOD("is_defined",n)})(AST_Node,return_false),n(AST_Array,return_true),n(AST_Assign,function(e){var n=this.operator;return"="==n?this.right.is_defined(e):Le(e,n.slice(0,-1),this)}),n(AST_Binary,function(e){return Le(e,this.operator,this)}),n(AST_Conditional,function(e){return this.consequent.is_defined(e)&&this.alternative.is_defined(e)}),n(AST_Constant,return_true),n(AST_Hole,return_false),n(AST_Lambda,return_true),n(AST_Object,return_true),n(AST_Sequence,function(e){return this.tail_node().is_defined(e)}),n(AST_SymbolRef,function(e){if(this.is_undefined)return!1;if(Ee(this)&&this.is_declared(e))return!0;if(this.is_immutable())return!0;var n=this.fixed_value();if(!n)return!1;this.is_defined=return_false;n=n.is_defined(e);return delete this.is_defined,n}),n(AST_UnaryPrefix,function(){return"void"!=this.operator}),n(AST_UnaryPostfix,return_true),n(AST_Undefined,return_false),(n=function(e,n){e.DEFMETHOD("is_boolean",n)})(AST_Node,return_false),n(AST_Assign,function(e){return"="==this.operator&&this.right.is_boolean(e)}),ue=makePredicate("in instanceof == != === !== < <= >= >"),n(AST_Binary,function(e){return ue[this.operator]||Ne[this.operator]&&this.left.is_boolean(e)&&this.right.is_boolean(e)}),n(AST_Boolean,return_true),_e=makePredicate("every hasOwnProperty isPrototypeOf propertyIsEnumerable some"),n(AST_Call,function(e){return!!e.option("unsafe")&&(e=this.expression)instanceof AST_Dot&&(_e[e.property]||"test"==e.property&&e.expression instanceof AST_RegExp)}),n(AST_Conditional,function(e){return this.consequent.is_boolean(e)&&this.alternative.is_boolean(e)}),n(AST_New,return_false),n(AST_Sequence,function(e){return this.tail_node().is_boolean(e)}),n(AST_SymbolRef,function(e){var n=this.fixed_value();if(!n)return!1;this.is_boolean=return_false;n=n.is_boolean(e);return delete this.is_boolean,n}),Se=makePredicate("! delete"),n(AST_UnaryPrefix,function(){return Se[this.operator]}),(n=function(e,n){e.DEFMETHOD("is_number",n)})(AST_Node,return_false),pe=makePredicate("- * / % ** & | ^ << >> >>>"),n(AST_Assign,function(e){return pe[this.operator.slice(0,-1)]||"="==this.operator&&this.right.is_number(e)}),n(AST_Binary,function(e){return!!pe[this.operator]||"+"==this.operator&&(this.left.is_boolean(e)||this.left.is_number(e))&&(this.right.is_boolean(e)||this.right.is_number(e))}),de=makePredicate(["charCodeAt","getDate","getDay","getFullYear","getHours","getMilliseconds","getMinutes","getMonth","getSeconds","getTime","getTimezoneOffset","getUTCDate","getUTCDay","getUTCFullYear","getUTCHours","getUTCMilliseconds","getUTCMinutes","getUTCMonth","getUTCSeconds","getYear","indexOf","lastIndexOf","localeCompare","push","search","setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear"]),n(AST_Call,function(e){return!!e.option("unsafe")&&(e=this.expression)instanceof AST_Dot&&(de[e.property]||Ee(e.expression)&&"Math"==e.expression.name)}),n(AST_Conditional,function(e){return this.consequent.is_number(e)&&this.alternative.is_number(e)}),n(AST_New,return_false),n(AST_Number,return_true),n(AST_Sequence,function(e){return this.tail_node().is_number(e)}),n(AST_SymbolRef,function(e,n){var t=this.fixed_value();if(!t)return!1;if(n&&t instanceof AST_UnaryPrefix&&"+"==t.operator&&t.expression.equals(this))return!1;this.is_number=return_false;n=t.is_number(e);return delete this.is_number,n}),Ae=makePredicate("+ - ~ ++ --"),n(AST_Unary,function(){return Ae[this.operator]}),(n=function(e,n){e.DEFMETHOD("is_string",n)})(AST_Node,return_false),n(AST_Assign,function(e){switch(this.operator){case"+=":if(this.left.is_string(e))return!0;case"=":return this.right.is_string(e)}}),n(AST_Binary,function(e){return"+"==this.operator&&(this.left.is_string(e)||this.right.is_string(e))}),Te=makePredicate(["charAt","substr","substring","toExponential","toFixed","toLowerCase","toPrecision","toString","toUpperCase","trim"]),n(AST_Call,function(e){return!!e.option("unsafe")&&(e=this.expression)instanceof AST_Dot&&Te[e.property]}),n(AST_Conditional,function(e){return this.consequent.is_string(e)&&this.alternative.is_string(e)}),n(AST_Sequence,function(e){return this.tail_node().is_string(e)}),n(AST_String,return_true),n(AST_SymbolRef,function(e){var n=this.fixed_value();if(!n)return!1;this.is_string=return_false;n=n.is_string(e);return delete this.is_string,n}),n(AST_Template,function(e){return!this.tag||et(e,this.tag)}),n(AST_UnaryPrefix,function(){return"typeof"==this.operator});var Ne=makePredicate("&& || ??");function Ve(e){AST_Node.warn("global_defs {this} redefined [{start}]",e)}function Y(e,n,t){return n.print_to_string().length-e.print_to_string().length<(t||0)?n:e}function Ie(e,n,t){return Y(ke(AST_SimpleStatement,e,{body:e}),ke(AST_SimpleStatement,n,{body:n}),t).body}function Me(e,n,t,i){return(first_in_statement(e)?Ie:Y)(n,t,i)}function He(n){var t=Object.create(null);return Object.keys(n).forEach(function(e){t[e]=makePredicate(n[e])}),t}function We(e){for(var n=0;n<e.length;n++){var t=e[n];if(!(t instanceof AST_Directive))return t}}function Ye(){return this.value?ke(AST_Return,this.value,{value:this.value}):We(this.body)}function K(e,n){var t=n.evaluate(e);return t===n?n:Me(e,n,Z(t,n).optimize(e),e.eval_threshold)}n=function(e,n){e.DEFMETHOD("_find_defs",n)},AST_Toplevel.DEFMETHOD("resolve_defines",function(o){return o.option("global_defs")?(this.figure_out_scope({ie:o.option("ie")}),this.transform(new TreeTransformer(function(e){var n=e._find_defs(o,"");if(n){for(var t,i=0,r=e;(t=this.parent(i++))&&t instanceof AST_PropAccess&&t.expression===r;)r=t;if(!is_lhs(r,t))return n;Ve(e)}}))):this}),n(AST_Node,noop),n(AST_Dot,function(e,n){return this.expression._find_defs(e,"."+this.property+n)}),n(AST_SymbolDeclaration,function(e){this.definition().global&&HOP(e.option("global_defs"),this.name)&&Ve(this)}),n(AST_SymbolRef,function(e,n){if(this.definition().global)return e=e.option("global_defs"),n=this.name+n,HOP(e,n)?function n(e,t){if(e instanceof AST_Node)return e.clone(!0);if(Array.isArray(e))return ke(AST_Array,t,{elements:e.map(function(e){return n(e,t)})});if(e&&"object"==typeof e){var i,r=[];for(i in e)HOP(e,i)&&r.push(ke(AST_ObjectKeyVal,t,{key:i,value:n(e[i],t)}));return ke(AST_Object,t,{properties:r})}return Z(e,t)}(e[n],this):void 0}),AST_Arrow.DEFMETHOD("first_statement",Ye),AST_AsyncArrow.DEFMETHOD("first_statement",Ye),AST_Lambda.DEFMETHOD("first_statement",function(){return We(this.body)}),AST_Lambda.DEFMETHOD("length",function(){for(var e=this.argnames,n=0;n<e.length&&!(e[n]instanceof AST_DefaultValue);n++);return n});var Ke,Ge,$e,Xe,Je,Qe,Ze,n=["constructor","toString","valueOf"],T=He({Array:["indexOf","join","lastIndexOf","slice"].concat(n),Boolean:n,Function:n,Number:["toExponential","toFixed","toPrecision"].concat(n),Object:n,RegExp:["exec","test"].concat(n),String:["charAt","charCodeAt","concat","indexOf","italics","lastIndexOf","match","replace","search","slice","split","substr","substring","toLowerCase","toUpperCase","trim"].concat(n)}),en=He({Array:["isArray"],Math:["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","atan2","pow","max","min"],Number:["isFinite","isNaN"],Object:["create","getOwnPropertyDescriptor","getOwnPropertyNames","getPrototypeOf","isExtensible","isFrozen","isSealed","keys"],String:["fromCharCode","raw"]});function nn(e){if(e instanceof AST_Dot){var n,t=e.expression;if(Ee(t))return(n=en[t.name])&&(n[e.property]||"Math"==t.name&&"random"==e.property)}}function f(e){e instanceof AST_DestructuredArray?e.elements.forEach(f):e instanceof AST_DestructuredObject?e.properties.forEach(function(e){f(e.value)}):e instanceof AST_PropAccess?f(e.expression):e instanceof AST_SymbolRef&&e.definition().references.forEach(function(e){delete e._eval})}function tn(e,n,t,i,r){for(var o=[],a=0;a<e.length;a++){var s=e[a],f=s._eval(n,t,i,r);if(s===f)return;o.push(f)}return o}function rn(e){return ke(AST_UnaryPrefix,e,{operator:"!",expression:e})}function on(e,n,t){e=rn(e);return t?Y(e,ke(AST_SimpleStatement,n,{body:n}))===e?e:n:Y(e,n)}(n=function(e,n){e.DEFMETHOD("is_constant",n)})(AST_Node,return_false),n(AST_Constant,return_true),n(AST_RegExp,return_false),Ke=makePredicate("! ~ - + void"),n(AST_UnaryPrefix,function(){return Ke[this.operator]&&this.expression instanceof AST_Constant}),n=function(e,n){e.DEFMETHOD("_eval",n)},AST_Node.DEFMETHOD("evaluate",function(e,n){var t;return!e.option("evaluate")||(t=this._eval(e,n,e=[],1),e.forEach(function(e){delete e._eval}),!n&&t&&!(t instanceof RegExp)&&("function"==typeof t||"object"==typeof t))?this:t}),Ge=new TreeWalker(function(e){e instanceof AST_Assign&&f(e.left),e instanceof AST_ForEnumeration&&f(e.init),e instanceof AST_Unary&&UNARY_POSTFIX[e.operator]&&f(e.expression)}),n(AST_Statement,function(){throw new Error(string_template("Cannot evaluate a statement [{start}]",this))}),n(AST_Accessor,return_this),n(AST_BigInt,return_this),n(AST_Class,return_this),n(AST_Node,return_this),n(AST_Constant,function(){return this.value}),n(AST_Assign,function(e,n,t,i){var r=this.left;if(!n){if(!(r instanceof AST_SymbolRef))return this;if(!HOP(r,"_eval")){if(!r.fixed)return this;var o=r.definition();if(!o.fixed)return this;if(o.undeclared)return this;if(o.last_ref!==r)return this;if("m"==o.single_use)return this;if(this.right.has_side_effects(e))return this}}o=this.operator,o=!HOP(r,"_eval")&&r instanceof AST_SymbolRef&&r.fixed&&r.definition().fixed?r:"="==o?this.right:ke(AST_Binary,this,{operator:o.slice(0,-1),left:r,right:this.right}),r.walk(Ge),o=o._eval(e,n,t,i);return"object"==typeof o?this:(f(r),o)}),n(AST_Sequence,function(e,n,t,i){if(!n)return this;for(var r=this.expressions,o=0,a=r.length-1;o<a;o++)r[o].walk(Ge);var s=r[a],e=s._eval(e,n,t,i);return e===s?this:e}),n(AST_Lambda,function(e){return e.option("unsafe")?((e=function(){}).node=this,e.toString=function(){return"function(){}"},e):this}),n(AST_Array,function(e,n,t,i){if(e.option("unsafe")){for(var r=[],o=0;o<this.elements.length;o++){var a=this.elements[o];if(a instanceof AST_Hole)return this;var s=a._eval(e,n,t,i);if(a===s)return this;r.push(s)}return r}return this}),n(AST_Object,function(e,n,t,i){if(e.option("unsafe")){for(var r={},o=0;o<this.properties.length;o++){var a=this.properties[o];if(!(a instanceof AST_ObjectKeyVal))return this;var s=a.key;if(s instanceof AST_Node&&(s=s._eval(e,n,t,i))===a.key)return this;switch(s){case"__proto__":case"toString":case"valueOf":return this}if(r[s]=a.value._eval(e,n,t,i),r[s]===a.value)return this}return r}return this}),$e=makePredicate("! typeof void"),n(AST_UnaryPrefix,function(e,n,t,i){var r=this.expression,o=this.operator;if(e.option("typeofs")&&"typeof"==o&&(r instanceof AST_Lambda||r instanceof AST_SymbolRef&&r.fixed_value()instanceof AST_Lambda))return"function";var a=r instanceof AST_SymbolRef&&r.definition(),s=($e[o]||a&&a.fixed||i++,r.walk(Ge),r._eval(e,n,t,i));if(s===r)return n&&"void"==o?void 0:this;switch(o){case"!":return!s;case"typeof":return s instanceof RegExp?this:typeof s;case"void":return;case"~":return~s;case"-":return-s;case"+":return+s;case"++":case"--":if(!a)return this;if(!n){if(a.undeclared)return this;if(a.last_ref!==r)return this}return HOP(r,"_eval")&&(s=+(o[0]+1)+ +s),f(r),s}return this}),n(AST_UnaryPostfix,function(e,n,t,i){var r=this.expression;if(r instanceof AST_SymbolRef){if(!HOP(r,"_eval")){if(!r.fixed)return this;if(!n){var o=r.definition();if(!o.fixed)return this;if(o.undeclared)return this;if(o.last_ref!==r)return this}}}else if(!n)return this;r instanceof AST_SymbolRef&&r.definition().fixed||i++,r.walk(Ge);o=r._eval(e,n,t,i);return o===r?this:(f(r),+o)}),Xe=makePredicate("&& || === !=="),n(AST_Binary,function(e,n,t,i){Xe[this.operator]||i++;var r=this.left._eval(e,n,t,i);if(r===this.left)return this;if(this.operator==(r?"||":"&&"))return r;var o,a=this.right._eval(e,n&&!(r&&"object"==typeof r),t,i);if(a===this.right)return this;switch(this.operator){case"&&":o=r&&a;break;case"||":o=r||a;break;case"??":o=null==r?a:r;break;case"|":o=r|a;break;case"&":o=r&a;break;case"^":o=r^a;break;case"+":o=r+a;break;case"-":o=r-a;break;case"*":o=r*a;break;case"/":o=r/a;break;case"%":o=r%a;break;case"<<":o=r<<a;break;case">>":o=r>>a;break;case">>>":o=r>>>a;break;case"==":o=r==a;break;case"===":o=r===a;break;case"!=":o=r!=a;break;case"!==":o=r!==a;break;case"<":o=r<a;break;case"<=":o=r<=a;break;case">":o=a<r;break;case">=":o=a<=r;break;case"**":o=Math.pow(r,a);break;case"in":if(a&&"object"==typeof a&&HOP(a,r)){o=!0;break}default:return this}if(isNaN(o))return e.find_parent(AST_With)?this:o;if(e.option("unsafe_math")&&!n&&o&&"number"==typeof o&&("+"==this.operator||"-"==this.operator)){t=Math.max(0,s(r),s(a));if(t<16)return+o.toFixed(t)}return o;function s(e){e=/(\.[0-9]*)?(e[^e]+)?$/.exec(+e);return(e[1]||".").length-1-(e[2]||"").slice(1)}}),n(AST_Conditional,function(e,n,t,i){var r=this.condition._eval(e,n,t,i);return r===this.condition||(e=(r=r?this.consequent:this.alternative)._eval(e,n,t,i))===r?this:e}),n(AST_SymbolRef,function(e,n,t,i){this._eval=return_this;try{var r,o=this.fixed_value();if(!o)return this;if(HOP(o,"_eval"))r=o._eval();else{if((r=o._eval(e,n,t,i))===o)return this;o._eval=function(){return r},t.push(o)}return r&&"object"==typeof r&&!function(n,e){var t=n.definition().escaped;switch(t.length){case 0:return 1;case 1:var i=!1;return t[0].walk(new TreeWalker(function(e){return!!i||(e===n?i=!0:e instanceof AST_Scope||void 0)})),i;default:return e<=t.depth}}(this,i)?this:r}finally{delete this._eval}}),Je={Array:Array,Math:Math,Number:Number,Object:Object,String:String},Qe=He({Math:["E","LN10","LN2","LOG2E","LOG10E","PI","SQRT1_2","SQRT2"],Number:["MAX_VALUE","MIN_VALUE","NaN","NEGATIVE_INFINITY","POSITIVE_INFINITY"]}),Ze=makePredicate("global ignoreCase multiline source"),n(AST_PropAccess,function(e,n,t,i){if(e.option("unsafe")){var r,o=this.expression;if(!Ee(o)&&(null==(r=o._eval(e,n,t,i+1))||r===o))return this;var a=this.property;if(a instanceof AST_Node&&(a=a._eval(e,n,t,i))===this.property)return this;if(void 0===r){e=Qe[o.name];if(!e||!e[a])return this;r=Je[o.name]}else if(r instanceof RegExp){if(!Ze[a])return this}else if("object"==typeof r){if(!HOP(r,a))return this}else if("function"==typeof r)switch(a){case"name":return r.node.name?r.node.name.name:"";case"length":return r.node.length();default:return this}return r[a]}return this}),n(AST_Call,function(i,r,o,a){var e=this.expression,n=e instanceof AST_SymbolRef?e.fixed_value():e;if(n instanceof AST_Arrow||n instanceof AST_Defun||n instanceof AST_Function){if(!n.evaluating&&!(n.name&&0<n.name.definition().recursive_refs||this.is_expr_pure(i))){var s=tn(this.args,i,r,o,a);if(all(n.argnames,function(e,n){if(e instanceof AST_DefaultValue){if(!s)return!1;if(void 0===s[n]){var t=e.value._eval(i,r,o,a);if(t===e.value)return!1;s[n]=t}e=e.name}return!(e instanceof AST_Destructured)})&&!(n.rest instanceof AST_Destructured)&&(s||r)){var f,t=n.first_statement();if(t instanceof AST_Return)return(l=t.value)?(f=[],s&&(!all(n.argnames,function(e,n){return _(e,s[n])})||n.rest&&!_(n.rest,s.slice(n.argnames.length)))&&!r||(r&&n.argnames.forEach(function(e){e instanceof AST_DefaultValue&&e.value.walk(Ge)}),n.evaluating=!0,l=l._eval(i,r,o,a),n.evaluating=!1),f.forEach(function(e){delete e._eval}),l===t.value?this:l):void 0;if(r){n.walk(Ge);var c=!1;if(n.evaluating=!0,walk_body(n,new TreeWalker(function(e){return!!c||(e instanceof AST_Return?(e.value&&void 0!==e.value._eval(i,!0,o,a)&&(c=!0),!0):e instanceof AST_Scope&&e!==n||void 0)})),n.evaluating=!1,!c)return}}}}else if(i.option("unsafe")&&e instanceof AST_PropAccess){var l,t=e.property;if(t instanceof AST_Node&&(t=t._eval(i,r,o,a))===e.property)return this;e=e.expression;if(Ee(e)){var u=en[e.name];if(!u||!u[t])return this;l=Je[e.name]}else{if(null==(l=e._eval(i,r,o,a+1))||l===e)return this;u=T[l.constructor.name];if(!u||!u[t])return this;if(l instanceof RegExp&&l.global&&!(e instanceof AST_RegExp))return this}if(!(s=tn(this.args,i,r,o,a)))return this;if("replace"==t&&"function"==typeof s[1])return this;try{return l[t].apply(l,s)}catch(e){AST_Node.warn("Error evaluating {this} [{start}]",this)}finally{l instanceof RegExp&&(l.lastIndex=0)}}return this;function _(e,n){var t,i=(e=e instanceof AST_DefaultValue?e.name:e).definition();return i.orig[i.orig.length-1]===e&&(t=n,i.references.forEach(function(e){e._eval=function(){return t},f.push(e)}),!0)}}),n(AST_New,return_this),n(AST_Template,function(e,n,t,i){if(e.option("templates")){if(this.tag){if(!et(e,this.tag))return this;f=function(e){return e}}var r=tn(this.expressions,e,n,t,i);if(r){for(var o=!1,a=f(this.strings[0]),s=0;s<r.length;s++)a+=r[s]+f(this.strings[s+1]);if(!o)return a;this._eval=return_this}}return this;function f(e){return"string"!=typeof(e=nt(e))&&(o=!0),e}}),(n=function(e,t){e.DEFMETHOD("negate",function(e,n){return t.call(this,e,n)})})(AST_Node,function(){return rn(this)}),n(AST_Statement,function(){throw new Error("Cannot negate a statement")}),n(AST_Binary,function(e,n){var t=this.clone(),i=this.operator;if(e.option("unsafe_comps"))switch(i){case"<=":return t.operator=">",t;case"<":return t.operator=">=",t;case">=":return t.operator="<",t;case">":return t.operator="<=",t}switch(i){case"==":return t.operator="!=",t;case"!=":return t.operator="==",t;case"===":return t.operator="!==",t;case"!==":return t.operator="===",t;case"&&":return t.operator="||",t.left=t.left.negate(e,n),t.right=t.right.negate(e),on(this,t,n);case"||":return t.operator="&&",t.left=t.left.negate(e,n),t.right=t.right.negate(e),on(this,t,n)}return rn(this)}),n(AST_ClassExpression,function(){return rn(this)}),n(AST_Conditional,function(e,n){var t=this.clone();return t.consequent=t.consequent.negate(e),t.alternative=t.alternative.negate(e),on(this,t,n)}),n(AST_LambdaExpression,function(){return rn(this)}),n(AST_Sequence,function(e){var n=this.expressions.slice();return n.push(n.pop().negate(e)),we(this,n)}),n(AST_UnaryPrefix,function(){return"!"==this.operator?this.expression:rn(this)});var an=makePredicate("Boolean decodeURI decodeURIComponent Date encodeURI encodeURIComponent Error escape EvalError isFinite isNaN Number Object parseFloat parseInt RangeError ReferenceError String SyntaxError TypeError unescape URIError"),sn=makePredicate("Map Set WeakMap WeakSet");function t(e,n,t){return!all(e,t?function(e){return e instanceof AST_Spread?!t(e,n):!e.has_side_effects(n)}:function(e){return!e.has_side_effects(n)})}function fn(e,n){e=e.expression;return!e.is_string(n)||e.has_side_effects(n)}function i(e,n){for(var t=e.length;0<=--t;)if(e[t].may_throw(n))return!0;return!1}function cn(e,n){return!!e.may_throw(n)||!((e=e instanceof AST_SymbolRef?e.fixed_value():e)instanceof AST_Lambda&&!i(e.argnames,n)&&!i(e.body,n))||is_arrow(e)&&e.value&&e.value.may_throw(n)}function ln(e,n){for(var t=e.length;0<=--t;)if(!e[t].is_constant_expression(n))return!1;return!0}function un(i,r){var o=!0,a=[];return i.walk(new TreeWalker(function(e,n){if(!o)return!0;if(e instanceof AST_BlockScope)return e===i?void 0:(a.push(e),n(),a.pop(),!0);if(e instanceof AST_SymbolRef){if(i.inlined||e.redef||e.in_arg)return!(o=!1);if(!i.variables||!i.variables.has(e.name)){n=e.definition();if(!member(n.scope,a)){if(r&&!n.redefined()){var t=r.find_variable(e.name);if(t?t===n:n.undeclared)return o="f",!0}o=!1}}return!0}return e instanceof AST_ObjectIdentity?(is_arrow(i)&&all(a,function(e){return!(e instanceof AST_Scope)||is_arrow(e)})&&(o=!1),!0):void 0})),o}function q(e){return e&&e.aborts()}function _n(){var e=this.body.length;return 0<e&&q(this.body[e-1])}AST_Call.DEFMETHOD("is_expr_pure",function(e){if(e.option("unsafe")){var n=this.expression;if(Ee(n)){if(an[n.name])return!0;if(this instanceof AST_New&&sn[n.name])return!0}if(nn(n))return!0}return e.option("annotations")&&this.pure||!e.pure_funcs(this)}),AST_Template.DEFMETHOD("is_expr_pure",function(e){var n,t=this.tag;if(!t)return!0;if(e.option("unsafe")){if(Ee(t)&&an[t.name])return!0;if(t instanceof AST_Dot&&Ee(t.expression))return(n=en[t.expression.name])&&(n[t.property]||"Math"==t.expression.name&&"random"==t.property)}return!e.pure_funcs(this)}),AST_Node.DEFMETHOD("is_call_pure",return_false),AST_Call.DEFMETHOD("is_call_pure",function(e){if(!e.option("unsafe"))return!1;var n=this.expression;if(!(n instanceof AST_Dot))return!1;var t,i=n.expression,r=n.property;if(i instanceof AST_Array)t=T.Array;else if(i.is_boolean(e))t=T.Boolean;else if(i.is_number(e))t=T.Number;else if(i instanceof AST_RegExp)t=T.RegExp;else if(i.is_string(e)){if(t=T.String,"replace"==r){i=this.args[1];if(i&&!i.is_string(e))return!1}}else n.may_throw_on_access(e)||(t=T.Object);return t&&t[r]}),(n=function(e,n){e.DEFMETHOD("safe_to_spread",n)})(AST_Node,return_false),n(AST_Array,return_true),n(AST_Assign,function(){switch(this.operator){case"=":return this.right.safe_to_spread();case"&&=":case"||=":case"??=":return this.left.safe_to_spread()&&this.right.safe_to_spread()}return!0}),n(AST_Binary,function(){return!Ne[this.operator]||this.left.safe_to_spread()&&this.right.safe_to_spread()}),n(AST_Constant,return_true),n(AST_Lambda,return_true),n(AST_Object,function(){return all(this.properties,function(e){return!(e instanceof AST_ObjectGetter||e instanceof AST_Spread)})}),n(AST_Sequence,function(){return this.tail_node().safe_to_spread()}),n(AST_SymbolRef,function(){var e=this.fixed_value();return e&&e.safe_to_spread()}),n(AST_Unary,return_true),(n=function(e,n){e.DEFMETHOD("has_side_effects",n)})(AST_Node,return_true),n(AST_Array,function(e){return t(this.elements,e,fn)}),n(AST_Assign,function(e){var n,t=this.left;return!(t instanceof AST_PropAccess)||!((n=t.expression)instanceof AST_ObjectIdentity)||!n.scope.resolve().new||t instanceof AST_Sub&&t.property.has_side_effects(e)||this.right.has_side_effects(e)}),n(AST_Binary,function(e){return this.left.has_side_effects(e)||this.right.has_side_effects(e)||!Gn(this,e)}),n(AST_Block,function(e){return t(this.body,e)}),n(AST_Call,function(e){return!(this.is_expr_pure(e)||this.is_call_pure(e)&&!this.expression.has_side_effects(e))||t(this.args,e,fn)}),n(AST_Case,function(e){return this.expression.has_side_effects(e)||t(this.body,e)}),n(AST_Class,function(e){var n=this.extends;return!(!n||Re(n=n instanceof AST_SymbolRef?n.fixed_value():n))||t(this.properties,e)}),n(AST_ClassProperty,function(e){return this.key instanceof AST_Node&&this.key.has_side_effects(e)||this.static&&this.value&&this.value.has_side_effects(e)}),n(AST_Conditional,function(e){return this.condition.has_side_effects(e)||this.consequent.has_side_effects(e)||this.alternative.has_side_effects(e)}),n(AST_Constant,return_false),n(AST_Definitions,function(e){return t(this.definitions,e)}),n(AST_DestructuredArray,function(e){return t(this.elements,e)}),n(AST_DestructuredKeyVal,function(e){return this.key instanceof AST_Node&&this.key.has_side_effects(e)||this.value.has_side_effects(e)}),n(AST_DestructuredObject,function(e){return t(this.properties,e)}),n(AST_Dot,function(e){return this.expression.may_throw_on_access(e)||this.expression.has_side_effects(e)}),n(AST_EmptyStatement,return_false),n(AST_If,function(e){return this.condition.has_side_effects(e)||this.body&&this.body.has_side_effects(e)||this.alternative&&this.alternative.has_side_effects(e)}),n(AST_LabeledStatement,function(e){return this.body.has_side_effects(e)}),n(AST_Lambda,return_false),n(AST_Object,function(e){return t(this.properties,e,function(e,n){e=e.expression;return!e.safe_to_spread()||e.has_side_effects(n)})}),n(AST_ObjectIdentity,return_false),n(AST_ObjectProperty,function(e){return this.key instanceof AST_Node&&this.key.has_side_effects(e)||this.value.has_side_effects(e)}),n(AST_Sequence,function(e){return t(this.expressions,e)}),n(AST_SimpleStatement,function(e){return this.body.has_side_effects(e)}),n(AST_Sub,function(e){return this.expression.may_throw_on_access(e)||this.expression.has_side_effects(e)||this.property.has_side_effects(e)}),n(AST_Switch,function(e){return this.expression.has_side_effects(e)||t(this.body,e)}),n(AST_SymbolDeclaration,return_false),n(AST_SymbolRef,function(e){return!this.is_declared(e)||!be(this,e)}),n(AST_Template,function(e){return!this.is_expr_pure(e)||t(this.expressions,e)}),n(AST_Try,function(e){return t(this.body,e)||this.bcatch&&this.bcatch.has_side_effects(e)||this.bfinally&&this.bfinally.has_side_effects(e)}),n(AST_Unary,function(e){return unary_side_effects[this.operator]||this.expression.has_side_effects(e)}),n(AST_VarDef,function(){return this.value}),(n=function(e,n){e.DEFMETHOD("may_throw",n)})(AST_Node,return_true),n(AST_Constant,return_false),n(AST_EmptyStatement,return_false),n(AST_Lambda,return_false),n(AST_ObjectIdentity,return_false),n(AST_SymbolDeclaration,return_false),n(AST_Array,function(e){return i(this.elements,e)}),n(AST_Assign,function(e){return!!this.right.may_throw(e)||!(!e.has_directive("use strict")&&"="==this.operator&&this.left instanceof AST_SymbolRef)&&this.left.may_throw(e)}),n(AST_Await,function(e){return this.expression.may_throw(e)}),n(AST_Binary,function(e){return this.left.may_throw(e)||this.right.may_throw(e)||!Gn(this,e)}),n(AST_Block,function(e){return i(this.body,e)}),n(AST_Call,function(e){if(i(this.args,e))return!0;if(this.is_expr_pure(e))return!1;this.may_throw=return_true;e=cn(this.expression,e);return delete this.may_throw,e}),n(AST_Case,function(e){return this.expression.may_throw(e)||i(this.body,e)}),n(AST_Conditional,function(e){return this.condition.may_throw(e)||this.consequent.may_throw(e)||this.alternative.may_throw(e)}),n(AST_DefaultValue,function(e){return this.name.may_throw(e)||this.value&&this.value.may_throw(e)}),n(AST_Definitions,function(e){return i(this.definitions,e)}),n(AST_Dot,function(e){return!this.optional&&this.expression.may_throw_on_access(e)||this.expression.may_throw(e)}),n(AST_ForEnumeration,function(e){var n;return!!this.init.may_throw(e)||!!(n=this.object).may_throw(e)||!((n=n.tail_node())instanceof AST_Array||n.is_string(e))||this.body.may_throw(e)}),n(AST_If,function(e){return this.condition.may_throw(e)||this.body&&this.body.may_throw(e)||this.alternative&&this.alternative.may_throw(e)}),n(AST_LabeledStatement,function(e){return this.body.may_throw(e)}),n(AST_Object,function(e){return i(this.properties,e)}),n(AST_ObjectProperty,function(e){return this.value.may_throw(e)||this.key instanceof AST_Node&&this.key.may_throw(e)}),n(AST_Return,function(e){return this.value&&this.value.may_throw(e)}),n(AST_Sequence,function(e){return i(this.expressions,e)}),n(AST_SimpleStatement,function(e){return this.body.may_throw(e)}),n(AST_Sub,function(e){return!this.optional&&this.expression.may_throw_on_access(e)||this.expression.may_throw(e)||this.property.may_throw(e)}),n(AST_Switch,function(e){return this.expression.may_throw(e)||i(this.body,e)}),n(AST_SymbolRef,function(e){return!this.is_declared(e)||!be(this,e)}),n(AST_Template,function(e){if(i(this.expressions,e))return!0;if(this.is_expr_pure(e))return!1;if(!this.tag)return!1;this.may_throw=return_true;e=cn(this.tag,e);return delete this.may_throw,e}),n(AST_Try,function(e){return(this.bcatch?this.bcatch.may_throw(e):i(this.body,e))||this.bfinally&&this.bfinally.may_throw(e)}),n(AST_Unary,function(e){return this.expression.may_throw(e)&&!("typeof"==this.operator&&this.expression instanceof AST_SymbolRef)}),n(AST_VarDef,function(e){return this.name.may_throw(e)||this.value&&this.value.may_throw(e)}),(n=function(e,n){e.DEFMETHOD("is_constant_expression",n)})(AST_Node,return_false),n(AST_Array,function(e){return ln(this.elements,e)}),n(AST_Binary,function(e){return this.left.is_constant_expression(e)&&this.right.is_constant_expression(e)&&Gn(this)}),n(AST_Class,function(e){var n=this.extends;return!(n&&!Re(n))&&ln(this.properties,e)}),n(AST_ClassProperty,function(e){var n;return"string"==typeof this.key&&(!(n=this.value)||(this.static?n.is_constant_expression(e):un(n,e)))}),n(AST_Constant,return_true),n(AST_Lambda,function(e){return un(this,e)}),n(AST_Object,function(e){return ln(this.properties,e)}),n(AST_ObjectIdentity,function(e){return this.scope.resolve()===e}),n(AST_ObjectProperty,function(e){return"string"==typeof this.key&&this.value.is_constant_expression(e)}),n(AST_Unary,function(e){return this.expression.is_constant_expression(e)}),(n=function(e,n){e.DEFMETHOD("aborts",n)})(AST_Statement,return_null),n(AST_Jump,return_this),n(AST_BlockStatement,_n),n(AST_SwitchBranch,_n),n(AST_If,function(){return this.alternative&&q(this.body)&&q(this.alternative)&&this});var Sn=makePredicate(["use asm","use strict"]);function pn(e,n,t){switch(e.body.length){case 0:return t?List.skip:ke(AST_EmptyStatement,e);case 1:var i=e.body[0];return ae(i)?n instanceof AST_IterationStatement&&i instanceof AST_LambdaDefinition?e:i:e}return e}function dn(e,n){!n.option("rests")||e.uses_arguments||e.rest instanceof AST_DestructuredArray&&n.drop_fargs(e,n.parent())&&(e.argnames=e.argnames.concat(e.rest.elements),e.rest=e.rest.rest)}function An(e,n){if(n.option("arrows")){dn(e,n),e.value&&(e.body=[e.first_statement()]);var t=me(e.body,n);switch(t.length){case 1:var i=t[0];if(i instanceof AST_Return){e.body.length=0,e.value=i.value;break}default:e.body=t,e.value=null}}return e}e(AST_Directive,function(e,n){return!n.option("directives")||Sn[e.value]&&n.has_directive(e.value)===e?e:ke(AST_EmptyStatement,e)}),e(AST_Debugger,function(e,n){return n.option("drop_debugger")?ke(AST_EmptyStatement,e):e}),e(AST_LabeledStatement,function(e,n){if(e.body instanceof AST_If||e.body instanceof AST_Break){var t=me([e.body],n);switch(t.length){case 0:e.body=ke(AST_EmptyStatement,e);break;case 1:e.body=t[0];break;default:e.body=ke(AST_BlockStatement,e,{body:t})}}return n.option("unused")&&0==e.label.references.length?e.body:e}),e(AST_LoopControl,function(e,n){var t,i;return n.option("dead_code")&&(t=e.label)&&(i=n.loopcontrol_target(e),e.label=null,n.loopcontrol_target(e)===i?remove(t.thedef.references,e):e.label=t),e}),e(AST_Block,function(e,n){return e.body=me(e.body,n),e}),e(AST_BlockStatement,function(e,n){return e.body=me(e.body,n),pn(e,n.parent())}),e(AST_Lambda,function(e,n){return dn(e,n),e.body=me(e.body,n),e}),e(AST_Arrow,An),e(AST_AsyncArrow,An),e(AST_Function,function(n,e){dn(n,e),n.body=me(n.body,e);var t=e.parent();if(e.option("inline"))for(var i=0;i<n.body.length;i++){var r=n.body[i];if(!(r instanceof AST_Directive)){if(r instanceof AST_Return){if(i!=n.body.length-1)break;var o=r.value;if(!o||"Call"!=o.TYPE)break;if(o.is_expr_pure(e))break;var a,r=o.expression;if(r instanceof AST_SymbolRef){if(n.name&&n.name.definition()===r.definition())break;a=r.fixed_value()}else a=r;if(!(a instanceof AST_Defun||a instanceof AST_Function))break;if(a.rest)break;if(a.uses_arguments)break;if(a===r){if(a.parent_scope!==n)break;if(!all(a.enclosed,function(e){return e.scope!==n}))break}if((a!==r||a.name)&&(t instanceof AST_ClassMethod||t instanceof AST_ObjectMethod)&&t.value===e.self())break;if(a.contains_this())break;var s=a.argnames.length;if(0<s&&e.option("inline")<2)break;if(s>n.argnames.length)break;if(!all(n.argnames,function(e){return e instanceof AST_SymbolFunarg}))break;if(!all(o.args,function(e){return!(e instanceof AST_Spread)}))break;for(var f=0;f<s;f++){var c=o.args[f];if(!(c instanceof AST_SymbolRef))break;if(c.definition()!==n.argnames[f].definition())break}if(f<s)break;for(;f<o.args.length&&!o.args[f].has_side_effects(e);f++);if(f<o.args.length)break;if(s<n.argnames.length&&!e.drop_fargs(n,t)){if(!e.drop_fargs(a,o))break;for(;a.argnames.push(a.make_var(AST_SymbolFunarg,a,"argument_"+s)),++s<n.argnames.length;);}return r}break}}return n});var Tn=makePredicate("arguments await yield");function hn(e,n){for(var t=n.length;0<=--t;)n[t]||(n[t]=ke(AST_Hole,e))}function mn(e,n){e=ke(AST_ClassExpression,e);return e.name&&(e.name=n?null:ke(AST_SymbolClass,e.name)),e}function vn(e,n){var t;switch(e.CTOR){case AST_AsyncDefun:t=AST_AsyncFunction;break;case AST_AsyncGeneratorDefun:t=AST_AsyncGeneratorFunction;break;case AST_Defun:t=AST_Function;break;case AST_GeneratorDefun:t=AST_GeneratorFunction}var i=ke(t,e);return i.name=n?null:ke(AST_SymbolLambda,e.name),i}function yn(n,t){n.walk(new TreeWalker(function(e){return e instanceof AST_Return?(t(e),!0):e instanceof AST_Scope&&e!==n||void 0}))}function gn(e){var n=Object.create(null);return yn(e,function(e){var e=e.value;(e=e&&e.tail_node())instanceof AST_SymbolRef&&(e=e.definition().id,n[e]=(n[e]||0)+1)}),n}function bn(e,n,t){if(t.exposed(e))return!1;switch(e.references.length-e.replaced-(n[e.id]||0)){case e.drop_return:return"d";case e.bool_return:return!0}}function xn(e,i){yn(e,function(e){e.in_bool=!0;var n,t=e.value;t&&((n=N(i,t))?n instanceof AST_Node||(t=t.drop_side_effect_free(i),e.value=t?we(e.value,[t,ke(AST_Number,e.value,{value:1})]):ke(AST_Number,e.value,{value:1})):(t=t.drop_side_effect_free(i),e.value=t?we(e.value,[t,ke(AST_Number,e.value,{value:0})]):null))})}function kn(e,n){return!e.name||!n.option("ie")||(e=e.name.definition(),!n.exposed(e)&&all(e.references,function(e){return!(e instanceof AST_SymbolRef)}))}function wn(o,n,e){if(n instanceof AST_Lambda){var t,i=is_arrow(n),r=is_async(n),a=!1,s=!1;if(i&&o.option("arrows")?n.value?r&&!h(o,n.value)||(t=n.value.drop_side_effect_free(o))!==n.value&&(a=!0,n.value=t):s=!0:is_generator(n)||(s=!(!e&&n.name)||(t=n.name.definition()).references.length==t.replaced),s&&(n.process_expression(!1,function(e){var n=e.value;if(n){if(r&&!h(o,n))return e;n=n.drop_side_effect_free(o,!0)}return a=!0,n?ke(AST_SimpleStatement,e,{body:n}):ke(AST_EmptyStatement,e)}),yn(n,function(e){var n,t=e.value;!t||r&&!h(o,t)||(n=t.drop_side_effect_free(o))!==t&&(a=!0,n&&r&&!h(o,n)&&(n=n.negate(o)),e.value=n)})),r&&o.option("awaits")){s&&n.process_expression("awaits",function(e){var n=e.body;if(n instanceof AST_Await){if(h(o,n.expression)){if(a=!0,!(n=n.expression.drop_side_effect_free(o,!0)))return ke(AST_EmptyStatement,e);e.body=n}}else if(n instanceof AST_Sequence){for(var t=n.expressions,i=t.length;0<=--i;){var r=t[i];if(!(r instanceof AST_Await))break;r=r.expression;if(!h(o,r))break;if(a=!0,t[i]=r.drop_side_effect_free(o))break}switch(i){case-1:return ke(AST_EmptyStatement,e);case 0:e.body=t[0];break;default:t.length=i+1}}return e});var f,c=!s&&n.name||i&&n.value&&!h(o,n.value),l=new TreeWalker(function(e){return!!c||(l.parent()===n&&e.may_throw(o)||e instanceof AST_Await||e instanceof AST_ForAwaitOf?c=!0:e instanceof AST_Return?e.value&&!h(o,e.value)?c=!0:void 0:e instanceof AST_Scope&&e!==n||void 0)});if(n.walk(l),!c){switch(n.CTOR){case AST_AsyncArrow:f=AST_Arrow;break;case AST_AsyncFunction:f=AST_Function;break;case AST_AsyncGeneratorFunction:f=AST_GeneratorFunction}return ke(f,n)}}return a&&n.clone()}}function _(e,n,t,i){for(var r=e.length,o=[],a=!1,s=0;s<r;s++){var f=e[s],c=i&&f instanceof AST_Spread?i(f,n,t):f.drop_side_effect_free(n,t);c!==f&&(a=!0),c&&(o.push(c),t=!1)}return o.length?a?o:e:null}function Dn(e,n,t){var i=e.expression;return i.is_string(n)?i.drop_side_effect_free(n,t):e}function En(e){return e instanceof AST_Spread?ke(AST_Array,e,{elements:[e]}):e}function Cn(n,e,t){t=t||AST_LoopControl;var i=!1,r=new TreeWalker(function(e){return!!(i||e instanceof AST_Scope)||(e instanceof t&&r.loopcontrol_target(e)===n?i=!0:void 0)});return e instanceof AST_LabeledStatement&&r.push(e),r.push(n),n.body.walk(r),i}function z(e,n,t){if((e=e instanceof AST_Sequence?e.tail_node():e)instanceof AST_Binary)if(e.left instanceof AST_String){if(e.right instanceof AST_UnaryPrefix&&"typeof"==e.right.operator){var i=e.right.expression;if(Ee(i)){var r,o,a,s,f,c,l,u="undefined"==e.left.value;switch(e.operator){case"==":r=u?t:n;break;case"!=":r=u?n:t;break;default:return}r&&(o=!1,a=i.definition(),f=[],c=[],l=new TreeWalker(function(e,n){if(o)return!0;if(e instanceof AST_Assign){var t=e.left;if(!(t instanceof AST_SymbolRef&&t.definition()===a))return;switch(e.right.walk(l),e.operator){case"=":case"&&=":o=!0}return!0}var i;return e instanceof AST_Call?(n(),(s=e.expression.tail_node())instanceof AST_SymbolRef&&(s=s.fixed_value(),i=f.length),s instanceof AST_Lambda?push_uniq(c,s)&&s.walk(l):o=!0,0<=i&&(f.length=i),!0):e instanceof AST_DWLoop?(i=f.length,n(),o&&(f.length=i),!0):e instanceof AST_For?(e.init&&e.init.walk(l),i=f.length,e.condition&&e.condition.walk(l),e.body.walk(l),e.step&&e.step.walk(l),o&&(f.length=i),!0):e instanceof AST_ForEnumeration?(e.object.walk(l),i=f.length,e.init.walk(l),e.body.walk(l),o&&(f.length=i),!0):e instanceof AST_Scope?e!==s||void 0:e instanceof AST_SymbolRef?(e.definition()===a&&f.push(e),!0):void 0}),r.walk(l),f.forEach(function(e){e.defined=!0}))}}}else switch(e.operator){case"&&":z(e.left,n),z(e.right,n);break;case"||":z(_(e.left),t),z(_(e.right),t)}function _(e){if(e instanceof AST_Binary)switch(e.operator){case"==":return(e=e.clone()).operator="!=",e;case"!=":return(e=e.clone()).operator="==",e}}}function N(e,n,t){return!!n.truthy||(Ce(n)?void 0:!(n.falsy&&!t)&&(!!n.is_truthy()||n.evaluate(e,!0)))}function Nn(e,n){var t,i=0,r=!1,o=e.self();if(!is_statement(o))for(;;){if(t=o,(o=e.parent(i++))instanceof AST_Binary)switch(t){case o.left:if(Ne[o.operator])continue;break;case o.right:if(s(o.left))switch(o.operator){case"&&":n[r?"falsy":"truthy"]=!0;break;case"||":case"??":n[r?"truthy":"falsy"]=!0}}else if(o instanceof AST_Conditional){var a=o.condition;if(a===t)continue;if(s(a))switch(t){case o.consequent:n[r?"falsy":"truthy"]=!0;break;case o.alternative:n[r?"truthy":"falsy"]=!0}}else{if(o instanceof AST_Exit)break;if(o instanceof AST_If)break;if(o instanceof AST_Sequence){if(o.expressions[0]===t)continue}else if(o instanceof AST_SimpleStatement)break}return}for(;;){if(t=o,(o=e.parent(i++))instanceof AST_BlockStatement){if(o.body[0]===t)continue}else if(o instanceof AST_If&&s(o.condition))switch(t){case o.body:n[r?"falsy":"truthy"]=!0;break;case o.alternative:n[r?"truthy":"falsy"]=!0}return}function s(e){return n.equals(e)||e instanceof AST_UnaryPrefix&&"!"==e.operator&&n.equals(e.expression)&&(r=!0)}}function Rn(r){return function(n,t){var i=!1;return this.definitions.forEach(function(e){e.value&&(i=!0),e.name.match_symbol(function(e){e instanceof AST_SymbolDeclaration&&t.push(ke(AST_VarDef,e,{name:e,value:r(n,e)}))},!0)}),i}}function On(e){return"arguments"!=e.name&&e.orig.length<(e.orig[0]instanceof AST_SymbolLambda?3:2)}function Bn(e,n){if(e.exposed(n))return!0;for(var t=n.scope.resolve(),i=n.scope;i!==t;)if((i=i.parent_scope).var_names().has(n.name))return!0}function Pn(e,r){return ke(AST_Let,e,{definitions:e.definitions.map(function(e){return ke(AST_VarDef,e,{name:e.name.convert_symbol(AST_SymbolLet,function(e,n){var t=e.definition();t.orig[t.orig.indexOf(n)]=e;for(var i=r;i!==t.scope&&(i=i.parent_scope);)remove(i.enclosed,t);(t.scope=r).variables.set(t.name,t)}),value:e.value})})})}function Fn(e,i){return ke(AST_Var,e,{definitions:e.definitions.map(function(e){return ke(AST_VarDef,e,{name:e.name.convert_symbol(AST_SymbolVar,function(e,n){var t=e.definition();t.orig[t.orig.indexOf(n)]=e,t.scope!==i&&((t.scope=i).variables.set(t.name,t),i.enclosed.push(t),i.var_names().set(t.name,!0))}),value:e.value})})})}function qn(e,n){n=n.definition();return(n.fixed||0===n.fixed)&&On(n)&&Zn(n)&&!Bn(e,n)}function zn(e,n){if(n.option("optional_chains")&&e.terminal)do{var t=e.expression;if(e.optional){var i=N(n,t,!0);if(null==i)return ke(AST_UnaryPrefix,e,{operator:"void",expression:t}).optimize(n);i instanceof AST_Node||(e.optional=!1)}}while(("Call"==(e=t).TYPE||e instanceof AST_PropAccess)&&!e.terminal)}function G(e){var n,t=e.expression;return t instanceof AST_Sequence?(t=t.expressions.slice(),(n=e.clone()).expression=t.pop(),t.push(n),we(e,t)):e}function Un(e,t,n){var i=e.expression,r=i instanceof AST_SymbolRef?i.fixed_value():i;if(r instanceof AST_Lambda&&!r.uses_arguments&&!(r.pinned()||n&&n.indexOf(r)<0)){var o=e.args;if(all(o,function(e){return!(e instanceof AST_Spread)})){var a=r.argnames,n=r===i&&!r.name;if(r.rest){if(!n||!t.option("rests"))return;for(var s=a.length,o=o.slice(0,s);o.length<s;)o.push(ke(AST_Undefined,e).optimize(t));o.push(ke(AST_Array,e,{elements:e.args.slice(s)})),a=a.concat(r.rest),r.rest=null}else o=o.slice(),a=a.slice();for(var f=0,c=0,l=n&&t.option("default_values"),u=n&&t.drop_fargs(r,e)?function(e,n){return!e||(e instanceof AST_DestructuredArray?0==e.elements.length&&!e.rest&&n instanceof AST_Array:e instanceof AST_DestructuredObject?0==e.properties.length&&!e.rest&&n&&!n.may_throw_on_access(t):e.unused)}:return_false,_=[],S=0;S<o.length;S++){var p=a[S];if(l&&p instanceof AST_DefaultValue&&o[S].is_defined(t)&&(a[S]=p=p.name),p&&void 0===p.unused){if(u(p,o[S])){d=o[S].drop_side_effect_free(t);a.splice(S,1),o.splice(S,1),d&&_.push(d),S--;continue}_.push(o[S]),o[f++]=we(e,_),_=[]}else{var d=o[S].drop_side_effect_free(t);if(u(p)){p&&a.splice(S,1),o.splice(S,1),d&&_.push(d),S--;continue}if(d)_.push(d),o[f++]=we(e,_),_=[];else if(p){if(!_.length){o[f++]=ke(AST_Number,o[S],{value:0});continue}o[f++]=we(e,_),_=[]}}c=f}for(;S<a.length;S++)u(a[S])&&a.splice(S--,1);r.argnames=a,o.length=c,e.args=o,_.length&&(i=we(e,_),o.push(o.length<a.length?ke(AST_UnaryPrefix,e,{operator:"void",expression:i}):i))}}}function jn(e,n){n=n||e.find_parent(AST_Scope);var t=[];return(is_async(n)||n instanceof AST_Toplevel&&e.option("module"))&&t.push("await"),is_generator(n)&&t.push("yield"),t.length&&makePredicate(t)}function Ln(t,i){var r,o;return!i||(r=!0,o=new TreeWalker(function(e){if(!r)return!0;if(e instanceof AST_Scope){if(e===t)return;if(is_arrow(e))for(var n=0;r&&n<e.argnames.length;n++)e.argnames[n].walk(o);else e instanceof AST_LambdaDefinition&&i[e.name.name]&&(r=!1);return!0}e instanceof AST_Symbol&&i[e.name]&&e!==t.name&&(r=!1)}),t.walk(o),r)}function Vn(e,n){return e.in_strict_mode(n)||!n.has_directive("use strict")}function In(t,i,e,n){if(n instanceof AST_Binary&&("&&"==n.operator||"||"==n.operator)&&n.right instanceof AST_Assign&&"="==n.right.operator&&n.right.left instanceof AST_SymbolRef&&n.right.left.definition()===i&&!e.has_side_effects(t)&&r(n.left)&&r(n.right.right))return i.replaced++,ke(AST_Conditional,n,"&&"==n.operator?{condition:n.left,consequent:n.right.right,alternative:e}:{condition:n.left,consequent:e,alternative:n.right.right});function r(e){var n;if(!e.has_side_effects(t))return n=!1,e.walk(new TreeWalker(function(e){return!!n||(e instanceof AST_SymbolRef&&e.definition()===i?n=!0:void 0)})),!n}}AST_Scope.DEFMETHOD("merge_variables",function(l){if(l.option("merge_vars")){for(var u,_,S=[],p={},d=this,s=[],f=[],c=0,A=new Dictionary,T=Object.create(null),h=Object.create(null),m=new TreeWalker(function(t,e){var n,i,r,o,a,s;return t instanceof AST_Assign?(a=t.left,o=t.right,a instanceof AST_Destructured?(o.walk(m),x(AST_SymbolRef,k,a),!0):Ne[t.operator.slice(0,-1)]?(a.walk(m),g(),o.walk(m),a instanceof AST_SymbolRef&&k(a),b(),!0):a instanceof AST_SymbolRef?("="!=t.operator&&k(a,!0),o.walk(m),k(a),!0):void 0):t instanceof AST_Binary?Ne[t.operator]?(c(t),!0):void 0:t instanceof AST_Break?((s=m.loopcontrol_target(t))instanceof AST_IterationStatement||w(s),!0):t instanceof AST_Call?((i=t.expression)instanceof AST_LambdaExpression?(t.args.forEach(function(e){e.walk(m)}),i.walk(m)):(e(),f(i)),!0):t instanceof AST_Class?(t.name&&t.name.walk(m),t.extends&&t.extends.walk(m),t.properties.filter(function(e){return e.key instanceof AST_Node&&e.key.walk(m),e.value}).forEach(function(e){e.static?e.value.walk(m):(g(),p.block=t,e.value.walk(m),b())}),!0):t instanceof AST_Conditional?(c(t.condition,t.consequent,t.alternative),!0):t instanceof AST_Continue?((s=m.loopcontrol_target(t))instanceof AST_Do&&w(s),!0):t instanceof AST_Do?(g(),p.block=t,p.loop=!0,r=p,t.body.walk(m),p.inserted===t&&(p=r),t.condition.walk(m),b(),!0):t instanceof AST_For?(t.init&&t.init.walk(m),g(),p.block=t,p.loop=!0,t.condition&&t.condition.walk(m),t.body.walk(m),t.step&&t.step.walk(m),b(),!0):t instanceof AST_ForEnumeration?(t.object.walk(m),g(),p.block=t,p.loop=!0,t.init.walk(m),t.body.walk(m),b(),!0):t instanceof AST_If?(c(t.condition,t.body,t.alternative),!0):t instanceof AST_LabeledStatement?(g(),p.block=t,r=p,t.body.walk(m),p.inserted===t&&(p=r),b(),!0):t instanceof AST_Scope?(g(),(p.block=t)===d&&(_=p),t instanceof AST_Lambda&&(t.name&&(T[t.name.definition().id]=!1),n=t.uses_arguments&&!m.has_directive("use strict")?function(e){T[e.definition().id]=!1}:function(e){k(e)},S.push(t),t.argnames.forEach(function(e){x(AST_SymbolFunarg,n,e)}),t.rest&&x(AST_SymbolFunarg,n,t.rest),S.pop()),walk_lambda(t,m),b(),!0):t instanceof AST_Sub?(i=t.expression,(t.optional?(i.walk(m),g(),t.property.walk(m),b):e)(),f(i),!0):t instanceof AST_Switch?(t.expression.walk(m),r=p,t.body.forEach(function(e){e instanceof AST_Default||(e.expression.walk(m),r===p&&g())}),p=r,t.body.forEach(function(e){g(),p.block=t;var n=p;walk_body(e,m),p.inserted===t&&(p=n),b()}),!0):t instanceof AST_SymbolDeclaration?!(T[t.definition().id]=!1):t instanceof AST_SymbolRef?(k(t,!0),!0):t instanceof AST_Try?(o=u,u=t,walk_body(t,m),t.bcatch&&(t.bcatch.argname&&t.bcatch.argname.mark_symbol(function(e){e instanceof AST_SymbolCatch&&(e=e.definition(),T[e.id]=!1,e=e.redefined())&&(T[e.id]=!1)},m),t.bfinally||(u=o)?walk_body(t.bcatch,m):(g(),walk_body(t.bcatch,m),b())),u=o,t.bfinally&&t.bfinally.walk(m),!0):t instanceof AST_Unary?UNARY_POSTFIX[t.operator]&&(a=t.expression)instanceof AST_SymbolRef?(k(a,!0),!0):void 0:t instanceof AST_VarDef?((s=t.value)?s.walk(m):s=p.block instanceof AST_ForEnumeration&&p.block.init===m.parent(),x(AST_SymbolDeclaration,s?function(e){e instanceof AST_SymbolVar?k(e):e.walk(m)}:function(e){var n,t;e instanceof AST_SymbolVar?(n=e.definition().id,(t=T[n])?t.push(e):n in T||A.add(n,e)):e.walk(m)},t.name),!0):t instanceof AST_While?(g(),p.block=t,p.loop=!0,e(),b(),!0):void 0;function f(e){l.option("ie")&&(e=root_expr(e))instanceof AST_SymbolRef&&e.walk(m)}function c(e,n,t){var i=p,e=function e(n,t,i,r){var o={consequent:{segment:p,level:n},alternative:{segment:p,level:n}};if(t instanceof AST_Binary)switch(t.operator){case"&&":o.consequent=e(n+1,t.left,t.right).consequent;break;case"||":o.alternative=e(n+1,t.left,null,t.right).alternative;break;case"??":o.alternative=e(n+1,t.left,t.right,t.right).alternative;break;default:t.walk(m)}else t instanceof AST_Conditional?e(n+1,t.condition,t.consequent,t.alternative):t.walk(m);i&&(p=o.consequent.segment,g(),i.walk(m),o.consequent.segment=p);r&&(p=o.alternative.segment,g(),r.walk(m),o.alternative.segment=p);return o}(1,e,n,t);if(n){p=e.consequent.segment;for(var r=e.consequent.level;0<=--r;)b();if(p!==i)return}if(t){p=e.alternative.segment;for(r=e.alternative.level;0<=--r;)b();if(p!==i)return}p=i}}),e=(m.directives=Object.create(l.directives),d.walk(m),!1),n=Object.create(null);s.length&&f.length;){var t=f.shift();if(t){var i=t.definition,r=T[i.id];if(r){for(r={end:r.end};i.id in n;)i=n[i.id];r.start=T[i.id].start;var o=[];do{var a=s.shift();if(!(t.index>a.index)){var v=a.definition;if(v.id in h){var y=T[v.id];if(y){if(y.start.block===r.start.block&&E(y,r)&&(!y.start.loop&&Zn(i)||E(r,y))&&(!l.option("webkit")||is_funarg(i)===is_funarg(v))&&!v.const_redefs&&all(y.scopes,function(e){return e.find_variable(i.name)===i})){y.forEach(function(e){e.thedef=i,e.name=i.name,e instanceof AST_SymbolRef?(i.references.push(e),v.replaced++):(i.orig.push(e),v.eliminated++)}),v.fixed||(i.fixed=!1),n[v.id]=i,e=!0;break}o.push(a)}}}}while(s.length);o.length&&(s=o.concat(s))}}}return e}function g(){p=Object.create(p)}function b(){p=Object.getPrototypeOf(p)}function x(n,t,e){var i=new TreeWalker(function(e){if(!(e instanceof AST_Destructured))return e instanceof AST_DefaultValue?(g(),e.value.walk(m),b(),e.name.walk(i)):e instanceof AST_DestructuredKeyVal?e.key instanceof AST_Node?e.value instanceof AST_PropAccess?(g(),(p.block=e).key.walk(m),e.value.walk(i),b()):(e.key.walk(m),e.value.walk(i)):e.value.walk(i):e instanceof n?t(e):e.walk(m),!0});e.walk(i)}function k(n,e){var t,i=n.definition();if(e&&!all(S,function(e){return!(t=e.variables.get(n.name))||!is_funarg(t)||t!==i&&!i.undeclared&&e.parent_scope.find_variable(n.name)!==i}))return T[i.id]=T[t.id]=!1;var r,o=p;if(u&&(g(),o=p,b()),i.id in T){if(!(r=T[i.id]))return;if(r.start.block!==o.block)return T[i.id]=!1;if(a(n),r.end=o,i.id in h)f[h[i.id]]=null;else if(!e)return}else{if((t=d.variables.get(i.name))!==i)return t&&_===o&&(T[t.id]=!1),T[i.id]=!1;if(l.exposed(i)||Tn[n.name])return T[i.id]=!1;if((r=A.get(i.id)||[]).scopes=[],a(n),T[i.id]=r,!e)return r.start=o,s.push({index:c++,definition:i});if(o.block!==d)return T[i.id]=!1;r.start=_}function a(e){r.push(e),push_uniq(r.scopes,e.scope);var n=xe(m);n!==e.scope&&push_uniq(r.scopes,n)}h[i.id]=f.length,f.push({index:c++,definition:i})}function w(e){for(var n=[];;){if(HOP(p,"block")){var t=p.block;if((t=t instanceof AST_LabeledStatement?t.body:t)===e)break}n.push(p),b()}for(p.inserted=p.block,g();n.length;){var i=n.pop();g(),HOP(i,"block")&&(p.block=i.block),HOP(i,"loop")&&(p.loop=i.loop)}}function D(e,n){return e===n||e.isPrototypeOf(n)}function E(e,n){return D(e.start,e.end)||D(e.start,n.start)}}),AST_Scope.DEFMETHOD("drop_unused",function(R){if(R.option("unused")){var O=this,B=!(O instanceof AST_Toplevel)||R.toplevel.funcs,P=!(O instanceof AST_Toplevel)||R.toplevel.vars,F=/keep_assign/.test(R.option("unused"))?return_false:function(e,n){var t,i=!1;if(e instanceof AST_Assign?!e.write_only&&"="!=e.operator||(t=r(e.left,n)):e instanceof AST_Unary&&e.write_only&&(t=r(e.expression,n)),t instanceof AST_SymbolRef){e=t.definition();if(!a[e.id]&&!R.exposed(e)&&be(t,R,i))return t}function r(e,n){if(e instanceof AST_PropAccess){var t=e.expression;if(!t.may_throw_on_access(R,!0))return i=!0,n&&e instanceof AST_Sub&&n.unshift(e.property),r(t,n)}else if(e instanceof AST_Assign&&"="==e.operator)return e.write_only="p",t=r(e.right),!n||(n.assign=e,t instanceof AST_SymbolRef)?t:e.left;return e}},q=Object.create(null),a=Object.create(null),l=function(e){return(l=function e(n,t,i){var r=R.parent(t);if(!r)return i;n=r instanceof AST_Lambda&&member(n,r.argnames);return e(r,t+1,n?function(e){var n=i(e);if(n)return n;if(n=r.variables.get(e)){e=n.orig[0];if(e instanceof AST_SymbolFunarg||e instanceof AST_SymbolLambda)return n}}:r.variables?function(e){return i(e)||r.variables.get(e)}:i)}(O,0,noop))(e)},z=Object.create(null),u=[],U=Object.create(null),_=Object.create(null),S=Object.create(null),p=Object.create(null),j=Object.create(null),d=(O instanceof AST_Toplevel&&R.top_retain&&O.variables.each(function(e){!R.top_retain(e)||e.id in U||(AST_Node.info("Retaining variable {name}",e),U[e.id]=!0,u.push(e))}),new Dictionary),A=new Dictionary,L=this,V=((T=new TreeWalker(function(s,e){if(s instanceof AST_Lambda&&s.uses_arguments&&!T.has_directive("use strict")&&s.each_argname(function(e){e=e.definition();e.id in U||(U[e.id]=!0,u.push(e))}),s!==O){if(L===O){var t,i,n,r;if(s instanceof AST_DefClass)return r=s.name.definition(),(n=B&&!r.exported)||r.id in U||(U[r.id]=!0,u.push(r)),(t=T.parent()instanceof AST_ExportDefault)?a[r.id]=!0:!n||r.id in _||(_[r.id]=1),s.extends&&s.extends.walk(T),i=[],s.properties.forEach(function(e){e.key instanceof AST_Node&&e.key.walk(T);var n=e.value;n&&(he(e)?(!t&&n.contains_this()&&(t=!0),o(n)):i.push(n))}),i.forEach(n&&t?o:function(e){A.add(r.id,e)}),!0;if(s instanceof AST_LambdaDefinition)return r=s.name.definition(),(n=B&&!r.exported)||r.id in U||(U[r.id]=!0,u.push(r)),A.add(r.id,s),T.parent()instanceof AST_ExportDefault?(a[r.id]=!0,f(s,e,!0)):(!n||r.id in _||(_[r.id]=1),!0);if(s instanceof AST_Definitions)return s.definitions.forEach(function(i){var r=i.value,o=r&&(i.name instanceof AST_Destructured||r.has_side_effects(R)),a=o&&"="==r.tail_node().operator;i.name.mark_symbol(function(e){var n,t;if(e instanceof AST_SymbolDeclaration)return n=e.definition(),j[n.id]=(j[n.id]||0)+1,s instanceof AST_Var&&n.orig[0]instanceof AST_SymbolCatch&&(t=n.redefined())&&(j[t.id]=(j[t.id]||0)+1),n.id in U||P&&!n.exported&&(s instanceof AST_Const?!n.redefined():!n.const_redefs)&&(s instanceof AST_Var||On(n))||(U[n.id]=!0,u.push(n)),r&&(o?a&&v(n,e,p[n.id]):A.add(n.id,r),d.add(n.id,i)),y(n),!0},T),o&&r.walk(T)}),!0;if(s instanceof AST_SymbolFunarg)return r=s.definition(),j[r.id]=(j[r.id]||0)+1,d.add(r.id,s),!0;if(s instanceof AST_SymbolImport)return(r=s.definition()).id in U||P&&On(r)||(U[r.id]=!0,u.push(r)),!0}return f(s,e,!0)}function o(e){var n=L;L=s,e.walk(T),L=n}})).directives=Object.create(R.directives),O.walk(T),R.option("keep_fnames")?return_false:R.option("ie")?function(e){return!R.exposed(e)&&e.references.length==e.replaced}:function(e){return!(e.id in U)||!(e.orig.length-e.eliminated<2)&&(e.orig[1]instanceof AST_SymbolFunarg||all(e.references,function(e){return!e.in_arg}))});R.option("ie")&&A.each(function(e,n){n in U||e.forEach(function(e){e.walk(new TreeWalker(function(e){return e instanceof AST_Function&&e.name&&!V(e.name.definition())?(e.walk(T),!0):e instanceof AST_Scope||void 0}))})});for(var T=new TreeWalker(f),e=0;e<u.length;e++){var n=A.get(u[e].id);n&&n.forEach(function(e){e.walk(T)})}Object.keys(q).forEach(function(e){var n,t=q[e];t&&(t=t.reduce(function(n,e){return e.forEach(function(e){push_uniq(n,e)}),n},[]),n=(d.get(e)||[]).filter(function(n){return find_if(n instanceof AST_Unary?function(e){return e===n}:function(e){return e===n||!(e instanceof AST_Unary)&&i(e)===i(n)},t)}),t.length==n.length)?q[e]=n:delete q[e]});var I=[],M=[],H=new TreeTransformer(function(t){if(t instanceof AST_DefaultValue)return E(H,t);if(t instanceof AST_Destructured&&t.rest&&(t.rest=t.rest.transform(H)),t instanceof AST_DestructuredArray){for(var e=!t.rest,n=t.elements.length;0<=--n;){var i=t.elements[n].transform(H);i?(t.elements[n]=i,e=!1):e?t.elements.pop():t.elements[n]=ke(AST_Hole,t.elements[n])}return t}var r;return t instanceof AST_DestructuredObject?(r=[],t.properties.forEach(function(e){var n=!1;e.key instanceof AST_Node&&(e.key=e.key.transform(W),n=e.key.has_side_effects(R)),(n||t.rest)&&((n=e.value)instanceof AST_DefaultValue?n.name:n)instanceof AST_SymbolDeclaration?(e.value=e.value.transform(W),r.push(e)):(n=!(n=e.value.transform(H))&&t.rest?e.value instanceof AST_DestructuredArray?ke(AST_DestructuredArray,e.value,{elements:[]}):ke(AST_DestructuredObject,e.value,{properties:[]}):n)&&(e.value=n,r.push(e))}),t.properties=r,t):t instanceof AST_SymbolDeclaration?$(t):void 0}),W=new TreeTransformer(function(S,n,e){var t,i,p=W.parent();if(P){var r,o,a=[],s=F(S,a);if(s){if(i=S,T=(t=s).definition(),r=!(o=U[T.id])||i[i instanceof AST_Assign?"left":"expression"]===t&&(o===t&&T.references.length-T.replaced==1||G(T,i)<0)?(r=S instanceof AST_Assign&&(r=Q(S),!0===S.write_only)?r.drop_side_effect_free(R):r)||ke(AST_Number,S,{value:0}):r)switch(a.assign&&(o=a.assign.drop_side_effect_free(R))&&(o.write_only=!0,a.unshift(o)),p instanceof AST_Sequence&&p.tail_node()!==S&&!r.has_side_effects(R)||a.push(r),a.length){case 0:return List.skip;case 1:return De(p,S,a[0].transform(W));default:return we(S,a.map(function(e){return e.transform(W)}))}}else if(S instanceof AST_UnaryPostfix&&S.expression instanceof AST_SymbolRef&&G(S.expression.definition(),S)<0)return ke(AST_UnaryPrefix,S,{operator:"+",expression:S.expression})}if(S instanceof AST_Binary&&"instanceof"==S.operator)return!((s=S.right)instanceof AST_SymbolRef)||s.definition().id in U?void 0:(t=S.left.drop_side_effect_free(R),r=ke(AST_False,S).optimize(R),t?we(S,[t,r]):r);if(S instanceof AST_Call)return I.push(S),S.args=S.args.map(function(e){return e.transform(W)}),S.expression=S.expression.transform(W),S;if(L===O){if(B&&S!==O&&S instanceof AST_DefClass)if(!((u=S.name.definition()).id in U))return Y(S.name,"Dropping unused class {name}"),u.eliminated++,n(S,W),_=mn(S,!0),p instanceof AST_ExportDefault?_:(_=_.drop_side_effect_free(R,!0))?ke(AST_SimpleStatement,S,{body:_}):e?List.skip:ke(AST_EmptyStatement,S);if(S instanceof AST_ClassExpression&&S.name&&V(S.name.definition())&&(S.name=null),S instanceof AST_Lambda){if(B&&S!==O&&S instanceof AST_LambdaDefinition)if(!((u=S.name.definition()).id in U))return Y(S.name,"Dropping unused function {name}"),u.eliminated++,p instanceof AST_ExportDefault?(N(),vn(S,!0)):e?List.skip:ke(AST_EmptyStatement,S);if(N(),S instanceof AST_LambdaExpression&&S.name&&V(S.name.definition())&&(S.name=null),!(S instanceof AST_Accessor)){var f,c,l=R.drop_fargs(S,p);if(l&&p instanceof AST_Call&&p.expression===S)for(f=p.args,c=0;c<f.length&&!(f[c]instanceof AST_Spread);c++);for(var u,_,d,A=S.argnames,T=S.rest,h=!1,m=!1,v=(T&&(m=!0,!f||c<A.length||T instanceof AST_SymbolFunarg?T=T.transform(H):(T=(_=X(T,ke(AST_Array,p,{elements:f.slice(A.length)}),$,!S.uses_arguments,T)).name,f.length=A.length,_.value.elements.length&&[].push.apply(f,_.value.elements)),T instanceof AST_Destructured&&!T.rest&&(T instanceof AST_DestructuredArray?0==T.elements.length&&(T=null):0==T.properties.length&&(T=null)),S.rest=T)&&(h=!(l=!1)),l?-1:S.length()),y=f&&!S.uses_arguments&&p!==R.parent(),g=A.length;0<=--g;)(s=A[g])instanceof AST_SymbolFunarg?(u=s.definition()).id in U?(l=!1,G(u,s)<0&&(s.unused=null)):(l&&(Y(s,"Dropping unused function argument {name}"),A.pop(),u.eliminated++),s.unused=!0):(m=!0,!f||c<g?d=s.transform(H):(d=(_=X(s,f[g],$,y,s)).name,_.value&&(f[g]=_.value)),d?(l=!1,A[g]=d,h=h||!(d instanceof AST_SymbolFunarg)):l?(K(s,"Dropping unused default argument {name}"),A.pop()):v<g?(K(s,"Dropping unused default argument assignment {name}"),s.name instanceof AST_SymbolFunarg?s.name.unused=!0:h=!0,A[g]=s.name):(K(s,"Dropping unused default argument value {name}"),A[g]=s=s.clone(),s.value=ke(AST_Number,s,{value:0}),h=!0));m&&!h&&S.uses_arguments&&!W.has_directive("use strict")&&(S.rest=ke(AST_DestructuredArray,S,{elements:[]})),M.push(S)}return S}if(S instanceof AST_Catch&&S.argname instanceof AST_Destructured&&S.argname.transform(H),!(S instanceof AST_Definitions)||p instanceof AST_ForEnumeration&&p.init===S)return S instanceof AST_Assign?(n(S,W),S.left instanceof AST_Destructured?(_=X(S.left,S.right,function(e){return e},!0===S.write_only)).name?ke(AST_Assign,S,{operator:S.operator,left:_.name,right:_.value}):_.value||(p instanceof AST_Sequence&&p.tail_node()!==S?List.skip:ke(AST_Number,S,{value:0})):S):S instanceof AST_LabeledStatement&&S.body instanceof AST_For?(n(S,W),S.body instanceof AST_BlockStatement?(S.body=(i=S.body).body.pop(),i.body.push(S),e?List.splice(i.body):i):S):S instanceof AST_Scope?(N(),S):S instanceof AST_SymbolImport?!R.option("imports")||S.definition().id in U?S:e?List.skip:null:void 0;var b=[],x=[],k=[],w=[],D=0,E=S instanceof AST_Var;switch(S.definitions.forEach(function(e){e.value&&(e.value=e.value.transform(W));var n=e.value;if(e.name instanceof AST_Destructured)(f=X(e.name,n,function(e){return!P||e.definition().id in U||u(e)||E&&!be(e)?e:null},!0)).name?(e=ke(AST_VarDef,e,{name:f.name,value:n=f.value}),_()):f.value&&w.push(f.value);else{var t,i,r,o,a,s=e.name.definition(),f=E?be(e.name):On(s);if(!f||!P||s.id in U)if(n&&((o=G(s,e))<0||(a=n.tail_node())instanceof AST_SymbolRef&&a.definition()===s)&&(e=e.clone(),(n=n.drop_side_effect_free(R))&&AST_Node.warn("Side effects in definition of variable {name} [{start}]",e.name),S instanceof AST_Const?e.value=n||ke(AST_Number,e,{value:0}):(e.value=null,n&&w.push(n)),n=null,0<=o)&&(q[s.id][o]=e),n||S instanceof AST_Let)if(R.option("functions")&&!R.option("ie")&&f&&n&&1==j[s.id]&&0==s.assignments&&(a=n.tail_node())instanceof AST_LambdaExpression&&!ge(s)&&!is_arrow(a)&&(r=a,0==(o=s.references).length?r===e.name.fixed_value():all(o,function(e){return r===e.fixed_value()}))&&(i=a,E&&!R.has_directive("use strict")&&i instanceof AST_Function?p instanceof AST_Block||p instanceof AST_For&&p.init===S||p instanceof AST_If:p instanceof AST_Scope)&&!1!==(i=function(t,i){if(!t.name)return null;var r,e=t.name.definition();if(1<e.orig.length)return null;if(0<e.assignments)return!1;if(e.name==i)return e;if(R.option("keep_fnames"))return!1;switch(i){case"await":r=is_async;break;case"yield":r=is_generator}return all(e.references,function(e){var n=e.scope;if(n.find_variable(i)!==s)return!1;if(r)do{if(n=n.resolve(),r(n))return!1}while(n!==t&&(n=n.parent_scope));return!0})&&e}(a,e.name.name))){switch(AST_Node.warn("Declaring {name} as function [{start}]",e.name),a.CTOR){case AST_AsyncFunction:t=AST_AsyncDefun;break;case AST_AsyncGeneratorFunction:t=AST_AsyncGeneratorDefun;break;case AST_Function:t=AST_Defun;break;case AST_GeneratorFunction:t=AST_GeneratorDefun}var c=ke(t,a),l=(c.name=ke(AST_SymbolDefun,e.name),e.name.scope.resolve().def_function(c.name));i&&i.forEach(function(e){e.name=l.name,e.thedef=l,e.reference()}),b.push(c),n!==a&&[].push.apply(w,n.expressions.slice(0,-1)),s.eliminated++}else f&&1<j[s.id]&&!(p instanceof AST_ExportDeclaration)&&s.orig.indexOf(e.name)>s.eliminated&&(j[s.id]--,D++),_();else p instanceof AST_ExportDeclaration?_():f&&1<j[s.id]?(AST_Node.info("Dropping declaration of variable {name} [{start}]",e.name),j[s.id]--,s.eliminated++):x.push(e);else u(e.name)?((n=n&&n.drop_side_effect_free(R))&&w.push(n),1<j[s.id]?(AST_Node.warn("Dropping duplicated declaration of variable {name} [{start}]",e.name),j[s.id]--,s.eliminated++):(e.value=null,x.push(e))):((n=n&&n.drop_side_effect_free(R))?(AST_Node.warn("Side effects in initialization of unused variable {name} [{start}]",e.name),w.push(n)):Y(e.name,"Dropping unused variable {name}"),s.eliminated++)}function u(e){var n=e.definition();return n.orig[0]instanceof AST_SymbolCatch&&n.scope.resolve()===e.scope.resolve()}function _(){0<w.length&&(0==k.length?b.push(ke(AST_SimpleStatement,S,{body:we(S,w)})):n?(w.push(n),e.value=we(n,w)):e.value=ke(AST_UnaryPrefix,e,{operator:"void",expression:we(e,w)}),w=[]),k.push(e)}}),x.length){case 0:if(0==k.length)break;if(k.length==D){[].unshift.apply(w,k.map(function(e){AST_Node.info("Dropping duplicated definition of variable {name} [{start}]",e.name);var n=e.name.definition(),t=ke(AST_SymbolRef,e.name),t=(n.references.push(t),ke(AST_Assign,e,{operator:"=",left:t,right:e.value})),e=G(n,e);return 0<=e&&(q[n.id][e]=t),n.assignments++,n.eliminated++,t}));break}case 1:if(0==k.length){var C=x[0].name.definition().id;if(C in z){S.definitions=x,z[C].init=S;break}}default:0<k.length&&(C=k[0].value)instanceof AST_Sequence&&(k[0].value=C.tail_node(),b.push(ke(AST_SimpleStatement,S,{body:we(C,C.expressions.slice(0,-1))}))),S.definitions=x.concat(k),b.push(S)}return 0<w.length&&b.push(ke(AST_SimpleStatement,S,{body:we(S,w)})),J(b,S,e)}function N(){var e=L;n(L=S,W),L=e}},function(e,n){if(e instanceof AST_BlockStatement)return pn(e,W.parent(),n);if(e instanceof AST_ExportDeclaration)return(t=e.body)instanceof AST_BlockStatement?(e.body=t.body.pop(),t.body.push(e),n?List.splice(t.body):t):void 0;if(e instanceof AST_For)return Ue(e,n);if(e instanceof AST_ForIn){if(!P||!R.option("loops"))return;if(!ee(e.body))return;var t=g(e);if(!t)return;var i=t.definition();if(i.id in U)return;Y(t,"Dropping unused loop variable {name}"),z[i.id]===e&&delete z[i.id];var t=[],r=e.object.drop_side_effect_free(R);return r&&(AST_Node.warn("Side effects in object of for-in loop [{start}]",r),t.push(ke(AST_SimpleStatement,e,{body:r}))),e.init instanceof AST_Definitions&&i.orig[0]instanceof AST_SymbolCatch&&t.push(e.init),J(t,e,n)}return e instanceof AST_Import?(e.properties&&0==e.properties.length&&(e.properties=null),e):e instanceof AST_Sequence&&!(1<e.expressions.length)?De(W.parent(),e,e.expressions[0]):void 0});W.push(R.parent()),W.directives=Object.create(R.directives),O.transform(W),O instanceof AST_Lambda&&1==O.body.length&&O.body[0]instanceof AST_Directive&&"use strict"==O.body[0].value&&(O.body.length=0),I.forEach(function(e){Un(e,R,M)})}function Y(e,n){AST_Node[0<e.definition().references.length?"info":"warn"](n+" [{start}]",e)}function K(e,n){e.name instanceof AST_SymbolFunarg?Y(e.name,n):AST_Node.info(n+" [{start}]",e)}function i(e){return e[e instanceof AST_Assign?"right":"value"]}function J(e,n,t){switch(e.length){case 0:return t?List.skip:ke(AST_EmptyStatement,n);case 1:return e[0];default:return t?List.splice(e):ke(AST_BlockStatement,n,{body:e})}}function h(e,n){return e.scope.resolve()===O&&(e.fixed&&n.fixed||(q[e.id]=!1),!1!==q[e.id])}function m(e,n){q[e.id]||(q[e.id]=[]),n.fixed.assigns&&push_uniq(q[e.id],n.fixed.assigns)}function G(e,n){e=q[e.id];return e&&e.indexOf(n)}function y(e){1<_[e.id]&&!(e.id in U)&&(U[e.id]=!0,u.push(e)),_[e.id]=0}function v(e,n,t){e.id in U||(n&&t?(U[e.id]=n,u.push(e)):(S[e.id]=n,p[e.id]=t))}function Q(e){var n=e.right;return!e.write_only||!(n instanceof AST_Binary&&Ne[n.operator])||!(n.left instanceof AST_SymbolRef)||!(e.left instanceof AST_SymbolRef)||(e=e.left.definition(),n.left.definition()!==e)||n.right.has_side_effects(R)?n:(h(e,n.left)&&m(e,n.left),n.right)}function g(e){var n=e.init;if(n instanceof AST_Definitions)return(n=n.definitions[0].name)instanceof AST_SymbolDeclaration&&n;for(;n instanceof AST_PropAccess;)n=n.expression.tail_node();return n instanceof AST_SymbolRef?n:void 0}function f(e,n,t){e instanceof AST_Assign&&e.left instanceof AST_SymbolRef&&(o=e.left.definition()).scope.resolve()===O&&d.add(o.id,e),e instanceof AST_SymbolRef&&e.in_arg&&(j[e.definition().id]=0),e instanceof AST_Unary&&e.expression instanceof AST_SymbolRef&&(o=e.expression.definition()).scope.resolve()===O&&d.add(o.id,e);var i,r,o,a,s,f=[],c=F(e,f);if(c)return(a=c.definition()).scope.resolve()!==O&&O.variables.get(c.name)!==a||ge(a)&&!all(O.argnames,function(e){return!e.match_symbol(function(e){if(e instanceof AST_SymbolFunarg)return(e=e.definition()).references.length>e.replaced},!0)})||"p"===e.write_only&&e.right.may_throw_on_access(R,!0)?void 0:((i=f.assign)&&(i.write_only=!0,i.walk(T)),f.forEach(function(e){e.walk(T)}),e instanceof AST_Assign&&(i=c.fixed_value(),f=Q(e),i=i&&i.is_constant(),s=!1,t&&!0===e.write_only&&(i||e.left===c||f.equals(c))&&!f.has_side_effects(R)?A.add(a.id,f):(f.walk(T),s="="==f.tail_node().operator),e.left===c?e.write_only&&!s||v(a,c,p[a.id]):i||v(a,S[a.id],!0)),h(a,c)&&is_lhs(c,e)!==c&&m(a,c),y(a),!0);if(e instanceof AST_Binary)return"instanceof"==e.operator&&(c=e.right)instanceof AST_SymbolRef&&(r=c.definition().id,_[r])?(e.left.walk(T),_[r]++,!0):void 0;if(e instanceof AST_ForIn){if(e.init instanceof AST_SymbolRef&&L===O&&((r=e.init.definition().id)in z||(z[r]=e)),!P||!R.option("loops"))return;if(!ee(e.body))return;if(e.init.has_side_effects(R))return;if(!(c=g(e)))return;if((o=c.definition()).scope.resolve()!==O){t=l(c.name);if(t===o||t&&t.redefined()===o)return}return e.object.walk(T),!0}return e instanceof AST_SymbolRef?((a=e.definition()).id in U||(U[a.id]=!0,u.push(a)),!b(a.scope,e.scope)||!(f=a.redefined())||f.id in U||(U[f.id]=!0,u.push(f)),h(a,e)&&m(a,e),!0):e instanceof AST_Scope?(s=L,L=e,n(),L=s,!0):void 0}function $(e){return e.definition().id in U?e:(e instanceof AST_SymbolFunarg&&(e.unused=!0),null)}function E(e,n){if(n.value=n.value.transform(W),!n.name.transform(e)){if(n.name instanceof AST_Destructured)return null;e=n.value.drop_side_effect_free(R);if(!e)return null;Y(n.name,"Side effects in default value of unused variable {name}"),(n=n.clone()).name.unused=null,n.value=e}return n}function X(e,v,y,g,b){var x=!0,k=new TreeTransformer(function(r){if(r instanceof AST_DefaultValue){if(!(R.option("default_values")&&v&&v.is_defined(R)))return n=g,g=!1,i=E(k,r),g=n,!i&&g&&(v=v&&v.drop_side_effect_free(R)),i;r===b?b=r=r.name:r=r.name}if(r instanceof AST_DestructuredArray){var e,n=g,o=x,t=v;if(v instanceof AST_SymbolRef&&(g=!1,v=v.fixed_value()),v instanceof AST_Array){if(e=!0,d=v.elements,o)for(_=d.length;0<=--_&&!d[_].has_side_effects(R););}else e=v&&v.is_string(R),d=!1,_=r.elements.length;var i,a=[],s=g&&[],f=0;if(r.elements.forEach(function(e,n){o&&(x=_<=n),(v=d&&d[n])instanceof AST_Hole?v=null:v instanceof AST_Spread&&(g&&(s.length=f,hn(t,s),[].push.apply(s,d.slice(n)),t.elements=s),v=d=!1),(e=e.transform(k))&&(a[f]=e),g&&v&&(s[f]=v),!e&&!v&&g&&d||f++}),v=d&&ke(AST_Array,t,{elements:d.slice(r.elements.length)}),r.rest&&(i=g,g=!1,r.rest=r.rest.transform(R.option("rests")?k:W),g=i,r.rest)&&(a.length=f),g&&(v=(v=v&&!r.rest?v.drop_side_effect_free(R):v)instanceof AST_Array?v.elements:v instanceof AST_Sequence?v.expressions:v&&[v])&&v.length&&(s.length=f,[].push.apply(s,v)),v=t,x=o,g=n,d&&s&&(hn(v,s),(v=v.clone()).elements=s),e){if(!r.rest)e:switch(a.length){case 0:if(r===b)break;return g&&(v=v.drop_side_effect_free(R)),null;default:if(!g)break;if(!x)break;if(r===b)break;for(var c,f=a.length;0<=--f;){var l=a[f];if(l){c=l;break}}if(f<0)break;for(var u=f;0<=--u;)if(a[u])break e;if(c.has_side_effects(R))break;if(v.has_side_effects(R)&&c.match_symbol(function(e){return e instanceof AST_PropAccess}))break;return v=ke(AST_Sub,r,{expression:v,property:ke(AST_Number,r,{value:f})}),c}}else a.length=r.elements.length;hn(r,a),r.elements=a}else if(r instanceof AST_DestructuredObject){var _,S,p,d,n=g,o=x,t=v,A=(v instanceof AST_SymbolRef&&(g=!1,v=v.fixed_value()),v instanceof AST_Object?(_=-1,S=[],p=new Dictionary,d=v.properties.map(function(e,n){var t;return o&&e.has_side_effects(R)&&(_=n),(e=e.clone())instanceof AST_Spread?p=!1:((t=(t=e.key)instanceof AST_Node?t.evaluate(R,!0):t)instanceof AST_Node?p=!1:!p||e instanceof AST_ObjectSetter||p.set(t,e),S[n]=t),e})):_=r.properties.length,r.rest&&(v=!1,r.rest=r.rest.transform(R.option("rests")?k:W)),new Dictionary),T=g&&new Dictionary,h=[];if(r.properties.map(function(e){var n=e.key;return n instanceof AST_Node&&(e.key=n=n.transform(W),n=n.evaluate(R,!0)),n instanceof AST_Node?T=!1:A.set(n,!A.has(n)),n}).forEach(function(e,n){var t,i=r.properties[n];o&&(x=_<=n),e instanceof AST_Node?(v=g=!1,t=i.value.transform(k)||D(i.value)):(g=T&&A.get(e),(!(n=p&&p.get(e))||(v=n.value)instanceof AST_Accessor)&&(v=!1),(t=i.value.transform(k))?T&&T.set(e,!1):((r.rest||w(i))&&(t=D(i.value)),T&&!T.has(e)&&(n?(T.set(e,n),null===v&&p.set(e,w(n)&&ke(AST_ObjectKeyVal,n,{key:n.key,value:ke(AST_Number,n,{value:0})}))):T.set(e,!0))),v&&(n.value=v)),t&&(i.value=t,h.push(i))}),v=t,x=o,g=n,T&&S&&((v=v.clone()).properties=List(d,function(e,n){if(e instanceof AST_Spread)return e;n=S[n];if(n instanceof AST_Node)return e;if("__proto__"===n)return e;if(T.has(n)){var t=T.get(n);if(!t)return e;if(t===e)return p.get(n)||List.skip}else if(r.rest)return e;t=e.value.drop_side_effect_free(R);return t?(e.value=t,e):w(e)?ke(AST_ObjectKeyVal,e,{key:e.key,value:ke(AST_Number,e,{value:0})}):List.skip})),v&&!r.rest)switch(h.length){case 0:if(r===b)break;if(v.may_throw_on_access(R,!0))break;return g&&(v=v.drop_side_effect_free(R)),null;case 1:if(!g)break;if(!x)break;if(r===b)break;var m=h[0];if(m.key instanceof AST_Node)break;if(m.value.has_side_effects(R))break;if(v.has_side_effects(R)&&m.value.match_symbol(function(e){return e instanceof AST_PropAccess}))break;return v=is_identifier_string(m.key)?ke(AST_Dot,r,{expression:v,property:m.key}):ke(AST_Sub,r,{expression:v,property:Z(m.key,m)}),m.value}r.properties=h}else!(r=r instanceof AST_Hole?null:y(r))&&g&&(v=v&&v.drop_side_effect_free(R));return r});return{name:e.transform(k),value:v};function w(e){return e.key instanceof AST_Node&&e.key.has_side_effects(R)}function D(e){return e instanceof AST_DefaultValue?D(e.name):e instanceof AST_Destructured?(null===v?v=ke(AST_Number,e,{value:0}):v&&(v.may_throw_on_access(R,!0)?v=ke(AST_Array,e,{elements:v instanceof AST_Sequence?v.expressions:[v]}):function e(n){n instanceof AST_Assign?(n.write_only=!1,e(n.right)):n instanceof AST_Binary?Ne[n.operator]&&(e(n.left),e(n.right)):n instanceof AST_Conditional?(e(n.consequent),e(n.alternative)):n instanceof AST_Sequence?e(n.tail_node()):n instanceof AST_Unary&&(n.write_only=!1)}(v)),ke(AST_DestructuredObject,e,{properties:[]})):(e.unused=null,e)}}}),AST_Scope.DEFMETHOD("hoist_declarations",function(a){var s,f,c,n,l,u,_,S,p,i;!a.has_directive("use asm")&&(s=a.option("hoist_funs"),f=a.option("hoist_vars"),c=this,f&&(n=0,c.walk(new TreeWalker(function(e){return 1<n||e instanceof AST_ExportDeclaration||e instanceof AST_Scope&&e!==c||(e instanceof AST_Var?(n++,!0):void 0)})),n<=1)&&(f=!1),s||f)&&(l=new Dictionary,u=[],_=[],S=new Dictionary,p=new TreeTransformer(function(e,n,t){if(e!==c){if(e instanceof AST_Directive)return u.push(e),t?List.skip:ke(AST_EmptyStatement,e);var i;if(e instanceof AST_LambdaDefinition)return!s||(i=p.parent())instanceof AST_ExportDeclaration||i instanceof AST_ExportDefault||i!==c&&a.has_directive("use strict")?e:(_.push(e),t?List.skip:ke(AST_EmptyStatement,e));if(e instanceof AST_Var){if(!f)return e;if((i=p.parent())instanceof AST_ExportDeclaration)return e;if(!all(e.definitions,function(e){e=e.name;return e instanceof AST_SymbolVar&&!l.has(e.name)&&c.find_variable(e.name)===e.definition()}))return e;e.definitions.forEach(function(e){var n=e.name.name;S.has(n)||S.set(n,e)});var r,o=e.to_assignments();return i instanceof AST_ForEnumeration&&i.init===e?o||(r=e.definitions[0].name,ke(AST_SymbolRef,r)):i instanceof AST_For&&i.init===e?o:o?ke(AST_SimpleStatement,e,{body:o}):t?List.skip:ke(AST_EmptyStatement,e)}return e instanceof AST_Scope?e:e instanceof AST_SymbolConst?(l.set(e.name,!0),e):void 0}}),c.transform(p),0<S.size()&&(i=[],c instanceof AST_Lambda&&c.each_argname(function(e){all(e.definition().references,function(e){return!e.in_arg})&&S.del(e.name)}),S.each(function(e){var n=e.name,t=((e=e.clone()).name=n.clone(),e.value=null,i.push(e),n.definition().orig);t.splice(t.indexOf(n),0,e.name)}),0<i.length)&&_.push(ke(AST_Var,c,{definitions:i})),c.body=u.concat(_,c.body))}),AST_Scope.DEFMETHOD("process_returns",noop),AST_Defun.DEFMETHOD("process_returns",function(e){if(e.option("booleans")&&!(e.parent()instanceof AST_ExportDefault))switch(bn(this.name.definition(),gn(this),e)){case"d":wn(e,this,!0);break;case!0:xn(this,e)}}),AST_Function.DEFMETHOD("process_returns",function(n){if(n.option("booleans")){var t=!0,i=gn(this);if(!this.name||c(this.name.definition())){var e=n.parent();if(e instanceof AST_Assign){if("="!=e.operator)return;if(!((o=e.left)instanceof AST_SymbolRef))return;if(!c(o.definition()))return}else if(e instanceof AST_Call&&e.expression!==this){var r=e.expression;if(!((r=r instanceof AST_SymbolRef?r.fixed_value():r)instanceof AST_Lambda))return;if(r.uses_arguments||r.pinned())return;for(var o,a=e.args,s=0;s<a.length;s++){var f=a[s];if(f===this){if(!(o=r.argnames[s])&&r.rest)return;break}if(f instanceof AST_Spread)return}if((o=o instanceof AST_DefaultValue?o.name:o)instanceof AST_SymbolFunarg&&!c(o.definition()))return}else{if("Call"!=e.TYPE)return;n.pop();e=n.in_boolean_context();switch(n.push(this),e){case!0:t=!1;case"d":break;default:return}}t?wn(n,this,!0):xn(this,n)}}function c(e){switch(bn(e,i,n)){case!0:t=!1;case"d":return 1}}}),AST_BlockScope.DEFMETHOD("var_names",function(){var t=this._var_names;return t||(this._var_names=t=new Dictionary,this.enclosed.forEach(function(e){t.set(e.name,!0)}),this.variables.each(function(e,n){t.set(n,!0)})),t}),AST_Scope.DEFMETHOD("make_var",function(e,n,t){for(var i=[this],r=(n instanceof AST_SymbolDeclaration&&n.definition().references.forEach(function(e){var n=e.scope;do{if(!push_uniq(i,n))return}while((n=n.parent_scope)&&n!==this)}),t=t.replace(/^[^a-z_$]|[^a-z0-9_$]/gi,"_")),o=0;!all(i,function(e){return!e.var_names().has(r)});o++)r=t+"$"+o;var e=ke(e,n,{name:r,scope:this}),a=this.def_variable(e);return i.forEach(function(e){e.enclosed.push(a),e.var_names().set(r,!0)}),e}),AST_Scope.DEFMETHOD("hoist_properties",function(r){var f,o,c,l;function u(e,n,t){var i;return!(e instanceof AST_Symbol)||(i=e.definition()).assignments!=t||i.references.length-i.replaced==t||i.single_use||f.find_variable(e.name)!==i||o(i)||e.fixed_value()!==n||(t=e.fixed||i.fixed).direct_access?void 0:(!t.escaped||1!=t.escaped.depth)&&n instanceof AST_Object&&0<n.properties.length&&be(e,r)&&all(n.properties,function(e){return st(e)&&"__proto__"!==e.key})}!r.option("hoist_props")||r.has_directive("use asm")||(f=this,is_arrow(f)&&f.value)||(o=f instanceof AST_Toplevel&&r.top_retain||return_false,c=Object.create(null),l=new TreeTransformer(function(t,e){if(t instanceof AST_Assign){if("="!=t.operator)return;if(!t.write_only)return;if(!u(t.left,t.right,1))return;e(t,l);var i=new Dictionary,r=[],o=[];return t.right.properties.forEach(function(e){var n=s(AST_SymbolVar,t.left,e.key),n=(o.push(ke(AST_VarDef,t,{name:n,value:null})),ke(AST_SymbolRef,t,{name:n.name,scope:f,thedef:n.definition()}));n.reference(),r.push(ke(AST_Assign,t,{operator:"=",left:n,right:e.value}))}),i.value=t.right,c[t.left.definition().id]=i,f.body.splice(f.body.indexOf(l.stack[1])+1,0,ke(AST_Var,t,{definitions:o})),we(t,r)}var n,a;if(t instanceof AST_Scope)return t===f||"Call"==(a=l.parent()).TYPE&&a.expression===t?void 0:t;if(t instanceof AST_VarDef&&u(t.name,t.value,0))return e(t,l),i=new Dictionary,n=[],(a=t.clone()).value=t.name instanceof AST_SymbolConst?ke(AST_Number,t,{value:0}):null,n.push(a),t.value.properties.forEach(function(e){n.push(ke(AST_VarDef,t,{name:s(t.name.CTOR,t.name,e.key),value:e.value}))}),i.value=t.value,c[t.name.definition().id]=i,List.splice(n);function s(e,n,t){e=f.make_var(e,n,n.name+"_"+t);return i.set(t,e.definition()),e}}),f.transform(l),f.transform(new TreeTransformer(function(e,n){var t;if(e instanceof AST_PropAccess)return!(e.expression instanceof AST_SymbolRef&&(i=c[e.expression.definition().id])&&e.expression.fixed_value()===i.value)?void 0:(t=i.get(e.get_property()),(t=ke(AST_SymbolRef,e,{name:t.name,scope:e.expression.scope,thedef:t})).reference(),t);if(e instanceof AST_SymbolRef){var i=c[e.definition().id];if(i&&e.fixed_value()===i.value)return ke(AST_Object,e,{properties:[]})}})))}),(n=function(e,n){e.DEFMETHOD("drop_side_effect_free",n)})(AST_Node,return_this),n(AST_Accessor,return_null),n(AST_Array,function(e,n){e=_(this.elements,e,n,Dn);return e?e===this.elements&&all(e,function(e){return e instanceof AST_Spread})?this:we(this,e.map(En)):null}),n(AST_Assign,function(e){var n=this.left;if(n instanceof AST_PropAccess){var t=n.expression;if(t.may_throw_on_access(e,!0))return this;if(e.has_directive("use strict")&&t.is_constant())return this}return!n.has_side_effects(e)&&!Ne[this.operator.slice(0,-1)]&&(this.write_only=!0,root_expr(n).is_constant_expression(e.find_parent(AST_Scope)))?this.right.drop_side_effect_free(e):this}),n(AST_Await,function(e){if(!e.option("awaits"))return this;var n=this.expression;if(!h(e,n))return this;var t=(n=n instanceof AST_UnaryPrefix&&"!"==n.operator?n.expression:n).drop_side_effect_free(e);if(t===n)return this;t?h(e,t)||(t=t.negate(e)):t=ke(AST_Number,n,{value:0});e=this.clone();return e.expression=t,e}),n(AST_Binary,function(e,n){var t,i,r,o,a=this.left,s=this.right,f=this.operator;return Gn(this,e)?(t=s.drop_side_effect_free(e,n))?Ne[f]&&t.has_side_effects(e)?(i=this,t!==s&&((i=i.clone()).right=t.drop_side_effect_free(e)),"??"==f?i:((s=i.clone()).operator="&&"==f?"||":"&&",s.left=a.negate(e,n),(r=s.right.tail_node())instanceof AST_Binary&&s.operator==r.operator&&Jn(s),r=n?Ie:Y,"&&"==f?r(i,s):r(s,i))):(o=a.drop_side_effect_free(e,n))?(t=t.drop_side_effect_free(e))?we(this,[o,t]):o:t:a.drop_side_effect_free(e,n):(o=a.drop_side_effect_free(e,n))===a?this:(i=this.clone(),o?i.left=o:"instanceof"!=f||a.is_constant()?i.left=ke(AST_Number,a,{value:0}):i.left=ke(AST_Array,a,{elements:[]}),i)}),n(AST_Call,function(e,n){var t=this;if(t.is_expr_pure(e))return t.pure&&AST_Node.warn("Dropping __PURE__ call [{start}]",t),(i=_(t.args,e,n,Dn))&&we(t,i.map(En));var i=t.expression;if(t.is_call_pure(e))return(f=t.args.slice()).unshift(i.expression),(f=_(f,e,n,Dn))&&we(t,f.map(En));if(e.option("yields")&&is_generator(i)&&kn(i,e))return(s=t.clone()).expression=ke(AST_Function,i),s.expression.body=[],s;var r,o,a,s=wn(e,i);if(s&&((t=t.clone()).expression=s,i._squeezed)&&(t.expression._squeezed=!0),t instanceof AST_New){var f,s=i;if((s=s instanceof AST_SymbolRef?s.fixed_value():s)instanceof AST_Lambda){if(o=e,(r=s).new=!0,a=all(r.body,function(e){return!e.has_side_effects(o)})&&all(r.argnames,function(e){return!e.match_symbol(return_false)})&&!(r.rest&&r.rest.match_symbol(return_false)),r.new=!1,a)return(f=t.args.slice()).unshift(i),(f=_(f,e,n,Dn))&&we(t,f.map(En));s.contains_this()||((t=ke(AST_Call,t)).expression=t.expression.clone(),t.args=t.args.slice())}}return t.call_only=!0,t}),n(AST_ClassExpression,function(e,n){for(var t=this,i=[],r=[],o=0,a=t.properties,s=0;s<a.length;s++){var f=a[s];if(f.key instanceof AST_Node&&i.push(f.key),he(f)){var c=f.value;if(c.has_side_effects(e)){if(c.contains_this())return t;f instanceof AST_ClassInit?(o++,r.push(f)):r.push(c)}}}var l=t.extends;if(!l||(l=!Re(l=l instanceof AST_SymbolRef?l.fixed_value():l))||i.unshift(t.extends),i=_(i,e,n),r=_(r,e,n=i?!1:n),!i){if(!l&&!r&&!t.name)return null;i=[]}return l||t.name||!e.has_directive("use strict")?(n=mn(t),l||(n.extends=null),n.properties=[],r?r.length==o?(i.length&&r.unshift(ke(AST_ClassField,t,{key:we(t,i),value:null})),n.properties=r):n.properties.push(ke(AST_ClassField,t,{static:!0,key:i.length?we(t,i):"c",value:u()})):i.length&&n.properties.push(ke(AST_ClassMethod,t,{key:we(t,i),value:ke(AST_Function,t,{argnames:[],body:[]}).init_vars(n)})),n):(r&&i.push(ke(AST_Call,t,{expression:ke(AST_Arrow,t,{argnames:[],body:[],value:u()}).init_vars(t.parent_scope,t),args:[]})),we(t,i));function u(){return we(t,r.map(function(e){var n;return e instanceof AST_ClassInit?((n=ke(AST_Arrow,e.value)).argnames=[],ke(AST_Call,e,{expression:n,args:[]})):e}))}}),n(AST_Conditional,function(e){var n,t,i=this.consequent.drop_side_effect_free(e),r=this.alternative.drop_side_effect_free(e);return i===this.consequent&&r===this.alternative?this:(e.option("ie")&&(n=[],i instanceof AST_Function&&(n.push(i),i=null),r instanceof AST_Function)&&(n.push(r),r=null),i?r?((t=this.clone()).consequent=i,t.alternative=r):t=ke(AST_Binary,this,{operator:"&&",left:this.condition,right:i}):t=r?ke(AST_Binary,this,{operator:"||",left:this.condition,right:r}):this.condition.drop_side_effect_free(e),n?(t&&n.push(t),0==n.length?null:we(this,n)):t)}),n(AST_Constant,return_null),n(AST_Dot,function(e,n){var t=this.expression;return t.may_throw_on_access(e)?this:t.drop_side_effect_free(e,n)}),n(AST_Function,function(e){return kn(this,e)?null:this}),n(AST_LambdaExpression,return_null),n(AST_Object,function(e,n){var t=[],e=(this.properties.forEach(function(e){e instanceof AST_Spread?t.push(e):(e.key instanceof AST_Node&&t.push(e.key),t.push(e.value))}),_(t,e,n,function(e,n,t){var i=e.expression;return i.safe_to_spread()?i.drop_side_effect_free(n,t):e}));return e?e!==t||all(e,function(e){return!(e instanceof AST_Spread)})?we(this,e.map(function(e){return e instanceof AST_Spread?ke(AST_Object,e,{properties:[e]}):e})):this:null}),n(AST_ObjectIdentity,return_null),n(AST_Sequence,function(e,n){var t,i,r,o=_(this.expressions,e,n);return o?(t=o[r=o.length-1],e.option("awaits")&&0<r&&t instanceof AST_Await&&t.expression.is_constant()&&(i=(o=o.slice(0,-1))[--r],t.expression=h(e,i)?i:i.negate(e),o[r]=t),e.option("conditionals")&&0<r&&(i=o[r-1])instanceof AST_Assign&&"="==i.operator&&(r=i.left)instanceof AST_SymbolRef&&(r=In(e,r.definition(),i.right,t))&&((i=i.clone()).right=r,(o=o.slice(0,-2)).push(i.drop_side_effect_free(e,n))),o===this.expressions?this:we(this,o)):null}),n(AST_Sub,function(e,n){var t,i=this.expression;return i.may_throw_on_access(e)?this:(t=this.property,(i=i.drop_side_effect_free(e,n))?(t=t.drop_side_effect_free(e))?we(this,[i,t]):i:t.drop_side_effect_free(e,n))}),n(AST_SymbolRef,function(e){return this.is_declared(e)&&be(this,e)?null:this}),n(AST_Template,function(e,n){var t,i=this;return i.is_expr_pure(e)?0==(t=i.expressions).length?null:we(i,t).drop_side_effect_free(e,n):((n=wn(e,t=i.tag))&&((i=i.clone()).tag=n,t._squeezed)&&(i.tag._squeezed=!0),i)}),n(AST_Unary,function(e,n){var t,i=this.expression;return unary_side_effects[this.operator]?(this.write_only=!i.has_side_effects(e),this):"typeof"==this.operator&&i instanceof AST_SymbolRef&&be(i,e)?null:(t=i.drop_side_effect_free(e,n),n&&t&&le(t)?t===i&&"!"==this.operator?this:t.negate(e,n):t)}),e(AST_SimpleStatement,function(e,n){if(n.option("side_effects")){var t=e.body,n=t.drop_side_effect_free(n,!0);if(!n)return AST_Node.warn("Dropping side-effect-free statement [{start}]",e),ke(AST_EmptyStatement,e);if(n!==t)return ke(AST_SimpleStatement,e,{body:n})}return e}),e(AST_While,function(e,n){return n.option("loops")?ke(AST_For,e).optimize(n):e}),e(AST_Do,function(t,e){if(!e.option("loops"))return t;var n=N(e,t.condition);if(!(n instanceof AST_Node)){if(n&&!Cn(t,e.parent(),AST_Continue))return ke(AST_For,t,{body:ke(AST_BlockStatement,t.body,{body:[t.body,ke(AST_SimpleStatement,t.condition,{body:t.condition})]})}).optimize(e);if(!Cn(t,e.parent()))return ke(AST_BlockStatement,t.body,{body:[t.body,ke(AST_SimpleStatement,t.condition,{body:t.condition})]}).optimize(e)}if(t.body instanceof AST_BlockStatement&&!Cn(t,e.parent(),AST_Continue)){for(var i=t.body.body,r=i.length;0<=--r;){var o=i[r];if(o instanceof AST_If&&!o.alternative&&o.body instanceof AST_Break&&e.loopcontrol_target(o.body)===t){if(a(o.condition))break;t.condition=ke(AST_Binary,t,{operator:"&&",left:o.condition.negate(e),right:t.condition}),i.splice(r,1)}else if(o instanceof AST_SimpleStatement){if(a(o.body))break;t.condition=we(t,[o.body,t.condition]),i.splice(r,1)}else if(!F(o,!0))break}t.body=pn(t.body,e.parent())}return t.body instanceof AST_EmptyStatement?ke(AST_For,t).optimize(e):t.body instanceof AST_SimpleStatement?ke(AST_For,t,{condition:we(t.condition,[t.body.body,t.condition]),body:ke(AST_EmptyStatement,t)}).optimize(e):t;function a(e){var n=!1;return e.walk(new TreeWalker(function(e){return!!n||(e instanceof AST_SymbolRef?(member(e.definition(),t.enclosed)||(n=!0),!0):void 0)})),n}}),e(AST_For,function(e,n){if(!n.option("loops"))return e;if(n.option("side_effects")&&(e.init&&(e.init=e.init.drop_side_effect_free(n)),e.step)&&(e.step=e.step.drop_side_effect_free(n)),e.condition){var t=N(n,e.condition);if(t)t instanceof AST_Node||(e.body=ke(AST_BlockStatement,e.body,{body:[ke(AST_SimpleStatement,e.condition,{body:e.condition}),e.body]}),e.condition=null);else if(n.option("dead_code"))return t=[],is_statement(e.init)?t.push(e.init):e.init&&t.push(ke(AST_SimpleStatement,e.init,{body:e.init})),t.push(ke(AST_SimpleStatement,e.condition,{body:e.condition})),C(n,e.body,t),ke(AST_BlockStatement,e,{body:t}).optimize(n)}return function n(t,i){var e=a(t.body);if(i.option("dead_code")&&(e instanceof AST_Break||e instanceof AST_Continue&&s(e)||e instanceof AST_Exit))return r=[],is_statement(t.init)?r.push(t.init):t.init&&r.push(ke(AST_SimpleStatement,t.init,{body:t.init})),o=s(e)||e instanceof AST_Exit,t.condition&&o?r.push(ke(AST_If,t,{condition:t.condition,body:e,alternative:null})):t.condition?r.push(ke(AST_SimpleStatement,t.condition,{body:t.condition})):o&&r.push(e),C(i,t.body,r),ke(AST_BlockStatement,t,{body:r});if(e instanceof AST_If){var r,o=a(e.body);if(o instanceof AST_Break&&!s(o))return t.condition?t.condition=ke(AST_Binary,t.condition,{left:t.condition,operator:"&&",right:e.condition.negate(i)}):t.condition=e.condition.negate(i),r=se(e.alternative),C(i,e.body,r),f(r);if((o=a(e.alternative))instanceof AST_Break&&!s(o))return t.condition?t.condition=ke(AST_Binary,t.condition,{left:t.condition,operator:"&&",right:e.condition}):t.condition=e.condition,r=se(e.body),C(i,e.alternative,r),f(r)}return t;function a(e){return e instanceof AST_BlockStatement?e.body[0]:e}function s(e){return i.loopcontrol_target(e)!==i.self()}function f(e){return t.body instanceof AST_BlockStatement?(t.body=t.body.clone(),t.body.body=e.concat(t.body.body.slice(1)),t.body=t.body.transform(i)):t.body=ke(AST_BlockStatement,t.body,{body:e}).transform(i),n(t,i)}}(e,n)}),e(AST_ForEnumeration,function(e,n){var t;return n.option("varify")&&oe(e.init)&&(t=e.init.definitions[0].name,(n.option("module")||t instanceof AST_Destructured||t instanceof AST_SymbolLet)&&!t.match_symbol(function(e){if(e instanceof AST_SymbolDeclaration)return!Zn(e=e.definition())||Bn(n,e)},!0)?e.init=Fn(e.init,e.resolve()):e.init.can_letify(n,!0)&&(e.init=Pn(e.init,e))),e}),e(AST_If,function(e,c){if(ee(e.alternative)&&(e.alternative=null),c.option("conditionals")){if(c.option("booleans")&&!e.condition.has_side_effects(c)&&Nn(c,e.condition),c.option("dead_code")){var n=N(c,e.condition);if(!n)return AST_Node.warn("Condition always false [{start}]",e.condition),p=[ke(AST_SimpleStatement,e.condition,{body:e.condition}).transform(c)],C(c,e.body,p),e.alternative&&p.push(e.alternative),ke(AST_BlockStatement,e,{body:p}).optimize(c);if(!(n instanceof AST_Node))return AST_Node.warn("Condition always true [{start}]",e.condition),p=[ke(AST_SimpleStatement,e.condition,{body:e.condition}).transform(c),e.body],e.alternative&&C(c,e.alternative,p),ke(AST_BlockStatement,e,{body:p}).optimize(c)}var n=e.condition.negate(c),t=e.condition.print_to_string().length,i=n.print_to_string().length,r=i<t,o=(e.alternative&&r&&(r=!1,e.condition=n,o=e.body,e.body=e.alternative,e.alternative=ee(o)?null:o),[]),a=[],s=[],f=E(e.body,o,a,s),l=[],u=[],_=[],S=E(e.alternative,l,u,_);if(f instanceof AST_BlockStatement||S instanceof AST_BlockStatement){var p=[],d=[];if(f&&([].push.apply(p,o),[].push.apply(d,a),f instanceof AST_BlockStatement?e.body=f:0==f.length?e.body=ke(AST_EmptyStatement,e.body):e.body=ke(AST_SimpleStatement,e.body,{body:we(e.body,f)}),s.forEach(X)),S&&([].push.apply(p,l),[].push.apply(d,u),S instanceof AST_BlockStatement?e.alternative=S:0==S.length?e.alternative=null:e.alternative=ke(AST_SimpleStatement,e.alternative,{body:we(e.alternative,S)}),_.forEach(X)),0<d.length&&p.push(ke(AST_Var,e,{definitions:d})),0<p.length)return p.push(e.transform(c)),ke(AST_BlockStatement,e,{body:p}).optimize(c)}else if(f&&S)return p=o.concat(l),(0<a.length||0<u.length)&&p.push(ke(AST_Var,e,{definitions:a.concat(u)})),0==f.length?p.push(ke(AST_SimpleStatement,e.condition,{body:0<S.length?ke(AST_Binary,e,{operator:"||",left:e.condition,right:we(e.alternative,S)}).transform(c):e.condition.clone()}).optimize(c)):0==S.length?(t===i&&!r&&e.condition instanceof AST_Binary&&"||"==e.condition.operator&&(r=!0),p.push(ke(AST_SimpleStatement,e,{body:ke(AST_Binary,e,{operator:r?"||":"&&",left:r?n:e.condition,right:we(e.body,f)}).transform(c)}).optimize(c))):p.push(ke(AST_SimpleStatement,e,{body:ke(AST_Conditional,e,{condition:e.condition,consequent:we(e.body,f),alternative:we(e.alternative,S)})}).optimize(c)),s.forEach(X),_.forEach(X),ke(AST_BlockStatement,e,{body:p}).optimize(c);if((e=ee(e.body)?ke(AST_If,e,{condition:n,body:e.alternative,alternative:null}):e).alternative instanceof AST_Exit&&e.body.TYPE==e.alternative.TYPE){d=e.body.value,o=e.alternative.value;if(!d&&!o)return ke(AST_BlockStatement,e,{body:[ke(AST_SimpleStatement,e,{body:e.condition}),e.body]}).optimize(c);if(d&&o||!function(){var e=!1,n=0,t=c.self();do{if(t instanceof AST_Catch)c.parent(n).bfinally&&(e=!0),n++;else if(t instanceof AST_Finally)n++;else{if(t instanceof AST_Scope)return e&&B(t);t instanceof AST_Try&&t.bfinally&&(e=!0)}}while(t=c.parent(n++))}())return(l=ke(e.body.CTOR,e,{value:ke(AST_Conditional,e,{condition:e.condition,consequent:d||ke(AST_Undefined,e.body).transform(c),alternative:o||ke(AST_Undefined,e.alternative).transform(c)})}))instanceof AST_Return&&(l.in_bool=e.body.in_bool||e.alternative.in_bool),l}if(q((e=e.body instanceof AST_If&&!e.body.alternative&&!e.alternative?ke(AST_If,e,{condition:ke(AST_Binary,e.condition,{operator:"&&",left:e.condition,right:e.body.condition}),body:e.body.body,alternative:null}):e).body)&&e.alternative)return a=e.alternative,e.alternative=null,ke(AST_BlockStatement,e,{body:[e,a]}).optimize(c);if(q(e.alternative))return p=e.body,e.body=e.alternative,e.condition=r?n:e.condition.negate(c),e.alternative=null,ke(AST_BlockStatement,e,{body:[e,p]}).optimize(c);if(e.alternative){for(var A=k(e.body),T=w(A),h=k(e.alternative),m=w(h),v=[];0<=T&&0<=m;){var y=A[T],g=h[m];if(y.equals(g))A.splice(T--,1),h.splice(m--,1),v.unshift(P(y,g));else{if(!(y instanceof AST_SimpleStatement))break;if(!(g instanceof AST_SimpleStatement))break;var b=y.body.tail_node(),x=g.body.tail_node();if(!b.equals(x))break;T=D(A,y.body,T),m=D(h,g.body,m),v.unshift(ke(AST_SimpleStatement,b,{body:P(b,x)}))}}if(0<v.length)return e.body=0<A.length?ke(AST_BlockStatement,e,{body:A}):ke(AST_EmptyStatement,e),e.alternative=0<h.length?ke(AST_BlockStatement,e,{body:h}):null,v.unshift(e),ke(AST_BlockStatement,e,{body:v}).optimize(c)}c.option("typeofs")&&z(e.condition,e.body,e.alternative)}return e;function k(e){return e instanceof AST_BlockStatement?e.body:[e]}function w(e){for(var n=e.length;0<=--n&&F(e[n],!0););return n}function D(e,n,t){return n instanceof AST_Sequence?e[t]=ke(AST_SimpleStatement,n,{body:we(n,n.expressions.slice(0,-1))}):e.splice(t--,1),t}function E(e,n,t,i){if(null==e)return[];if(e instanceof AST_BlockStatement){for(var r=[],o=0;o<e.body.length;o++){var a=e.body[o];if(!(a instanceof AST_EmptyStatement)){if(a instanceof AST_Exit){if(0==o)return;0<r.length&&(a=a.clone(),r.push(a.value||ke(AST_Undefined,a).transform(c)),a.value=we(e,r));var s=e.clone();return s.body=s.body.slice(o+1),s.body.unshift(a),s}if(a instanceof AST_LambdaDefinition)n.push(a);else if(a instanceof AST_SimpleStatement){if(!c.option("sequences")&&0<r.length)return;r.push(a.body)}else{if(!(a instanceof AST_Var))return;if(!c.option("sequences")&&0<r.length)return;a.remove_initializers(c,t),a.definitions.forEach(f)}}}return r}return e instanceof AST_LambdaDefinition?(n.push(e),[]):e instanceof AST_EmptyStatement?[]:e instanceof AST_SimpleStatement?[e.body]:e instanceof AST_Var?(r=[],e.remove_initializers(c,t),e.definitions.forEach(f),r):void 0;function f(e){e.value&&r.push(ke(AST_Assign,e,{operator:"=",left:e.name.convert_symbol(AST_SymbolRef,function(e){i.push(e)}),right:e.value}))}}}),e(AST_Switch,function(i,t){if(t.option("switches")&&t.option("dead_code")){for(var e,n,r,o=[],a=[],s=[],f=0,c=i.body.length;f<c;f++){if((e=i.body[f])instanceof AST_Default){var l=o[o.length-1];if(n||v(e.body[0],t)&&(!l||q(l))){g(e,l);continue}n=e}else{var u=e.expression,_=ke(AST_Binary,i,{operator:"===",left:i.expression,right:u}).evaluate(t,!0);if(!_){u.has_side_effects(t)&&s.push(u),g(e,o[o.length-1]);continue}if(!(_ instanceof AST_Node))for(n&&(_=o.indexOf(n),o.splice(_,1),g(n,o[_-1]),n=null),u.has_side_effects(t)?r=e:n=e=ke(AST_Default,e);++f<c;)g(i.body[f],e)}if(c<=f+1||q(e)){var S,l=o[o.length-1],p=e.body;if(q(l))switch(l.body.length-p.length){case 1:if(!v(S=l.body[l.body.length-1],t))break;p=p.concat(S);case 0:var d=ke(AST_BlockStatement,l),A=ke(AST_BlockStatement,e,{body:p});d.equals(A)&&(l.body=[])}}s.length&&(e instanceof AST_Default?o.push(ke(AST_Case,i,{expression:we(i,s),body:[]})):(s.push(e.expression),e.expression=we(i,s)),s=[]),o.push(e)}for(s.length&&!r&&o.push(ke(AST_Case,i,{expression:we(i,s),body:[]}));e=o[o.length-1];){if(v(S=e.body[e.body.length-1],t)&&e.body.pop(),e===n){if(!fe(e))break}else{if(e.expression.has_side_effects(t))break;if(n){if(!fe(n))break;if(o[o.length-2]!==n)break;n.body=n.body.concat(e.body),e.body=[]}else if(!fe(e))break}g(e),o.pop()===n&&(n=null)}if(!e)return a.push(ke(AST_SimpleStatement,i.expression,{body:i.expression})),s.length&&a.push(ke(AST_SimpleStatement,i,{body:we(i,s)})),ke(AST_BlockStatement,i,{body:a}).optimize(t);if(e===n)for(;(e=o[o.length-2])&&!(e instanceof AST_Default)&&fe(e);){if((u=e.expression).has_side_effects(t)){if((l=o[o.length-3])&&!q(l))break;n.body.unshift(ke(AST_SimpleStatement,i,{body:u}))}g(e),o.splice(-2,1)}if(o[0].body=a.concat(o[0].body),i.body=o,t.option("conditionals"))switch(o.length){case 1:if(y(o[0]))return u=o[0].expression,p=o[0].body.slice(),(o[0]!==n&&o[0]!==r?ke(AST_If,i,{condition:ke(AST_Binary,i,{operator:"===",left:i.expression,right:u}),body:ke(AST_BlockStatement,i,{body:p}),alternative:null}):(u&&p.unshift(ke(AST_SimpleStatement,u,{body:u})),p.unshift(ke(AST_SimpleStatement,i.expression,{body:i.expression})),ke(AST_BlockStatement,i,{body:p}))).optimize(t);break;case 2:if(member(n,o)&&y(o[1])){var T,h,m=(p=o[0].body.slice()).length&&v(p[p.length-1],t);if(m&&p.pop(),all(p,y))return T=o[1].body.length&&ke(AST_BlockStatement,o[1]),h=ke(AST_If,i,{condition:ke(AST_Binary,i,o[0]===n?{operator:"!==",left:i.expression,right:o[1].expression}:{operator:"===",left:i.expression,right:o[0].expression}),body:ke(AST_BlockStatement,o[0],{body:p}),alternative:m&&T||null}),(h=!m&&T?ke(AST_BlockStatement,i,{body:[h,T]}):h).optimize(t)}}}return i;function v(e,n){return e instanceof AST_Break&&n.loopcontrol_target(e)===i}function y(e){var n=!1,t=new TreeWalker(function(e){if(n||e instanceof AST_Lambda||e instanceof AST_SimpleStatement)return!0;v(e,t)&&(n=!0)});return t.push(i),e.walk(t),!n}function g(e,n){n&&!q(n)?n.body=n.body.concat(e.body):C(t,e,a)}}),e(AST_Try,function(e,n){if(e.body=me(e.body,n),n.option("dead_code")){if(fe(e)&&!(e.bcatch&&e.bcatch.argname&&e.bcatch.argname.match_symbol(function(e){return e instanceof AST_SymbolCatch&&!be(e)},!0)))return t=[],e.bcatch&&(C(n,e.bcatch,t),t.forEach(function(e){e instanceof AST_Var&&e.definitions.forEach(function(e){var n=e.name.definition().redefined();n&&(e.name=e.name.clone(),e.name.thedef=n)})})),t.unshift(ke(AST_BlockStatement,e).optimize(n)),e.bfinally&&t.push(ke(AST_BlockStatement,e.bfinally).optimize(n)),ke(AST_BlockStatement,e,{body:t}).optimize(n);if(e.bfinally&&fe(e.bfinally)){var t=ke(AST_BlockStatement,e.bfinally).optimize(n);if(t=e.body.concat(t),!e.bcatch)return ke(AST_BlockStatement,e,{body:t}).optimize(n);e.body=t,e.bfinally=null}}return e}),AST_Const.DEFMETHOD("remove_initializers",Rn(function(e,n){return ke(AST_Undefined,n).optimize(e)})),AST_Let.DEFMETHOD("remove_initializers",Rn(return_null)),AST_Var.DEFMETHOD("remove_initializers",Rn(return_null)),AST_Definitions.DEFMETHOD("to_assignments",function(){var e=this.definitions.reduce(function(e,t){var n,i,r,o=t.name.definition(),a=t.value;return a&&(a instanceof AST_Sequence&&(a=a.clone()),n=ke(AST_SymbolRef,t.name),i=ke(AST_Assign,t,{operator:"=",left:n,right:a}),e.push(i),(r=function(){return i.right}).assigns=[i],r.direct_access=o.direct_access,r.escaped=o.escaped,n.fixed=r,o.references.forEach(function(e){var n;e.fixed&&(n=e.fixed.assigns)&&n[0]===t&&(1<n.length||e.fixed.to_binary||e.fixed.to_prefix?n[0]=i:(e.fixed=r,o.fixed===e.fixed&&(o.fixed=r)))}),o.references.push(n),o.assignments++),o.eliminated++,e},[]);return 0==e.length?null:we(this,e)}),(n=function(e,n){e.DEFMETHOD("can_letify",n)})(AST_Node,return_false),n(AST_Const,function(e,n){n=n?1:0;var t=this.definitions;return!(!e.option("module")&&all(t,function(e){return e.name instanceof AST_SymbolConst}))&&all(t,function(e){return!e.name.match_symbol(function(e){if(e instanceof AST_SymbolDeclaration)return e.definition().assignments!=n},!0)})}),n(AST_Var,function(i){return all(this.definitions,function(e){return!e.name.match_symbol(function(e){var n,t;return e instanceof AST_SymbolDeclaration&&((n=e.definition()).first_decl!==e||!qn(i,e)||!((t=e.scope)instanceof AST_Scope||all(n.references,function(e){var n=e.scope;do{if(n===t)return!0}while(n=n.parent_scope);return!1})))},!0)})}),AST_Definitions.DEFMETHOD("can_varify",function(n){return all(this.definitions,function(e){return!e.name.match_symbol(function(e){if(e instanceof AST_SymbolDeclaration)return!qn(n,e)},!0)})}),e(AST_Const,function(e,n){return n.option("varify")?e.can_varify(n)?Fn(e,n.find_parent(AST_Scope)):e.can_letify(n)?Pn(e,xe(n)):e:e}),e(AST_Let,function(e,n){return n.option("varify")&&e.can_varify(n)?Fn(e,n.find_parent(AST_Scope)):e}),e(AST_Call,function(_,c){var o=_.expression,e=zn(_,c);if(e)return e;if(c.option("sequences"))if(o instanceof AST_PropAccess){if((m=G(o))!==o)return(v=_.clone()).expression=m.expressions.pop(),m.expressions.push(v),m.optimize(c)}else if(!ie(o.tail_node()))if((m=G(_))!==_)return m.optimize(c);if(c.option("unused")&&Un(_,c),c.option("unsafe"))if(Ee(o))switch(o.name){case"Array":if(1==_.args.length){if((s=_.args[0])instanceof AST_Number)try{var n=s.value;if(6<n)break;for(var t=Array(n),i=0;i<n;i++)t[i]=ke(AST_Hole,_);return ke(AST_Array,_,{elements:t})}catch(e){AST_Node.warn("Invalid array length: {length} [{start}]",{length:n,start:_.start});break}if(!s.is_boolean(c)&&!s.is_string(c))break}return ke(AST_Array,_,{elements:_.args});case"Object":if(0==_.args.length)return ke(AST_Object,_,{properties:[]});break;case"String":if(0==_.args.length)return ke(AST_String,_,{value:""});if(1==_.args.length)return ke(AST_Binary,_,{operator:"+",left:ke(AST_String,_,{value:""}),right:_.args[0]}).optimize(c);break;case"Number":if(0==_.args.length)return ke(AST_Number,_,{value:0});if(1==_.args.length)return ke(AST_UnaryPrefix,_,{operator:"+",expression:ke(AST_Binary,_,{operator:"+",left:ke(AST_String,_,{value:""}),right:_.args[0]})}).optimize(c);break;case"Boolean":if(0==_.args.length)return ke(AST_False,_).optimize(c);if(1==_.args.length)return ke(AST_UnaryPrefix,_,{operator:"!",expression:ke(AST_UnaryPrefix,_,{operator:"!",expression:_.args[0]})}).optimize(c);break;case"RegExp":var q=[];if(all(_.args,function(e){var n=e.evaluate(c);return q.unshift(n),e!==n}))try{return Me(c,_,ke(AST_RegExp,_,{value:RegExp.apply(RegExp,q)}))}catch(e){AST_Node.warn("Error converting {this} [{start}]",_)}}else if(o instanceof AST_Dot)switch(o.property){case"toString":var r=o.expression;if(0!=_.args.length||r.may_throw_on_access(c)||r instanceof AST_Super)break;return ke(AST_Binary,_,{operator:"+",left:ke(AST_String,_,{value:""}),right:r}).optimize(c);case"join":if(o.expression instanceof AST_Array&&_.args.length<2)e:{var a=_.args[0];if(0==o.expression.elements.length&&!(a instanceof AST_Spread))return a?we(_,[a,ke(AST_String,_,{value:""})]).optimize(c):ke(AST_String,_,{value:""});if(!(a&&(a=a.evaluate(c))instanceof AST_Node)){for(var s,t=[],f=[],i=0;i<o.expression.elements.length;i++){var l=o.expression.elements[i];if((x=l.evaluate(c))!==l)f.push(x);else{if(l instanceof AST_Spread)break e;0<f.length&&(t.push(ke(AST_String,_,{value:f.join(a)})),f.length=0),t.push(l)}}return(0<f.length&&t.push(ke(AST_String,_,{value:f.join(a)})),1==t.length)?t[0].is_string(c)?t[0]:ke(AST_Binary,t[0],{operator:"+",left:ke(AST_String,_,{value:""}),right:t[0]}):""==a?(s=t[0].is_string(c)||t[1].is_string(c)?t.shift():ke(AST_String,_,{value:""}),t.reduce(function(e,n){return ke(AST_Binary,n,{operator:"+",left:e,right:n})},s).optimize(c)):((B=_.clone()).expression=B.expression.clone(),B.expression.expression=B.expression.expression.clone(),B.expression.expression.elements=t,Me(c,_,B))}}break;case"charAt":if(_.args.length<2)return(B=ke(AST_Binary,_,{operator:"||",left:ke(AST_Sub,_,{expression:o.expression,property:_.args.length?ke(AST_Binary,_.args[0],{operator:"|",left:ke(AST_Number,_,{value:0}),right:_.args[0]}):ke(AST_Number,_,{value:0})}).optimize(c),right:ke(AST_String,_,{value:""})})).is_string=return_true,B.optimize(c);break;case"apply":if(2==_.args.length&&_.args[1]instanceof AST_Array)return(R=_.args[1].elements.slice()).unshift(_.args[0]),ke(AST_Call,_,{expression:ke(AST_Dot,o,{expression:o.expression,property:"call"}),args:R}).optimize(c);break;case"call":r=o.expression;if((r=r instanceof AST_SymbolRef?r.fixed_value():r)instanceof AST_Lambda&&!r.contains_this())return(_.args.length?we(_,[_.args[0],ke(AST_Call,_,{expression:o.expression,args:_.args.slice(1)})]):ke(AST_Call,_,{expression:o.expression,args:[]})).optimize(c)}else if(c.option("side_effects")&&o instanceof AST_Call&&1==o.args.length&&Ee(o.expression)&&"Object"==o.expression.name)return(v=_.clone()).expression=De(_,o,o.args[0]),v.optimize(c);if(c.option("unsafe_Function")&&Ee(o)&&"Function"==o.name){if(0==_.args.length)return ke(AST_Function,_,{argnames:[],body:[]}).init_vars(o.scope);if(all(_.args,function(e){return e instanceof AST_String}))try{var u,S="n(function("+_.args.slice(0,-1).map(function(e){return e.value}).join()+"){"+_.args[_.args.length-1].value+"})",p=parse(S),d={ie:c.option("ie")},A=(p.figure_out_scope(d),new Compressor(c.options)),S=((p=p.transform(A)).figure_out_scope(d),p.compute_char_frequency(d),p.mangle_names(d),p.walk(new TreeWalker(function(e){return!!u||(e instanceof AST_Lambda?(u=e,!0):void 0)})),OutputStream());return AST_BlockStatement.prototype._codegen.call(u,S),_.args=[ke(AST_String,_,{value:u.argnames.map(function(e){return e.print_to_string()}).join()}),ke(AST_String,_.args[_.args.length-1],{value:S.get().replace(/^\{|\}$/g,"")})],_}catch(e){if(!(e instanceof JS_Parse_Error))throw e;AST_Node.warn("Error parsing code passed to new Function [{start}]",_.args[_.args.length-1]),AST_Node.warn(e.toString())}}var T=o instanceof AST_SymbolRef?o.fixed_value():o,e=c.parent(),h=c.self(),m=T instanceof AST_Lambda&&(!is_async(T)||c.option("awaits")&&e instanceof AST_Await)&&(!is_generator(T)||c.option("yields")&&h instanceof AST_Yield&&h.nested),v=m&&T.first_statement(),y=0,g=!1,b=!all(_.args,function(e){return!(e instanceof AST_Spread)}),A=m&&all(T.argnames,function(e,n){if(1==y&&_.args[n]instanceof AST_Spread&&(y=2),e instanceof AST_DefaultValue){if(Ce(1==(y=y||1)&&_.args[n])||(y=2),ct(T,e.value))return!1;e=e.name}return!(e instanceof AST_Destructured&&(g=!0,ct(T,e)))})&&!(T.rest instanceof AST_Destructured&&ct(T,T.rest)),d=A&&c.option("inline")&&!_.is_expr_pure(c)&&(o===T||Vn(T,c));if(d&&v instanceof AST_Return){var x=v.value;if(o===T&&!T.name&&(!x||x.is_constant_expression())&&Ln(T,jn(c)))return we(_,L(x)).optimize(c)}if(m&&!T.contains_this()){var k,w=!1;if(d&&!T.uses_arguments&&!T.pinned()&&!(T.name&&T instanceof AST_LambdaExpression)&&(o===T||!Qn(c,k=o.definition(),T)&&T.is_constant_expression(xe(c)))&&(x=function(e){var n=T.body.length;if(n<2&&(e=I(e)))return e;if(c.option("inline")<3)return!1;e=null;for(var t=0;t<n;t++){var i=T.body[t];if(i instanceof AST_Var){if(w){if(e){if(!(e instanceof AST_SimpleStatement))return!1;W(i)||(e=null)}}else if(!W(i)){if(e&&!(e instanceof AST_SimpleStatement))return!1;w=!(e=null)}}else if(!(i instanceof AST_AsyncDefun||i instanceof AST_Defun||i instanceof AST_EmptyStatement)){if(e)return!1;e=i}}return I(e)}(v))){var D,z,E,C,N=o===T||k.single_use&&k.references.length-k.replaced==1;if(function(){if(!(y||g||b||w||T.rest)&&!(c.option("inline")<2&&T.argnames.length)&&T.variables.all(function(e){return e.references.length-e.replaced<2&&e.orig[0]instanceof AST_SymbolFunarg})){var i,n=c.find_parent(AST_Scope),r=!1,o=jn(c,n),a=[],s=!1,f=new TreeWalker(function(e,n){var t;return!!r||(e instanceof AST_Binary&&Ne[e.operator]||e instanceof AST_Conditional?void(a=null):e instanceof AST_Class?r=!0:e instanceof AST_Destructured?void(s=!0):e instanceof AST_Scope||o&&e instanceof AST_Symbol&&o[e.name]?r=!0:e instanceof AST_SymbolRef?(t=e.definition(),T.variables.get(e.name)!==t?void(a=null):t.init instanceof AST_LambdaDefinition||is_lhs(e,f.parent())?r=!0:(t=M(t),i<t||(i=t),a?void(s?a=null:a.push(T.argnames[t])):void 0)):s?void 0:e instanceof AST_Assign&&e.left instanceof AST_PropAccess?(e.left.expression.walk(f),e.left instanceof AST_Sub&&e.left.property.walk(f),e.right.walk(f),s=!0):e.has_side_effects(c)?(n(),s=!0):void 0)});if(x.walk(f),!r){var e=_.args.length;if(a&&T.argnames.length>=e){for(e=T.argnames.length;e-- >i&&T.argnames[e]===a.pop(););e++}return e<=i||all(_.args.slice(i,e),s&&!a?function(e){return e.is_constant_expression(n)}:function(e){return!e.has_side_effects(c)})}}}()){_._optimized=!0;var p=x.optimize(c).clone(!0),R=_.args.slice(),O=[],p=p.transform(new TreeTransformer(function(e){if(e instanceof AST_SymbolRef){var n=e.definition();if(T.variables.get(e.name)!==n)return O.push(e),e;var n=M(n),t=R[n];if(!t)return ke(AST_Undefined,_);R[n]=null;n=this.parent();return n?De(n,e,t):t}})),S=T.inlined,U=(o!==T&&(T.inlined=!0),[]),B=(R.forEach(function(e){e&&((e=e.clone(!0)).walk(new TreeWalker(function(e){e instanceof AST_SymbolRef&&O.push(e)})),U.push(e))},[]),U.push(p),we(_,U).optimize(c));if(T.inlined=S,B=De(e,h,B),N||Y(B,_)===B)return O.forEach(function(e){e.scope=o===T?T.parent_scope:o.scope,e.reference();e=e.definition();N&&e.replaced++,e.single_use=!1}),B;B.has_side_effects(c)||(_.drop_side_effect_free=function(e,n){var t=this.args.slice();return t.unshift(this.expression),we(this,t).drop_side_effect_free(e,n)})}if(N&&function(){var e,n=new Dictionary,t=0;C=h;do{if(C.variables&&C.variables.each(function(e){n.set(e.name,!0)}),e=C,(C=c.parent(t++))instanceof AST_ClassField){if(!C.static)return}else C instanceof AST_DWLoop?E=[]:C instanceof AST_For?C.init!==e&&(E=[]):C instanceof AST_ForEnumeration&&C.init!==e&&C.object!==e&&(E=[])}while(!(C instanceof AST_Scope));if(!(z=C.body.indexOf(e)+1))return;if(!Ln(T,jn(c,C)))return;var i=(o!==T||T.parent_scope.resolve()===C)&&!C.pinned();C instanceof AST_Toplevel&&(c.toplevel.vars?n.set("arguments",!0):i=!1);D=new Dictionary;var r=c.option("inline");return function(n,t){var i=!1;return T.each_argname(function(e){if(!i&&!e.unused){if(!t||H(n,e.name))return i=!0;D.set(e.name,!0),E&&E.push(e.definition())}}),!i}(n,2<=r&&i)&&!(!function(n,e){for(var t=0;t<T.body.length;t++){var i=T.body[t];if(i instanceof AST_LambdaDefinition){var r=i.name;if(!e)return;if(D.has(r.name))return;if(H(n,r.name))return;if(!all(i.enclosed,function(e){return e.scope===C||e.scope===i||!n.has(e.name)}))return;E&&E.push(r.definition())}else if(i instanceof AST_Var){if(!e)return;for(var o=i.definitions.length;0<=--o;){r=i.definitions[o].name;if(H(n,r.name))return;E&&E.push(r.definition())}}}return 1}(n,3<=r&&i)||E&&0!=E.length&&it(T,E))}())return T._squeezed=!0,o!==T&&(T.parent_scope=o.scope),B=we(_,function(){var e=[],n=[];(1<y||g||b||T.rest?function(i,r){function n(e,n){if(n.unused)return j(n);var t=n.definition(),e=(t.assignments++,t.references.push(e),ke(AST_SymbolVar,n));t.orig.push(e),t.eliminated++,F(i,r,e)}r.push(ke(AST_Assign,_,{operator:"=",left:ke(AST_DestructuredArray,_,{elements:T.argnames.map(function(e){return e.unused?ke(AST_Hole,e):e.convert_symbol(AST_SymbolRef,n)}),rest:T.rest&&T.rest.convert_symbol(AST_SymbolRef,n)}),right:ke(AST_Array,_,{elements:_.args.slice()})}))}:function(e,n){for(var t=T.argnames.length,i=_.args.length;--i>=t;)n.push(_.args[i]);var r,o=[];for(i=t;0<=--i;){var a,s,f=T.argnames[i],c=(r=f instanceof AST_DefaultValue?(o.push(f),f.name):f,_.args[i]);r.unused||C.var_names().has(r.name)?c&&n.push(c):(a=ke(AST_SymbolVar,r),(s=r.definition()).orig.push(a),s.eliminated++,void 0!==r.unused?(F(e,n,a),c&&n.push(c)):(!c&&f===r&&(E||"arguments"==r.name&&!is_arrow(T)&&is_arrow(C))&&(c=ke(AST_Undefined,_)),F(e,n,a,c)))}for(e.reverse(),n.reverse(),i=o.length;0<=--i;){var l,u=o[i];void 0!==u.name.unused?n.push(u.value):(l=ke(AST_SymbolRef,u.name),u.name.definition().references.push(l),n.push(ke(AST_Assign,u,{operator:"=",left:l,right:u.value})))}})(e,n);var t=function(i,e){var t=[z,0],o=[],r=[],a=[],s=[],f=[];return T.body.filter(E?function(e){var n,t;return!(e instanceof AST_LambdaDefinition&&((t=(n=ke(AST_SymbolVar,ft(e.name))).definition()).fixed=!1,t.orig.push(n),t.eliminated++,F(i,r,n,vn(e,!0)),1))}:function(e){var n;return!(e instanceof AST_LambdaDefinition&&(n=e.name.definition(),C.functions.set(n.name,n),C.variables.set(n.name,n),C.enclosed.push(n),C.var_names().set(n.name,!0),t.push(e),1))}).forEach(function(e){if(e instanceof AST_Var)for(var n=0;n<e.definitions.length;n++){var t=e.definitions[n],i=ft(t.name),r=t.value;r&&0<f.length&&(f.push(r),r=we(t,f),f=[]),F(o,a,i,r),!E||D.has(i.name)||1==i.definition().orig.length&&T.functions.has(i.name)||s.push(ut(c,i))}else e instanceof AST_SimpleStatement&&f.push(e.body)}),[].push.apply(i,o),[].push.apply(e,s),[].push.apply(e,r),[].push.apply(e,a),t}(e,n);n.push(x),e.length&&t.push(ke(AST_Var,T,{definitions:e}));return[].splice.apply(C.body,t),T.enclosed.forEach(function(e){C.var_names().has(e.name)||(C.enclosed.push(e),C.var_names().set(e.name,!0))}),n}()).optimize(c),De(e,h,B)}if(c.option("side_effects")&&A&&all(T.body,ee)&&(T===o?kn(T,c):!y&&!g&&!T.rest)&&(!is_arrow(T)||!T.value)&&Ln(T,jn(c)))return we(_,L()).optimize(c)}if(c.option("drop_console")&&o instanceof AST_PropAccess){for(var P=o.expression;P.expression;)P=P.expression;if(Ee(P)&&"console"==P.name)return ke(AST_Undefined,_).optimize(c)}return c.option("negate_iife")&&e instanceof AST_SimpleStatement&&le(h)?_.negate(c,!0):K(c,_);function j(e){return ke(AST_Sub,e,{expression:ke(AST_Array,e,{elements:[]}),property:ke(AST_Number,e,{value:0})})}function L(e){var a,t,n=_.args.slice(),i=1<y||g||T.rest;return(i||b)&&(n=[ke(AST_Array,_,{elements:n})]),i?(a=new TreeTransformer(function(i,e){var t,r,o;return i instanceof AST_DefaultValue?ke(AST_DefaultValue,i,{name:i.name.transform(a)||j(i),value:i.value}):i instanceof AST_DestructuredArray?(t=[],i.elements.forEach(function(e,n){(e=e.transform(a))&&(t[n]=e)}),hn(i,t),ke(AST_DestructuredArray,i,{elements:t})):i instanceof AST_DestructuredObject?(r=[],o=[],i.properties.forEach(function(e){var n=e.key,t=e.value.transform(a);t?(o.length&&(n instanceof AST_Node||(n=Z(n,e)),o.push(n),n=we(i,o),o=[]),r.push(ke(AST_DestructuredKeyVal,e,{key:n,value:t}))):n instanceof AST_Node&&o.push(n)}),o.length&&r.push(ke(AST_DestructuredKeyVal,i,{key:we(i,o),value:j(i)})),ke(AST_DestructuredObject,i,{properties:r})):i instanceof AST_SymbolFunarg?null:void 0}),t=[],T.argnames.forEach(function(e,n){(e=e.transform(a))&&(t[n]=e)}),(i=T.rest&&T.rest.transform(a))&&(t.length=T.argnames.length),hn(T,t),n[0]=ke(AST_Assign,_,{operator:"=",left:ke(AST_DestructuredArray,T,{elements:t,rest:i}),right:n[0]})):T.argnames.forEach(function(e){e instanceof AST_DefaultValue&&n.push(e.value)}),n.push(e||ke(AST_Undefined,_)),n}function V(){return _.call_only?ke(AST_Number,_,{value:0}):ke(AST_Undefined,_)}function I(e){return e?e instanceof AST_Return?e.value||V():e instanceof AST_SimpleStatement?_.call_only?e.body:ke(AST_UnaryPrefix,e,{operator:"void",expression:e.body}):void 0:V()}function M(e){for(var n=T.argnames.length;0<=--n;)if(T.argnames[n].definition()===e)return n}function H(e,n){return e.has(n)||te[n]||C.var_names().has(n)}function F(e,n,t,i){var r=t.definition();C.var_names().has(t.name)||(r.first_decl=null,C.var_names().set(t.name,!0),e.push(ke(AST_VarDef,t,{name:t,value:null}))),C.variables.set(t.name,r),C.enclosed.push(r),i&&(e=ke(AST_SymbolRef,t),r.assignments++,r.references.push(e),n.push(ke(AST_Assign,_,{operator:"=",left:e,right:i})))}}),e(AST_New,function(e,n){if(n.option("unsafe")){var t=e.expression;if(Ee(t))switch(t.name){case"Array":case"Error":case"Function":case"Object":case"RegExp":return ke(AST_Call,e).transform(n)}}if(n.option("sequences")){t=G(e);if(t!==e)return t.optimize(n)}return n.option("unused")&&Un(e,n),e}),e(AST_Sequence,function(e,t){for(var i,r,o,n=t.option("side_effects")?(i=[],r=first_in_statement(t),o=e.expressions.length-1,e.expressions.forEach(function(e,n){(e=n<o?e.drop_side_effect_free(t,r):e)&&(re(i,e),r=!1)}),i):e.expressions,a=n.length-1,s=1;s<a;s++){var f=n[s-1],c=_(f);if(c){var l=n[s];if(t.option("conditionals")){var u=In(t,c,f.right,l);if(u){f.right=u,n.splice(s--,1),a--;continue}}t.option("dead_code")&&_(l)===c&&l.right.is_constant_expression(c.scope.resolve())&&(n[--s]=f.right)}}if(t.option("side_effects")){for(;0<a&&Ce(n[a],t);)a--;a<n.length-1&&(n[a]=ke(AST_UnaryPrefix,e,{operator:"void",expression:n[a]}),n.length=a+1)}return 0==a?(e=De(t.parent(),t.self(),n[0]))instanceof AST_Sequence?e:e.optimize(t):(e.expressions=n,e);function _(e){return e instanceof AST_Assign&&"="==e.operator&&e.left instanceof AST_SymbolRef&&e.left.definition()}}),e(AST_UnaryPostfix,function(e,n){if(n.option("sequences")){var t=G(e);if(t!==e)return t.optimize(n)}return K(n,e)});var Mn=makePredicate("+ -"),Hn=makePredicate("* / %"),Wn=(e(AST_UnaryPrefix,function(e,n){var t=e.operator,i=e.expression;if(n.option("sequences")&&function(){switch(t){case"delete":return!a(i.tail_node());case"typeof":return!Ee(i.tail_node());default:return 1}}()){var r=G(e);if(r!==e)return r.optimize(n)}switch(t){case"+":if(!n.option("evaluate"))break;if(!i.is_number(n,!0))break;var o=n.parent();if(o instanceof AST_UnaryPrefix&&"delete"==o.operator)break;return i;case"-":if((i=i instanceof AST_Infinity?i.transform(n):i)instanceof AST_Number||i instanceof AST_Infinity)return e;break;case"!":if(n.option("booleans")){if(i.is_truthy())return we(e,[i,ke(AST_False,e)]).optimize(n);if(n.in_boolean_context()){if(i instanceof AST_UnaryPrefix&&"!"==i.operator)return i.expression;i instanceof AST_Binary&&(e=((o=first_in_statement(n))?Ie:Y)(e,i.negate(n,o)))}}break;case"delete":if(!n.option("evaluate"))break;if(a(i))break;return we(e,[i,ke(AST_True,e)]).optimize(n);case"typeof":if(!n.option("booleans"))break;if(!n.in_boolean_context())break;AST_Node.warn("Boolean expression always true [{start}]",e);o=[ke(AST_True,e)];return i instanceof AST_SymbolRef&&be(i,n)||o.unshift(i),we(e,o).optimize(n);case"void":if(n.option("side_effects"))return(i=i.drop_side_effect_free(n))?(e.expression=i,e):ke(AST_Undefined,e).optimize(n)}return n.option("evaluate")&&i instanceof AST_Binary&&Mn[t]&&Hn[i.operator]&&(i.left.is_constant()||!i.right.has_side_effects(n))?ke(AST_Binary,e,{operator:i.operator,left:ke(AST_UnaryPrefix,i.left,{operator:t,expression:i.left}),right:i.right}):K(n,e);function a(e){return e instanceof AST_Infinity||e instanceof AST_NaN||e instanceof AST_NewTarget||e instanceof AST_PropAccess||e instanceof AST_SymbolRef||e instanceof AST_Undefined}}),e(AST_Await,function(e,n){if(n.option("awaits")){if(n.option("sequences")){var t=G(e);if(t!==e)return t.optimize(n)}if(n.option("side_effects")){var i=e.expression;if(i instanceof AST_Await)return i.optimize(n);if(i instanceof AST_UnaryPrefix&&i.expression instanceof AST_Await)return i.optimize(n);for(var r,o=0,a=e;r=n.parent(o++);a=r){if(is_arrow(r)){if(r.value===a)return i.optimize(n)}else if(r instanceof AST_Return){var s=!0;do{if(a=r,(r=n.parent(o++))instanceof AST_Try&&(r.bfinally||r.bcatch)!==a){s=!1;break}}while(r&&!(r instanceof AST_Scope));if(s)return i.optimize(n)}else if(r instanceof AST_Sequence&&r.tail_node()===a)continue;break}}}return e}),e(AST_Yield,function(e,n){if(n.option("yields")){if(n.option("sequences")){var t=G(e);if(t!==e)return t.optimize(n)}t=e.expression;if(e.nested&&"Call"==t.TYPE){t=t.clone().optimize(n);if("Call"!=t.TYPE)return t}}return e}),AST_Binary.DEFMETHOD("lift_sequences",function(e){if(this.left instanceof AST_PropAccess)return this.left.expression instanceof AST_Sequence?(n=this.left.expression.expressions.slice(),(t=this.clone()).left=t.left.clone(),t.left.expression=n.pop(),n.push(t),we(this,n)):this;if(this.left instanceof AST_Sequence)return n=this.left.expressions.slice(),(t=this.clone()).left=n.pop(),n.push(t),we(this,n);if(this.right instanceof AST_Sequence){if(this.left.has_side_effects(e))return this;for(var n,t,i="="==this.operator&&this.left instanceof AST_SymbolRef,r=(n=this.right.expressions).length-1,o=0;o<r&&(i||!n[o].has_side_effects(e));o++);if(o==r)return n=n.slice(),(t=this.clone()).right=n.pop(),n.push(t),we(this,n);if(0<o)return(t=this.clone()).right=we(this.right,n.slice(o)),(n=n.slice(0,o)).push(t),we(this,n)}return this}),makePredicate("indexOf lastIndexOf")),Yn=makePredicate("== === != !== * & | ^");function Kn(e,n){return e instanceof AST_Assign?!n&&"="==e.operator&&Kn(e.right):e instanceof AST_New?!n:e instanceof AST_Sequence?Kn(e.tail_node(),n):e instanceof AST_SymbolRef?!n&&Kn(e.fixed_value()):e instanceof AST_Array||e instanceof AST_Class||e instanceof AST_Lambda||e instanceof AST_Object}function Gn(e,n){var t=e.right;switch(e.operator){case"in":return Kn(t)||n&&n.option("unsafe_comps");case"instanceof":return(t=t instanceof AST_SymbolRef?t.fixed_value():t)instanceof AST_Defun||t instanceof AST_Function||is_generator(t)?!0:!(!w(t)||!e.left.is_constant())||n&&n.option("unsafe_comps");default:return!0}}function h(e,n){var t,i;return!!n.is_constant()||(n instanceof AST_Assign?"="!=n.operator||h(e,n.right):n instanceof AST_Binary?!Ne[n.operator]||h(e,n.left)&&h(e,n.right):n instanceof AST_Call?!!is_async(n.expression)&&(t=!1,walk_body(n.expression,new TreeWalker(function(e){return!!t||(e instanceof AST_Await?t=!0:e!==n&&e instanceof AST_Scope||void 0)})),!t):n instanceof AST_Conditional?h(e,n.consequent)&&h(e,n.alternative):n instanceof AST_Sequence?h(e,n.tail_node()):n instanceof AST_SymbolRef?(i=n.fixed_value())&&h(e,i):n instanceof AST_Template?!n.tag||et(e,n.tag):n instanceof AST_Unary||void 0)}function $n(e,n){return e instanceof AST_Assign?Pe(e.left,n)?e:e.left:e instanceof AST_Sequence?$n(e.tail_node(),n):!(e instanceof AST_UnaryPrefix&&UNARY_POSTFIX[e.operator])||Pe(e.expression,n)?e:e.expression}function Xn(e,n){return n instanceof AST_Dot?Xn(e,n.expression):n instanceof AST_Sub?Xn(e,n.expression)&&Xn(e,n.property):n instanceof AST_Symbol||!n.has_side_effects(e)}function Jn(e,n){var t,i=e.right.tail_node();if(i!==e.right&&((t=e.right.expressions.slice(0,-1)).push(i.left),(i=i.clone()).left=we(e.right,t),e.right=i),e.left=ke(AST_Binary,e,{operator:e.operator,left:e.left,right:i.left,start:e.left.start,end:i.left.end}),e.right=i.right,n)return(t=e.left.transform(n))!==e.left&&((e=e.clone()).left=t),e;e.operator==i.left.operator&&Jn(e.left)}function Qn(e,n,t){var i=0,r=e.self();do{if(r===t)return r;if(w(r)&&r.name&&r.name.definition()===n)return r}while(r=e.parent(i++))}function Zn(e){var n=e.scope.resolve();return all(e.references,function(e){return n===e.scope.resolve()})}function et(e,n){return e.option("unsafe")&&n instanceof AST_Dot&&"raw"==n.property&&Ee(n.expression)&&"String"==n.expression.name}function nt(e){var t=!1;if(e=e.replace(/\\(u\{[^{}]*\}?|u[\s\S]{0,4}|x[\s\S]{0,2}|[0-9]+|[\s\S])/g,function(e,n){n=decode_escape_sequence(n);if("string"==typeof n)return n;t=!0}),!t)return e}function tt(e,n){return e instanceof AST_SymbolRef||e.TYPE===n.TYPE}function it(t,n){var i=!1,r=new TreeWalker(function(e){return!!i||(e instanceof AST_SymbolRef&&member(e.definition(),n)?i=!0:void 0)}),o=new TreeWalker(function(e){if(i)return!0;if(e instanceof AST_Lambda&&e!==t){if(!(e.name||is_async(e)||is_generator(e))){var n=o.parent();if(n instanceof AST_Call&&n.expression===e)return}return e.walk(r),!0}});return t.walk(o),i}e(AST_Binary,function(t,r){if(!Yn[t.operator]||!t.right.is_constant()||t.left.is_constant()||t.left instanceof AST_Binary&&PRECEDENCE[t.left.operator]>=PRECEDENCE[t.operator]||k(),r.option("sequences")){var e=t.lift_sequences(r);if(e!==t)return e.optimize(r)}if(r.option("assignments")&&Ne[t.operator]){var n,i=$n(t.left,r),e=t.right;if(i instanceof AST_SymbolRef&&e instanceof AST_Assign&&"="==e.operator&&i.equals(e.left))return i=i.clone(),n=ke(AST_Assign,t,{operator:"=",left:i,right:ke(AST_Binary,t,{operator:t.operator,left:t.left,right:e.right})}),i.fixed&&(i.fixed=function(){return n.right},i.fixed.assigns=[n]),(e=i.definition()).references.push(i),e.replaced++,n.optimize(r)}if(r.option("comparisons"))switch(t.operator){case"===":case"!==":if(Ce(t.left,r)&&t.right.is_defined(r))return AST_Node.warn("Expression always defined [{start}]",t),we(t,[t.right,ke("==="==t.operator?AST_False:AST_True,t)]).optimize(r);var o=!0;(t.left.is_string(r)&&t.right.is_string(r)||t.left.is_number(r)&&t.right.is_number(r)||t.left.is_boolean(r)&&t.right.is_boolean(r)||Xn(r,t.left)&&t.left.equals(t.right))&&(t.operator=t.operator.slice(0,2));case"==":case"!=":if(!o&&Ce(t.left,r))t.left=ke(AST_Null,t.left);else if(r.option("typeofs")&&t.left instanceof AST_String&&"undefined"==t.left.value&&t.right instanceof AST_UnaryPrefix&&"typeof"==t.right.operator)((a=t.right.expression)instanceof AST_SymbolRef?!a.is_declared(r):a instanceof AST_PropAccess&&r.option("ie"))||(t.right=a,t.left=ke(AST_Undefined,t.left).optimize(r),2==t.operator.length&&(t.operator+="="));else if(t.left instanceof AST_SymbolRef&&t.right instanceof AST_SymbolRef&&t.left.definition()===t.right.definition()&&Kn(t.left))return ke("="==t.operator[0]?AST_True:AST_False,t).optimize(r);break;case"&&":case"||":var a,o=t.left;if(o instanceof AST_Binary&&(o.operator==("&&"==t.operator?"!==":"===")&&t.right instanceof AST_Binary&&o.operator==t.right.operator&&(Ce(o.left,r)&&t.right.left instanceof AST_Null||o.left instanceof AST_Null&&Ce(t.right.left,r)))){if((a=(a=o.right)instanceof AST_Assign&&"="==a.operator?a.left:a).has_side_effects(r))break;if(a.equals(t.right.right))return o.operator=o.operator.slice(0,-1),o.left=ke(AST_Null,t),o}}var s,f,c=!1,l=r.parent();if(r.option("booleans")){i=$n(t.left,r);if(Ne[t.operator]&&!i.has_side_effects(r)){if(i.equals(t.right))return De(l,r.self(),t.left).optimize(r);Nn(r,i)}c=r.in_boolean_context()}if(c)switch(t.operator){case"+":var u=t.left.evaluate(r,!0);if(u&&"string"==typeof u||(u=t.right.evaluate(r,!0))&&"string"==typeof u){AST_Node.warn("+ in boolean context always true [{start}]",t);var _=[];switch(t.left.evaluate(r)instanceof AST_Node&&_.push(t.left),t.right.evaluate(r)instanceof AST_Node&&_.push(t.right),_.length){case 0:return ke(AST_True,t).optimize(r);case 1:return _[0]=_[0].clone(),_.push(ke(AST_True,t)),we(t,_).optimize(r)}t.truthy=!0}break;case"==":if(t.left instanceof AST_String&&""==t.left.value&&t.right.is_string(r))return ke(AST_UnaryPrefix,t,{operator:"!",expression:t.right}).optimize(r);break;case"!=":if(t.left instanceof AST_String&&""==t.left.value&&t.right.is_string(r))return t.right.optimize(r)}if(r.option("comparisons")&&t.is_boolean(r)){if("Binary"!=l.TYPE){e=ke(AST_UnaryPrefix,t,{operator:"!",expression:t.negate(r)});if(Me(r,t,e)===e)return e}switch(t.operator){case">":k("<");break;case">=":k("<=")}}if(r.option("conditionals")&&Ne[t.operator]&&(t.left instanceof AST_Binary&&t.operator==t.left.operator&&(s=(e=ke(AST_Binary,t,{operator:t.operator,left:t.left.right,right:t.right})).transform(r),e!==s)&&(t.left=t.left.left,t.right=s),(S=t.right.tail_node())instanceof AST_Binary)&&t.operator==S.operator&&(t=Jn(t,r)),r.option("strings")&&"+"==t.operator){if(t.right instanceof AST_String&&""==t.right.value&&t.left.is_string(r))return t.left.optimize(r);if(t.left instanceof AST_String&&""==t.left.value&&t.right.is_string(r))return t.right.optimize(r);if(t.left instanceof AST_Binary&&"+"==t.left.operator&&t.left.left instanceof AST_String&&""==t.left.left.value&&t.right.is_string(r)&&(t.left.right.is_constant()||!t.right.has_side_effects(r)))return t.left=t.left.right,t.optimize(r);(S=t.right.tail_node())instanceof AST_Binary&&t.operator==S.operator&&(t.left.is_string(r)&&S.is_string(r)||S.left.is_string(r)&&(t.left.is_constant()||!S.right.has_side_effects(r)))&&(t=Jn(t,r))}if(r.option("evaluate")){var S,p=!0;switch(t.operator){case"&&":if(!(T=N(r,t.left)))return AST_Node.warn("Condition left of && always false [{start}]",t),De(l,r.self(),t.left).optimize(r);if(!(T instanceof AST_Node))return AST_Node.warn("Condition left of && always true [{start}]",t),we(t,[t.left,t.right]).optimize(r);if(t.right.evaluate(r,!0)){if((c||"&&"==l.operator&&l.left===r.self())&&!(t.right.evaluate(r)instanceof AST_Node))return AST_Node.warn("Dropping side-effect-free && [{start}]",t),t.left.optimize(r)}else{if(c&&!(t.right.evaluate(r)instanceof AST_Node))return AST_Node.warn("Boolean && always false [{start}]",t),we(t,[t.left,ke(AST_False,t)]).optimize(r);t.falsy=!0}if("||"==t.left.operator)if(!(A=N(r,t.left.right)))return ke(AST_Conditional,t,{condition:t.left.left,consequent:t.right,alternative:t.left.right}).optimize(r);break;case"??":var d=!0;case"||":var A,T=N(r,t.left,d);if(d?null==T:!T)return AST_Node.warn("Condition left of {operator} always {value} [{start}]",{operator:t.operator,value:d?"nullish":"false",start:t.start}),we(t,[t.left,t.right]).optimize(r);if(!(T instanceof AST_Node))return AST_Node.warn("Condition left of {operator} always {value} [{start}]",{operator:t.operator,value:d?"defined":"true",start:t.start}),De(l,r.self(),t.left).optimize(r);if(d||!(T=t.right.evaluate(r,!0))||T instanceof AST_Node){if((c||"||"==l.operator&&l.left===r.self())&&!t.right.evaluate(r))return AST_Node.warn("Dropping side-effect-free {operator} [{start}]",t),t.left.optimize(r)}else{if(c&&!(t.right.evaluate(r)instanceof AST_Node))return AST_Node.warn("Boolean || always true [{start}]",t),we(t,[t.left,ke(AST_True,t)]).optimize(r);t.truthy=!0}if(!d&&"&&"==t.left.operator)if((A=N(r,t.left.right))&&!(A instanceof AST_Node))return ke(AST_Conditional,t,{condition:t.left.left,consequent:t.left.right,alternative:t.right}).optimize(r);break;case"+":if((t=(t=t.left instanceof AST_Constant&&t.right instanceof AST_Binary&&"+"==t.right.operator&&t.right.left instanceof AST_Constant&&t.right.is_string(r)?ke(AST_Binary,t,{operator:"+",left:ke(AST_String,t.left,{value:""+t.left.value+t.right.left.value,start:t.left.start,end:t.right.left.end}),right:t.right.right}):t).right instanceof AST_Constant&&t.left instanceof AST_Binary&&"+"==t.left.operator&&t.left.right instanceof AST_Constant&&t.left.is_string(r)?ke(AST_Binary,t,{operator:"+",left:t.left.left,right:ke(AST_String,t.right,{value:""+t.left.right.value+t.right.value,start:t.left.right.start,end:t.right.end})}):t).right instanceof AST_UnaryPrefix&&"-"==t.right.operator&&t.left.is_number(r)){t=ke(AST_Binary,t,{operator:"-",left:t.left,right:t.right.expression});break}if(t.left instanceof AST_UnaryPrefix&&"-"==t.left.operator&&x()&&t.right.is_number(r)){t=ke(AST_Binary,t,{operator:"-",left:t.right,right:t.left.expression});break}if(r.option("unsafe_math")&&t.left instanceof AST_Binary&&PRECEDENCE[t.left.operator]==PRECEDENCE[t.operator]&&t.right.is_constant()&&(t.right.is_boolean(r)||t.right.is_number(r))&&t.left.is_number(r)&&!t.left.right.is_constant()&&(t.left.left.is_boolean(r)||t.left.left.is_number(r))){t=ke(AST_Binary,t,{operator:t.left.operator,left:ke(AST_Binary,t,{operator:t.operator,left:t.right,right:t.left.left}),right:t.left.right});break}case"-":if(t.right instanceof AST_UnaryPrefix&&"-"==t.right.operator&&t.left.is_number(r)&&t.right.expression.is_number(r)){t=ke(AST_Binary,t,{operator:"+",left:t.left,right:t.right.expression});break}case"*":case"/":p=r.option("unsafe_math"),"+"!=t.operator&&["left","right"].forEach(function(e){var n=t[e];n instanceof AST_UnaryPrefix&&"+"==n.operator&&((n=n.expression).is_boolean(r)||n.is_number(r)||n.is_string(r))&&(t[e]=n)});case"&":case"|":case"^":"-"==t.operator||"/"==t.operator||!t.left.is_boolean(r)&&!t.left.is_number(r)||!t.right.is_boolean(r)&&!t.right.is_number(r)||!x()||t.left instanceof AST_Binary&&t.left.operator!=t.operator&&PRECEDENCE[t.left.operator]>=PRECEDENCE[t.operator]||(t=Me(r,t,ke(AST_Binary,t,{operator:t.operator,left:t.right,right:t.left}),t.right instanceof AST_Constant&&!(t.left instanceof AST_Constant))),p&&t.is_number(r)&&(!(t.right instanceof AST_Binary&&"%"!=t.right.operator&&PRECEDENCE[t.right.operator]==PRECEDENCE[t.operator]&&t.right.is_number(r)&&("+"!=t.operator||t.right.left.is_boolean(r)||t.right.left.is_number(r)))||"-"==t.operator&&t.left.is_negative_zero()||!t.right.left.is_constant_expression()&&t.right.right.has_side_effects(r)||(T=t.right.right,f=!1,T.walk(new TreeWalker(function(e){if(f)return!0;if(e instanceof AST_Assign){if(e.left instanceof AST_PropAccess)return f=!0}else if(e instanceof AST_Unary&&unary_side_effects[e.operator]&&e.expression instanceof AST_PropAccess)return f=!0})),f)||("+"!=(t=ke(AST_Binary,t,{operator:y(t.operator,t.right.operator),left:ke(AST_Binary,t.left,{operator:t.operator,left:t.left,right:t.right.left,start:t.left.start,end:t.right.left.end}),right:t.right.right})).operator||t.right.is_boolean(r)||t.right.is_number(r)||(t.right=ke(AST_UnaryPrefix,t.right,{operator:"+",expression:t.right}))),t.right instanceof AST_Constant)&&t.left instanceof AST_Binary&&"%"!=t.left.operator&&PRECEDENCE[t.left.operator]==PRECEDENCE[t.operator]&&t.left.is_number(r)&&(t.left.left instanceof AST_Constant?(i=g(t.operator,t.left.left,t.right,{start:t.left.left.start,end:t.right.end}),t=g(t.left.operator,K(r,i),t.left.right,t)):t.left.right instanceof AST_Constant&&(d=y(t.left.operator,t.operator),!(S=K(r,g(d,t.left.right,t.right,t.left))).is_constant()||"-"==t.left.operator&&0!=t.right.value&&0==+S.value&&t.left.left.is_negative_zero()||(t=g(t.left.operator,t.left.left,S,t))));break;case"instanceof":if(Gn(t,r)&&w(t.right))return we(t,[t.left,t.right,ke(AST_False,t)]).optimize(r)}if(!(l instanceof AST_UnaryPrefix&&"delete"==l.operator)){if(t.left instanceof AST_Number&&!t.right.is_constant())switch(t.operator){case"+":if(0==t.left.value){if(t.right.is_boolean(r))return ke(AST_UnaryPrefix,t,{operator:"+",expression:t.right}).optimize(r);if(t.right.is_number(r)&&!t.right.is_negative_zero())return t.right}break;case"*":if(1==t.left.value)return ke(AST_UnaryPrefix,t,{operator:"+",expression:t.right}).optimize(r)}if(t.right instanceof AST_Number&&!t.left.is_constant())switch(t.operator){case"+":if(0==t.right.value){if(t.left.is_boolean(r))return ke(AST_UnaryPrefix,t,{operator:"+",expression:t.left}).optimize(r);if(t.left.is_number(r)&&!t.left.is_negative_zero())return t.left}break;case"-":if(0==t.right.value)return ke(AST_UnaryPrefix,t,{operator:"+",expression:t.left}).optimize(r);break;case"/":if(1==t.right.value)return ke(AST_UnaryPrefix,t,{operator:"+",expression:t.left}).optimize(r)}}}if(r.option("typeofs"))switch(t.operator){case"&&":z(t.left,t.right,null);break;case"||":z(t.left,null,t.right)}if(r.option("unsafe")){var h=b(t.right);if(c&&h&&("=="==t.operator||"!="==t.operator)&&t.left instanceof AST_Number&&0==t.left.value)return("=="==t.operator?ke(AST_UnaryPrefix,t,{operator:"!",expression:t.right}):t.right).optimize(r);var m=b(t.left);if(r.option("comparisons")&&function(){switch(t.operator){case"<=":return h&&t.left instanceof AST_Number&&0==t.left.value;case"<":if(m&&t.right instanceof AST_Number&&0==t.right.value)return 1;case"==":case"!=":return h?t.left instanceof AST_Number&&-1==t.left.value||t.left instanceof AST_UnaryPrefix&&"-"==t.left.operator&&t.left.expression instanceof AST_Number&&1==t.left.expression.value:void 0}}()){var v=ke(AST_UnaryPrefix,t,{operator:"!",expression:ke(AST_UnaryPrefix,t,{operator:"~",expression:m?t.left:t.right})});switch(t.operator){case"<":if(m)break;case"<=":case"!=":v=ke(AST_UnaryPrefix,t,{operator:"!",expression:v})}return v.optimize(r)}}return K(r,t);function y(e,n){switch(e){case"-":return"+"==n?"-":"+";case"/":return"*"==n?"/":"*";default:return n}}function g(e,n,t,i){return"+"==e&&(n.is_boolean(r)||n.is_number(r)||(n=ke(AST_UnaryPrefix,n,{operator:"+",expression:n})),t.is_boolean(r)||t.is_number(r)||(t=ke(AST_UnaryPrefix,t,{operator:"+",expression:t}))),ke(AST_Binary,i,{operator:e,left:n,right:t})}function b(e){return"Call"==e.TYPE&&e.expression instanceof AST_Dot&&Wn[e.expression.property]}function x(){return t.left.is_constant()||t.right.is_constant()||!t.left.has_side_effects(r)&&!t.right.has_side_effects(r)}function k(e){x()&&(e&&(t.operator=e),e=t.left,t.left=t.right,t.right=e)}}),e(AST_SymbolExport,function(e){return e}),e(AST_SymbolRef,function(t,e){if(!e.option("ie")&&Ee(t)&&(!t.scope.resolve().uses_with||!e.find_parent(AST_With)))switch(t.name){case"undefined":return ke(AST_Undefined,t).optimize(e);case"NaN":return ke(AST_NaN,t).optimize(e);case"Infinity":return ke(AST_Infinity,t).optimize(e)}var n=e.parent();if(e.option("reduce_vars")&&is_lhs(e.self(),n)!==e.self()){var i,r,o,a,s,f,c,l,u,_=t.definition(),S=t.fixed_value(),n=_.single_use&&!(n instanceof AST_Call&&n.is_expr_pure(e));if(n)if(w(S)){if(_.scope===t.scope.resolve(!0)&&!_.in_loop||e.option("reduce_funcs")&&1!=_.escaped.depth&&!S.inlined)if(_.redefined())n=!1;else if(Qn(e,_,S))n=!1;else if(S.name&&S.name.definition()!==_)n=!1;else if(S.parent_scope!==t.scope||is_funarg(_))if(Vn(S,e)){if("f"==(n=S.is_constant_expression(t.scope)))for(var p=t.scope;(p instanceof AST_LambdaDefinition||p instanceof AST_LambdaExpression)&&(p.inlined=!0),p=p.parent_scope;);}else n=!1;else(S.name&&("await"==S.name.name&&is_async(S)||"yield"==S.name.name&&is_generator(S))||S.has_side_effects(e)||S instanceof AST_Class&&(e.option("ie")||!S.is_constant_expression(t.scope)))&&(n=!1);else n=!1;n&&(S.parent_scope=t.scope)}else(!S||0<_.recursive_refs||!S.is_constant_expression()||S.drop_side_effect_free(e))&&(n=!1);if(n){if(_.single_use=!1,S._squeezed=!0,S.single_use=!0,w(S=(S=S instanceof AST_DefClass?mn(S):S)instanceof AST_LambdaDefinition?vn(S):S)){var d=[],p=t.scope;do{if(d.push(p),p===_.scope)break}while(p=p.parent_scope);S.enclosed.forEach(function(e){if(!S.variables.has(e.name))for(var n=0;n<d.length;n++){var t=d[n];if(!push_uniq(t.enclosed,e))return;t.var_names().set(e.name,!0)}})}return 0<_.recursive_refs?(i=(u=S.clone(!0)).name.definition(),r=u.variables.get(u.name.name),o=r&&r.orig[0],n=u instanceof AST_Class?(a="def_function",AST_SymbolClass):(a="def_variable",AST_SymbolLambda),o instanceof n||(((o=ke(n,u.name)).scope=u).name=o,(r=u[a](o)).recursive_refs=_.recursive_refs),u.walk(new TreeWalker(function(e){var n,t;e instanceof AST_SymbolDeclaration?e!==o&&((n=e.definition()).orig.push(e),n.eliminated++):e instanceof AST_SymbolRef&&((n=e.definition())===i?e.thedef=n=r:(n.single_use=!1,w(t=e.fixed_value())&&t.name&&t.name.definition()===n&&n.scope===t.name.scope&&S.variables.get(t.name.name)===n&&(t.name=t.name.clone(),e.thedef=n=u.variables.get(t.name.name)||u[a](t.name))),n.references.push(e))}))):(S instanceof AST_Scope?(e.push(S),u=S.optimize(e),e.pop()):u=S.optimize(e),u=u.transform(new TreeTransformer(function(e,n){return e instanceof AST_Scope||n(e=e.clone(),this),e}))),_.replaced++,u}if(S&&!1!==(s=t.fixed||_.fixed).should_replace)if(S instanceof AST_This?is_funarg(_)||!Zn(_)||function(e){var n=t.scope;for(;n!==e.scope;){if(n instanceof AST_Class)return 1;n=n.parent_scope}}(_)||(f=S):(n=S.evaluate(e,!0))!==S&&"function"!=typeof n&&(null===n||"object"!=typeof n||e.option("unsafe_regexp")&&n instanceof RegExp&&!_.cross_loop&&Zn(_))&&(f=Z(n,S)),f)if(void 0===s.should_replace&&(n=f.optimize(e).print_to_string().length,A(S)||(n=Math.min(n,S.print_to_string().length)),c=_.name.length,e.option("unused")&&!e.exposed(_)&&(l=_.references.length-_.replaced-_.assignments,l=Math.min(l,_.references.filter(function(e){return e.fixed===s}).length),c+=(c+2+n)/Math.max(1,l)),s.should_replace=n-Math.floor(c)<e.eval_threshold),s.should_replace)return A(S)?(u=f.optimize(e))===f&&(u=u.clone(!0)):(u=Y(f.optimize(e),S))!==f&&u!==S||(u=u.clone(!0)),_.replaced++,u}return t;function A(e){var n;return e.walk(new TreeWalker(function(e){if(n=e instanceof AST_SymbolRef?!0:n)return!0})),n}}),e(AST_Template,function(e,t){if(!t.option("templates"))return e;var i=e.tag;if(!i||et(t,i)){for(var n,r=[],o=[],a=0;a<e.strings.length;a++){var s,f=e.strings[a];if(i||(s=nt(f))&&(f=S(s)),0<a){var c=e.expressions[a-1],l=function(e){var n=e.evaluate(t);if(n!==e&&!(i&&/\r|\\|`/.test(n)||(n=S(""+n)).length>e.print_to_string().length+"${}".length))return n}(c);if(l){var u,l=o[o.length-1]+l+f;if(i||typeof(u=nt(l))==n){o[o.length-1]=u?S(u):l;continue}}r.push(c)}o.push(f),i||(n=typeof s)}if(!i&&1<o.length){if(""==o[o.length-1])return ke(AST_Binary,e,{operator:"+",left:ke(AST_Template,e,{expressions:r.slice(0,-1),strings:o.slice(0,-1)}).transform(t),right:r[r.length-1]}).optimize(t);if(""==o[0]){for(var _=ke(AST_Binary,e,{operator:"+",left:ke(AST_String,e,{value:""}),right:r[0]}),a=1;""==o[a]&&a<r.length;a++)_=ke(AST_Binary,e,{operator:"+",left:_,right:r[a]});return Me(t,e,ke(AST_Binary,e,{operator:"+",left:_.transform(t),right:ke(AST_Template,e,{expressions:r.slice(a),strings:o.slice(a)}).transform(t)}).optimize(t))}}e.expressions=r,e.strings=o}return K(t,e);function S(e){return e.replace(/\r|\\|`|\${/g,function(e){return"\\"+("\r"==e?"r":e)})}}),e(AST_Undefined,function(e,n){if(n.option("unsafe_undefined")){var t=xe(n).find_variable("undefined");if(t)return(t=ke(AST_SymbolRef,e,{name:"undefined",scope:t.scope,thedef:t})).is_undefined=!0,t}t=is_lhs(n.self(),n.parent());return t&&tt(t,e)?e:ke(AST_UnaryPrefix,e,{operator:"void",expression:ke(AST_Number,e,{value:0})})}),e(AST_Infinity,function(e,n){var t=is_lhs(n.self(),n.parent());return(!t||!tt(t,e))&&(!n.option("keep_infinity")||t||xe(n).find_variable("Infinity"))?ke(AST_Binary,e,{operator:"/",left:ke(AST_Number,e,{value:1}),right:ke(AST_Number,e,{value:0})}):e}),e(AST_NaN,function(e,n){var t=is_lhs(n.self(),n.parent());return(!t||!tt(t,e))&&(t||xe(n).find_variable("NaN"))?ke(AST_Binary,e,{operator:"/",left:ke(AST_Number,e,{value:0}),right:ke(AST_Number,e,{value:0})}):e});var rt=makePredicate("+ - * / % >> << >>> | ^ &"),ot=makePredicate("* | ^ &");function at(e,n){var t;if(e)return"Call"!=(t=n.parent()).TYPE?1:t.expression!==n.self()||(!(e instanceof AST_SymbolRef)||(e=e.fixed_value()))&&e instanceof AST_Lambda&&!e.contains_this()}function st(e){return e instanceof AST_ObjectKeyVal&&"string"==typeof e.key&&!(e instanceof AST_ObjectMethod&&e.value.contains_super())}function ft(e){var n=e.definition().redefined();return n&&((e=e.clone()).thedef=n),e}function ct(n,e){var t=!1;return e.walk(new TreeWalker(function(e){return!!t||(e instanceof AST_SymbolRef&&n.variables.get(e.name)===e.definition()?t=!0:void 0)})),t}function lt(e,n){var t=[];e.references.forEach(function(e){e=e.fixed;e&&push_uniq(t,e)&&(e.assigns?e.assigns.unshift(n):e.assigns=[n])})}function ut(e,n){var t=ke(AST_SymbolRef,n),i=ke(AST_Assign,n,{operator:"=",left:t,right:ke(AST_Undefined,n).transform(e)}),e=n.definition();return e.fixed&&(t.fixed=function(){return i.right},t.fixed.assigns=[i],lt(e,i)),e.assignments++,e.references.push(t),i}function _t(e,n,t,i,r,o,a){for(var s=[],f=o.expressions,c=t,l=f.length-(a||0),u=l;0<=--l;r=!(c=!0)){var _=f[l].try_inline(e,n,c,i,r);_&&(S(),s.push(_))}if(0!=s.length)return S(),!t&&s[0]instanceof AST_SimpleStatement&&(s[0]=ke(AST_Return,o,{value:s[0].body})),ke(AST_BlockStatement,o,{body:s.reverse()});function S(){l+1<u&&s.push(ke(AST_SimpleStatement,o,{body:we(o,f.slice(l+1,u))})),u=l}}e(AST_Assign,function(o,a){if(a.option("dead_code"))if(o.left instanceof AST_PropAccess){if("="==o.operator){var e=o.left.expression;if(o.left.equals(o.right)){var n=e.defined,t=(e.defined=!1,!o.left.has_side_effects(a));if(e.defined=n,t)return o.right}if(e instanceof AST_Lambda||!a.has_directive("use strict")&&e instanceof AST_Constant&&!e.may_throw_on_access(a))return n=o.left instanceof AST_Dot?o.right:we(o,[o.left.property,o.right]),De(a.parent(),o,n).optimize(a)}}else if(o.left instanceof AST_SymbolRef&&be(o.left,a)){if("="==o.operator&&o.left.equals(o.right)&&!((l=a.parent())instanceof AST_UnaryPrefix&&"delete"==l.operator))return o.right;if(o.left.is_immutable())return d();var i,r=o.left.definition(),s=r.scope.resolve(),f=s===a.find_parent(AST_Lambda),c=0,l=a.self();if(!s.uses_arguments||!is_funarg(r)||a.has_directive("use strict"))do{if(i=l,(l=a.parent(c++))instanceof AST_Assign){if(l.left instanceof AST_SymbolRef&&l.left.definition()===r){if(S(c,l,!f))break;return d(r)}if(l.left.match_symbol(function(e){if(e instanceof AST_PropAccess)return!0}))break}else{if(l instanceof AST_Exit){if(!f)break;if(S(c,l))break;if(it(s,[r]))break;return d(r)}if(l instanceof AST_SimpleStatement){if(!f)break;if(it(s,[r]))break;do{if(u=l,(l=a.parent(c++))===s&&ze(l.body,u))return d(r)}while(u=u,(_=l)instanceof AST_BlockStatement||_ instanceof AST_Catch||_ instanceof AST_Finally?ze(_.body,u):_ instanceof AST_If?_.body===u||_.alternative===u:_ instanceof AST_Try?_.bfinally?_.bfinally===u:_.bcatch===u:void 0);break}if(l instanceof AST_VarDef&&l.name instanceof AST_SymbolDeclaration&&l.name.definition()===r){if(S(c,l))break;return d(r)}}}while(function(e,n){if(n instanceof AST_Binary)switch(e){case n.left:return n.right.is_constant_expression(s);case n.right:return 1;default:return}if(n instanceof AST_Conditional)switch(e){case n.condition:return n.consequent.is_constant_expression(s)&&n.alternative.is_constant_expression(s);case n.consequent:case n.alternative:return 1;default:return}if(n instanceof AST_Sequence){var t=n.expressions,i=t.indexOf(e);if(i<0)return;for(var r=t.length;--r>i;)if(!t[r].is_constant_expression(s))return;return 1}return n instanceof AST_UnaryPrefix}(i,l))}var u,_;if(a.option("sequences")){t=o.lift_sequences(a);if(t!==o)return t.optimize(a)}if(a.option("assignments")){if("="==o.operator&&o.left instanceof AST_SymbolRef&&o.right instanceof AST_Binary){if(o.right.left instanceof AST_SymbolRef&&o.right.left.name==o.left.name&&rt[o.right.operator])return p(o.right.right);if(o.right.right instanceof AST_SymbolRef&&o.right.right.name==o.left.name&&ot[o.right.operator]&&!o.right.left.has_side_effects(a))return p(o.right.left)}if(("-="==o.operator||"+="==o.operator&&(o.left.is_boolean(a)||o.left.is_number(a)))&&o.right instanceof AST_Number&&1==o.right.value)return e=o.operator.slice(0,-1),ke(AST_UnaryPrefix,o,{operator:e+e,expression:o.left})}return K(a,o);function S(e,n,t){var i=o.right,r=(o.right=ke(AST_Null,i),n.may_throw(a));return o.right=i,Be(a,e,n,s,r,t)}function p(e){var n=o.left.fixed;return n&&(n.to_binary=v(function(e){return e.left},n)),ke(AST_Assign,o,{operator:o.right.operator+"=",left:o.left,right:e})}function d(e){return e&&(e.fixed=!1),("="!=o.operator?ke(AST_Binary,o,{operator:o.operator.slice(0,-1),left:o.left,right:o.right}):De(a.parent(),o,o.right)).optimize(a)}}),e(AST_Conditional,function(a,n){if(n.option("sequences")&&a.condition instanceof AST_Sequence)return e=a.condition.expressions.slice(),(c=a.clone()).condition=e.pop(),e.push(c),we(a,e).optimize(n);if(n.option("conditionals")){var s=a.condition;if(n.option("booleans")&&!s.has_side_effects(n)&&Nn(n,s),!(s=N(n,s)))return AST_Node.warn("Condition always false [{start}]",a),we(a,[a.condition,a.alternative]).optimize(n);if(!(s instanceof AST_Node))return AST_Node.warn("Condition always true [{start}]",a),we(a,[a.condition,a.consequent]).optimize(n);var e=first_in_statement(n),t=s.negate(n,e),e=((e?Ie:Y)(s,t)===t&&(a=ke(AST_Conditional,a,{condition:t,consequent:a.alternative,alternative:a.consequent}),t=s,s=a.condition),a.consequent),i=a.alternative,r=$n(s,n);if(Xn(n,r)){if(r.equals(e))return ke(AST_Binary,a,{operator:"||",left:s,right:i}).optimize(n);if(r.equals(i))return ke(AST_Binary,a,{operator:"&&",left:s,right:e}).optimize(n)}r=e.tail_node();if(r instanceof AST_Assign){var o="="==r.operator,f=o?i.tail_node():i;if((o||e===r)&&f instanceof AST_Assign&&r.operator==f.operator&&r.left.equals(f.left)&&(o&&r.left instanceof AST_SymbolRef||!s.has_side_effects(n)&&h(e)&&h(i)))return ke(AST_Assign,a,{operator:r.operator,left:r.left,right:ke(AST_Conditional,a,{condition:s,consequent:m(e),alternative:m(i)})})}f=i.tail_node();if(r.equals(f))return we(a,e.equals(i)?[s,e]:[ke(AST_Conditional,a,{condition:s,consequent:v(e),alternative:v(i)}),f]).optimize(n);var c,l,o=function e(n,t,i){var r=n.tail_node();var o=t.tail_node();if(!T(r,o))return!i&&ke(AST_Conditional,a,{condition:s,consequent:n,alternative:t});i=r.clone();n=A(n,r,"expression");t=A(t,o,"expression");o=e(n,t);r.expression instanceof AST_Sequence&&(o=De(r,r.expression,o));i.expression=o;return i}(e,i,!0);if(o)return o;if(e instanceof AST_Call&&i.TYPE==e.TYPE&&0<=(o=d(e,i))&&e.expression.equals(i.expression)&&!s.has_side_effects(n)&&!e.expression.has_side_effects(n))return c=e.clone(),l=e.args[o],c.args[o]=l instanceof AST_Spread?ke(AST_Spread,a,{expression:ke(AST_Conditional,a,{condition:s,consequent:l.expression,alternative:i.args[o].expression})}):ke(AST_Conditional,a,{condition:s,consequent:l,alternative:i.args[o]}),c;if(r instanceof AST_Conditional&&r.alternative.equals(i))return ke(AST_Conditional,a,{condition:ke(AST_Binary,a,{left:s,operator:"&&",right:A(e,r,"condition")}),consequent:r.consequent,alternative:P(r.alternative,i)});if(r instanceof AST_Conditional&&r.consequent.equals(i))return ke(AST_Conditional,a,{condition:ke(AST_Binary,a,{left:t,operator:"||",right:A(e,r,"condition")}),consequent:P(r.consequent,i),alternative:r.alternative});if(f instanceof AST_Conditional&&e.equals(f.consequent))return ke(AST_Conditional,a,{condition:ke(AST_Binary,a,{left:s,operator:"||",right:A(i,f,"condition")}),consequent:P(e,f.consequent),alternative:f.alternative});if(f instanceof AST_Conditional&&e.equals(f.alternative))return ke(AST_Conditional,a,{condition:ke(AST_Binary,a,{left:t,operator:"&&",right:A(i,f,"condition")}),consequent:f.consequent,alternative:P(e,f.alternative)});if(r instanceof AST_Binary&&"&&"==r.operator&&r.right.equals(i))return ke(AST_Binary,a,{operator:"&&",left:ke(AST_Binary,a,{operator:"||",left:t,right:A(e,r,"left")}),right:P(r.right,i)}).optimize(n);if(r instanceof AST_Binary&&"||"==r.operator&&r.right.equals(i))return ke(AST_Binary,a,{operator:"||",left:ke(AST_Binary,a,{operator:"&&",left:s,right:A(e,r,"left")}),right:P(r.right,i)}).optimize(n);if(f instanceof AST_Binary&&"&&"==f.operator&&f.right.equals(e))return ke(AST_Binary,a,{operator:"&&",left:ke(AST_Binary,a,{operator:"||",left:s,right:A(i,f,"left")}),right:P(e,f.right)}).optimize(n);if(f instanceof AST_Binary&&"||"==f.operator&&f.right.equals(e))return ke(AST_Binary,a,{operator:"||",left:ke(AST_Binary,a,{operator:"&&",left:t,right:A(i,f,"left")}),right:P(e,f.right)}).optimize(n);var u=n.option("booleans")&&n.in_boolean_context();if(S(e))return p(i)?_(s):ke(AST_Binary,a,{operator:"||",left:_(s),right:i}).optimize(n);if(p(e))return S(i)?_(s.negate(n)):ke(AST_Binary,a,{operator:"&&",left:_(s.negate(n)),right:i}).optimize(n);if(S(i))return ke(AST_Binary,a,{operator:"||",left:_(s.negate(n)),right:e}).optimize(n);if(p(i))return ke(AST_Binary,a,{operator:"&&",left:_(s),right:e}).optimize(n);n.option("typeofs")&&z(s,e,i)}return a;function _(e){return e.is_boolean(n)?e:ke(AST_UnaryPrefix,e,{operator:"!",expression:e.negate(n)})}function S(e){return e instanceof AST_True||u&&e instanceof AST_Constant&&e.value||e instanceof AST_UnaryPrefix&&"!"==e.operator&&e.expression instanceof AST_Constant&&!e.expression.value}function p(e){return e instanceof AST_False||u&&(e instanceof AST_Constant&&!e.value||e instanceof AST_UnaryPrefix&&"void"==e.operator&&!e.expression.has_side_effects(n))||e instanceof AST_UnaryPrefix&&"!"==e.operator&&e.expression instanceof AST_Constant&&e.expression.value}function d(e,n){var t=e.args,i=n.args,r=t.length;if(r!=i.length)return-2;for(var o=0;o<r;o++)if(!t[o].equals(i[o])){if(t[o]instanceof AST_Spread!=i[o]instanceof AST_Spread)return-3;for(var a=o+1;a<r;a++)if(!t[a].equals(i[a]))return-2;return o}return-1}function A(e,n,t){var i;return e===n?n[t]:((i=e.expressions.slice(0,-1)).push(n[t]),we(e,i))}function T(e,n){var t,i;if(e.TYPE==n.TYPE&&e.optional==n.optional)return e instanceof AST_Call?-1!=d(e,n)?void 0:"Call"!=e.TYPE||!(e.expression instanceof AST_PropAccess||n.expression instanceof AST_PropAccess)||T(e.expression,n.expression):e instanceof AST_PropAccess?(i=n.property,((t=e.property)instanceof AST_Node?t.equals(i):t==i)&&!(e.expression instanceof AST_Super||n.expression instanceof AST_Super)):void 0}function h(e){return e===e.tail_node()||all(e.expressions.slice(0,-1),function(e){return!e.has_side_effects(n)})}function m(e){var n;return e instanceof AST_Sequence?((n=e.expressions.slice()).push(n.pop().right),we(e,n)):e.right}function v(e){return e instanceof AST_Sequence?we(e,e.expressions.slice(0,-1)):ke(AST_Number,e,{value:0})}}),e(AST_Boolean,function(e,n){return n.option("booleans")?n.in_boolean_context()?ke(AST_Number,e,{value:+e.value}):(n=n.parent())instanceof AST_Binary&&("=="==n.operator||"!="==n.operator)?(AST_Node.warn("Non-strict equality against boolean: {operator} {value} [{start}]",{operator:n.operator,value:e.value,start:n.start}),ke(AST_Number,e,{value:+e.value})):ke(AST_UnaryPrefix,e,{operator:"!",expression:ke(AST_Number,e,{value:1-e.value})}):e}),e(AST_Spread,function(e,n){var t=e.expression;return n.option("spreads")&&t instanceof AST_Array&&!(n.parent()instanceof AST_Object)?List.splice(t.elements.map(function(e){return e instanceof AST_Hole?ke(AST_Undefined,e).optimize(n):e})):e}),e(AST_Sub,function(e,t){var n=e.expression,i=e.property,r=zn(e,t);if(r)return r;if(t.option("properties")){var o=i.evaluate(t);if(o!==i){"string"==typeof o&&("undefined"==o?o=void 0:(d=parseFloat(o)).toString()==o&&(o=d)),i=e.property=Y(i,Z(o,i).transform(t));var a=""+o;if(is_identifier_string(a)&&a.length<=i.print_to_string().length+1)return ke(AST_Dot,e,{optional:e.optional,expression:n,property:a,quoted:!0}).optimize(t)}}var s,f,c,l,r=t.parent(),u=is_lhs(t.self(),r);if(t.option("arguments")&&n instanceof AST_SymbolRef&&ge(s=n.definition())&&!n.in_arg&&i instanceof AST_Number&&Math.floor(p=i.value)==p&&(f=s.scope)===function(){var e,n=0;for(;e=t.parent(n++);)if(e instanceof AST_Lambda){if(e instanceof AST_Accessor)return;if(!is_arrow(e))return c=t.parent(n),e}}()&&f.uses_arguments<(u?2:3)){r instanceof AST_UnaryPrefix&&"delete"==r.operator&&(s.deleted||(s.deleted=[]),s.deleted[p]=!0);var _=f.argnames[p];if(s.deleted&&s.deleted[p])_=null;else if(_)(!(_ instanceof AST_SymbolFunarg&&"await"!=_.name&&n.scope.find_variable(_.name)===(S=_.definition()))||(t.has_directive("use strict")||f.name||f.rest||!(c instanceof AST_Call&&p<c.args.length&&all(c.args.slice(0,p+1),function(e){return!(e instanceof AST_Spread)}))||!all(f.argnames,function(e){return e instanceof AST_SymbolFunarg}))&&(v()||S.assignments||1<S.orig.length))&&(_=null);else if((u||!v())&&p<f.argnames.length+5&&t.drop_fargs(f,c)&&!f.rest)for(;p>=f.argnames.length;)_=f.make_var(AST_SymbolFunarg,f,"argument_"+f.argnames.length),f.argnames.push(_);if(_&&find_if(function(e){return e.name===_.name},f.argnames)===_)return u&&s.reassigned--,(S=ke(AST_SymbolRef,_)).reference(),_.unused=void 0,S}if(u)return e;if(t.option("sequences")&&"Call"!=r.TYPE&&!(r instanceof AST_ForEnumeration&&r.init===e)){var S=G(e);if(S!==e)return S.optimize(t)}if(o!==i&&(u=e.flatten_object(a,t))&&(n=e.expression=u.expression,i=e.property=u.property),t.option("properties")&&t.option("side_effects")&&i instanceof AST_Number&&n instanceof AST_Array&&all(l=n.elements,function(e){return!(e instanceof AST_Spread)})){var p,r=l[p=i.value];if(at(r,t)){for(var d,A=r instanceof AST_Hole,T=!A,h=[],m=l.length;--m>p;)(d=l[m].drop_side_effect_free(t))&&(h.unshift(d),T)&&d.has_side_effects(t)&&(T=!1);for(T||h.unshift(r);0<=--m;)(d=l[m].drop_side_effect_free(t))?h.unshift(d):A?h.unshift(ke(AST_Hole,l[m])):p--;return T?(h.push(r),we(e,h).optimize(t)):ke(AST_Sub,e,{expression:ke(AST_Array,n,{elements:h}),property:ke(AST_Number,i,{value:p})})}}return K(t,e);function v(){return!t.option("reduce_vars")||s.reassigned}}),AST_LambdaExpression.DEFMETHOD("contains_super",function(){var n=!1,t=this;return t.walk(new TreeWalker(function(e){return!!n||(e instanceof AST_Super?n=!0:e!==t&&e instanceof AST_Scope&&!is_arrow(e)||void 0)})),n}),(n=function(e,n){e.DEFMETHOD("contains_this",n)})(AST_Arrow,return_false),n(AST_AsyncArrow,return_false),n(AST_Node,function(){var n=!1,t=this;return t.walk(new TreeWalker(function(e){return!!n||(e instanceof AST_This?n=!0:e!==t&&e instanceof AST_Scope&&!is_arrow(e)||void 0)})),n}),AST_PropAccess.DEFMETHOD("flatten_object",function(e,n){if(n.option("properties")&&"__proto__"!==e){var t=this.expression;if(t instanceof AST_Object)for(var i=t.properties,r=i.length;0<=--r;){var o=i[r];if(o.key===e){if(!all(i,st))return;if(!at(o.value,n))return;for(var a,s=[],f=0;f<i.length;f++){var c=i[f].value;if(i[f]instanceof AST_ObjectMethod){var l,u,_,S=!(c.uses_arguments||is_generator(c)||c.contains_this());if(S&&(l=l||n.find_parent(AST_Scope),u=jn(n,l),c.each_argname(function(e){u[e.name]&&(S=!1)})),S)_=is_async(c)?AST_AsyncArrow:AST_Arrow;else{if(!(r!=f||(a=n.parent())instanceof AST_Call&&a.expression===this))return;_=c.CTOR}c=ke(_,c)}s.push(c)}return ke(AST_Sub,this,{expression:ke(AST_Array,t,{elements:s}),property:ke(AST_Number,this,{value:r})})}}}}),e(AST_Dot,function(e,n){"arguments"!=e.property&&"caller"!=e.property||AST_Node.warn("Function.prototype.{property} not supported [{start}]",e);var t=n.parent();if(is_lhs(n.self(),t))return e;var i=zn(e,n);if(i)return i;if(n.option("sequences")&&"Call"!=t.TYPE&&!(t instanceof AST_ForEnumeration&&t.init===e)){i=G(e);if(i!==e)return i.optimize(n)}if(n.option("unsafe_proto")&&e.expression instanceof AST_Dot&&"prototype"==e.expression.property){var r=e.expression.expression;if(Ee(r))switch(r.name){case"Array":e.expression=ke(AST_Array,e.expression,{elements:[]});break;case"Function":e.expression=ke(AST_Function,e.expression,{argnames:[],body:[]}).init_vars(r.scope);break;case"Number":e.expression=ke(AST_Number,e.expression,{value:0});break;case"Object":e.expression=ke(AST_Object,e.expression,{properties:[]});break;case"RegExp":e.expression=ke(AST_RegExp,e.expression,{value:/t/});break;case"String":e.expression=ke(AST_String,e.expression,{value:""})}}t=e.flatten_object(e.property,n);return t?t.optimize(n):K(n,e)}),e(AST_DestructuredArray,function(e,n){return n.option("rests")&&e.rest instanceof AST_DestructuredArray?ke(AST_DestructuredArray,e,{elements:e.elements.concat(e.rest.elements),rest:e.rest.rest}):e}),e(AST_DestructuredKeyVal,function(e,n){var t;return n.option("objects")&&(t=e.key)instanceof AST_Node&&(t=t.evaluate(n))!==e.key&&(e.key=""+t),e}),e(AST_Object,function(t,i){var r,o,a,s,f,c,l,e;return i.option("objects")&&(a=o=r=!1,s=i.has_directive("use strict"),f=[],c=new Dictionary,l=[],t.properties.forEach(function(e){if(!(e instanceof AST_Spread))return _(e);o=!0;var n=e.expression;i.option("spreads")&&n instanceof AST_Object&&all(n.properties,function(e){return!(e instanceof AST_ObjectGetter||e instanceof AST_Spread||!("__proto__"!==e.key||e instanceof AST_ObjectSetter)&&e.value.has_side_effects(i))})?(r=!0,n.properties.forEach(function(e){var n=e.key,t=e instanceof AST_ObjectSetter;if("__proto__"===n){if(!t)return;n=Z(n,e)}_(t?ke(AST_ObjectKeyVal,e,{key:n,value:ke(AST_Undefined,e).optimize(i)}):e)})):(a=!0,u(),l.push(e))}),u(),r)?(o&&a&&1==l.length&&(e=l[0])instanceof AST_ObjectProperty&&e.key instanceof AST_Number&&(e.key=""+e.key.value),ke(AST_Object,t,{properties:l})):t;function u(){f.forEach(function(e){var n=c.get(e);switch(n.length){case 0:return;case 1:return l.push(n[0])}r=!0;e=s&&!a&&n.pop();l.push(1==n.length?n[0]:ke(AST_ObjectKeyVal,t,{key:n[0].key,value:we(t,n.map(function(e){return e.value}))})),e&&l.push(e),n.length=0}),f=[],c=new Dictionary}function _(e){var n=e.key;n instanceof AST_Node&&(o=!0,(n=n.evaluate(i))===e.key||"__proto__"===n?a=!0:n=e.key=""+n),st(e)?(e.value.has_side_effects(i)&&u(),f.push(n),c.add(n,e)):(u(),l.push(e)),o&&!a&&"string"==typeof n&&y.test(n)&&(a=!0,(e=c.has(n)?c.get(n)[0]:e).key=ke(AST_Number,e,{value:+n}))}}),(n=function(e,n){e.DEFMETHOD("try_inline",n)})(AST_Node,noop),n(AST_Assign,noop),n(AST_Await,function(t,e,n,i){if(t.option("awaits")){var r=this,e=r.expression.try_inline(t,e,n,i,!0);if(e)return n||yn(e,function(e){e.in_bool=!1;var n=e.value;n instanceof AST_Await||(e.value=ke(AST_Await,r,{expression:n||ke(AST_Undefined,e).transform(t)}))}),q(e)?e:ke(AST_BlockStatement,r,{body:[e,ke(AST_SimpleStatement,r,{body:ke(AST_Await,r,{expression:ke(AST_Number,r,{value:0})})})]})}}),n(AST_Binary,function(n,e,t,i,r){if(void 0!==t){var o=this,a=o.operator;if(Ne[a]){e=o.right.try_inline(n,e,t,i,r);if(e)return ke(AST_If,o,{condition:function(e){switch(a){case"&&":return e;case"||":return e.negate(n);case"??":return ke(AST_Binary,o,{operator:"==",left:ke(AST_Null,o),right:e})}}(o.left),body:e,alternative:t?null:ke(AST_Return,o,{value:ke(AST_Undefined,o).transform(n)})})}}}),n(AST_BlockStatement,function(e,n,t,i){if(!t&&this.variables){var r=this.body,o=r.length-1;if(!(o<0)){e=r[o].try_inline(e,this,t,i);if(e)return r[o]=e,this}}}),n(AST_Call,function(i,r,e,o,n){if(!(i.option("inline")<4)){var t=this;if(!t.is_expr_pure(i)){var a=t.expression;if(a instanceof AST_LambdaExpression&&!a.name&&!(a.single_use||a.uses_arguments||a.pinned()||is_generator(a))){var s=is_arrow(a);if(!(s&&a.value||a.body[0]instanceof AST_Directive||a.contains_this())){r=r||xe(i);var f=new Dictionary;for(f.set("NaN",!0);!(r instanceof AST_Scope);)r.variables.each(function(e){f.set(e.name,!0)}),r=r.parent_scope;if(member(r,i.stack)&&!(r.pinned()&&a.variables.size()>(s?0:1))){if(r instanceof AST_Toplevel){if(a.variables.size()>(s?0:1)){if(!i.toplevel.vars)return;if(0<a.functions.size()&&!i.toplevel.funcs)return}f.set("arguments",!0)}var c=!n&&is_async(a);if(c){if(!i.option("awaits"))return;if(!is_async(r))return;if(t.may_throw(i))return}var l=r.var_names();if(o=o&&[],a.variables.all(function(e,n){return o&&o.push(e),!f.has(n)&&!l.has(n)||!s&&"arguments"==n&&1==e.orig.length})&&!(o&&0<o.length&&it(a,o))){var u,_,S,p,d,A=!0;if(all(a.argnames,function(e){var n=!1,t=new TreeWalker(function(e){return!!n||(e instanceof AST_DefaultValue?ct(a,e.value)?n=!0:(e.name.walk(t),!0):e instanceof AST_DestructuredKeyVal?e.key instanceof AST_Node&&ct(a,e.key)?n=!0:(e.value.walk(t),!0):e instanceof AST_SymbolFunarg&&!all(e.definition().orig,function(e){return!(e instanceof AST_SymbolDefun)})?n=!0:void 0)});return e.walk(t),!n&&(e instanceof AST_SymbolFunarg||(A=!1),!0)})){if(a.rest){if(ct(a,a.rest))return;A=!1}if(e?u=function(e){var n=!1;return e.walk(new TreeWalker(function(e){return!!n||(c&&(e instanceof AST_Await||e instanceof AST_ForAwaitOf)||e instanceof AST_Return?n=!0:e instanceof AST_Scope||void 0)})),!n}:(n||is_async(a)||B(r))&&(u=function(e){var n=!1,t=new TreeWalker(function(e){return!!n||(e instanceof AST_Return?n=!0:e instanceof AST_Scope||void 0)});return e.walk(new TreeWalker(function(e){return!!n||(e instanceof AST_Try?e.bfinally?(all(e.body,function(e){return e.walk(t),!n})&&e.bcatch&&e.bcatch.walk(t),!0):void 0:e instanceof AST_Scope||void 0)})),!n}),!u||all(a.body,u))if(Ln(a,jn(i,r)))return a.functions.each(function(e,n){r.functions.set(n,e)}),_=[],a.variables.each(function(n,e){if((s||"arguments"!=e||1!=n.orig.length)&&(l.set(e,!0),r.enclosed.push(n),r.variables.set(e,n),n.single_use=!1,o)&&n.references.length!=n.replaced){switch(n.orig.length-n.eliminated){case 0:return;case 1:if(a.functions.has(e))return}var t;!all(n.orig,function(e){return!(e instanceof AST_SymbolConst||(e instanceof AST_SymbolFunarg?e.unused||n.scope.resolve()===a:e instanceof AST_SymbolLet))})||(t=n.orig[0])instanceof AST_SymbolCatch||(_.push(ke(AST_SimpleStatement,t,{body:ut(i,ft(t))})),n.first_decl=null)}}),S=Object.create(null),p=new Dictionary,A&&all(t.args,function(e){return!(e instanceof AST_Spread)})?(d=t.args.slice(),a.argnames.forEach(function(e){var n=d.shift();e.unused?n&&_.push(ke(AST_SimpleStatement,t,{body:n})):(n=ke(AST_VarDef,t,{name:e.convert_symbol(AST_SymbolVar,T),value:n||ke(AST_Undefined,t).transform(i)}),e instanceof AST_SymbolFunarg&&lt(e.definition(),n),_.push(ke(AST_Var,t,{definitions:[n]})))}),d.length&&_.push(ke(AST_SimpleStatement,t,{body:we(t,d)}))):_.push(ke(AST_Var,t,{definitions:[ke(AST_VarDef,t,{name:ke(AST_DestructuredArray,t,{elements:a.argnames.map(function(e){return e.unused?ke(AST_Hole,e):e.convert_symbol(AST_SymbolVar,T)}),rest:a.rest&&a.rest.convert_symbol(AST_SymbolVar,T)}),value:ke(AST_Array,t,{elements:t.args.slice()})})]})),p.each(function(e,n){n=S[n];[].unshift.apply(n.orig,e),n.eliminated+=e.length}),[].push.apply(_,o?a.body.filter(function(e){var n,t;return!(e instanceof AST_LambdaDefinition&&((t=(n=ke(AST_SymbolVar,ft(e.name))).definition()).fixed=!1,t.orig.push(n),t.eliminated++,_.push(ke(AST_Var,e,{definitions:[ke(AST_VarDef,e,{name:n,value:vn(e,!0)})]})),1))}):a.body),n=ke(AST_BlockStatement,t,{body:_}),e||(c&&yn(n,function(e){var n=e.value;Ce(n)||(e.value=ke(AST_Await,t,{expression:n}))}),_.push(ke(AST_Return,t,{value:B(r)?ke(AST_Undefined,t).transform(i):null}))),n}}}}}}}function T(e,n){n=n.definition();S[n.id]=n,p.add(n.id,e)}}),n(AST_Conditional,function(e,n,t,i,r){var o=this,a=o.consequent.try_inline(e,n,t,i,r),e=o.alternative.try_inline(e,n,t,i,r);if(a||e)return ke(AST_If,o,{condition:o.condition,body:a||s(o.consequent),alternative:e||s(o.alternative)});function s(e){return t?ke(AST_SimpleStatement,e,{body:e}):ke(AST_Return,e,{value:e})}}),n(AST_For,function(e,n,t,i){var r=this.body.try_inline(e,n,!0,!0),o=(r&&(this.body=r),this.init);return(o=o&&o.try_inline(e,n,!0,i))?(this.init=null,o instanceof AST_BlockStatement?(o.body.push(this),o):ke(AST_BlockStatement,o,{body:[o,this]})):r&&this}),n(AST_ForEnumeration,function(e,n,t,i){var r=this.body.try_inline(e,n,!0,!0),o=(r&&(this.body=r),this.object);if(o instanceof AST_Sequence){e=_t(e,n,!0,i,!1,o,1);if(e)return this.object=o.tail_node(),e.body.push(this),e}return r&&this}),n(AST_If,function(e,n,t,i){var r=this.body.try_inline(e,n,t,i),o=(r&&(this.body=r),this.alternative),t=((o=o&&o.try_inline(e,n,t,i))&&(this.alternative=o),this.condition);if(t instanceof AST_Sequence){e=_t(e,n,!0,i,!1,t,1);if(e)return this.condition=t.tail_node(),e.body.push(this),e}return(r||o)&&this}),n(AST_IterationStatement,function(e,n,t,i){e=this.body.try_inline(e,n,!0,!0);if(e)return this.body=e,this}),n(AST_LabeledStatement,function(e,n,t,i){e=this.body.try_inline(e,n,t,i);if(e)return this.body instanceof AST_IterationStatement&&e instanceof AST_BlockStatement?(n=e.body.pop(),this.body=n,e.body.push(this),e):(this.body=e,this)}),n(AST_New,noop),n(AST_Return,function(e,n,t,i){var r=this.value;return r&&r.try_inline(e,n,void 0,"try"===i)}),n(AST_Sequence,function(e,n,t,i,r){return _t(e,n,t,i,r,this)}),n(AST_SimpleStatement,function(e,n,t,i){for(var r=this.body;r instanceof AST_UnaryPrefix;){var o=r.operator;if(unary_side_effects[o])break;if("void"==o)break;r=r.expression}return(r=t||Ce(r)?r:ke(AST_UnaryPrefix,this,{operator:"void",expression:r})).try_inline(e,n,t||!1,i)}),n(AST_UnaryPrefix,function(t,e,n,i,r){var o=this,a=o.operator;if(!unary_side_effects[a]){e=o.expression.try_inline(t,e,n=n||"void"!=a?n:!1,i,r);if(e)return n||yn(e,function(e){e.in_bool=!1;var n=e.value;"void"==a&&Ce(n)||(e.value=ke(AST_UnaryPrefix,o,{operator:a,expression:n||ke(AST_Undefined,e).transform(t)}))}),e}}),n(AST_With,function(e,n,t,i){var t=this.body.try_inline(e,n,t,i),r=(t&&(this.body=t),this.expression);if(r instanceof AST_Sequence){e=_t(e,n,!0,i,!1,r,1);if(e)return this.expression=r.tail_node(),e.body.push(this),e}return t&&this}),n(AST_Yield,function(e,n,t,i){if(e.option("yields")&&this.nested){var r=this.expression;if("Call"==r.TYPE){var o=r.expression;switch(o.CTOR){case AST_AsyncGeneratorFunction:o=ke(AST_AsyncFunction,o);break;case AST_GeneratorFunction:o=ke(AST_Function,o);break;default:return}return(r=r.clone()).expression=o,r.try_inline(e,n,t,i)}}}),e(AST_Return,function(e,n){var t=e.value;return t&&n.option("side_effects")&&Ce(t,n)&&!B(n.find_parent(AST_Scope))&&(e.value=null),e})}(function(e,n){e.DEFMETHOD("optimize",function(e){return this._optimized||e.has_directive("use asm")?this:((e=n(this,e))._optimized=!0,e)})});